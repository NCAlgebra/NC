<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="J. William Helton" />
  <meta name="author" content="Mauricio C. de Oliveira" />
  <title>The NCAlgebra Suite</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="markdown.css" />
  <link rel="stylesheet" href="github-markdown-light.css" />
  
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
  type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body class="markdown-body">
<header id="title-block-header">
<h1 class="title">The NCAlgebra Suite</h1>
<p class="subtitle">Version 6.0.1</p>
<p class="author">J. William Helton</p>
<p class="author">Mauricio C. de Oliveira</p>
<p class="date">with earlier contributions by Bob Miller &amp; Mark
Stankus</p>
</header>
<nav id="TOC" role="doc-toc">
<h2 id="toc-title">Table of Contents</h2>
<ul>
<li><a href="#license" id="toc-license">License</a></li>
<li><a href="#acknowledgements"
id="toc-acknowledgements">Acknowledgements</a></li>
<li><a href="#Version6_0" id="toc-Version6_0"><span
class="toc-section-number">1</span> Changes in Version 6.0</a>
<ul>
<li><a href="#Version6_0_1" id="toc-Version6_0_1"><span
class="toc-section-number">1.1</span> Version 6.0.1</a></li>
<li><a href="#Version6_0_0" id="toc-Version6_0_0"><span
class="toc-section-number">1.2</span> Version 6.0.0</a></li>
</ul></li>
<li><a href="#Version5_0" id="toc-Version5_0"><span
class="toc-section-number">2</span> Changes in Version 5.0</a>
<ul>
<li><a href="#Version5_0_6" id="toc-Version5_0_6"><span
class="toc-section-number">2.1</span> Version 5.0.6</a></li>
<li><a href="#Version5_0_5" id="toc-Version5_0_5"><span
class="toc-section-number">2.2</span> Version 5.0.5</a></li>
<li><a href="#Version5_0_4" id="toc-Version5_0_4"><span
class="toc-section-number">2.3</span> Version 5.0.4</a></li>
<li><a href="#Version5_0_3" id="toc-Version5_0_3"><span
class="toc-section-number">2.4</span> Version 5.0.3</a></li>
<li><a href="#Version5_0_2" id="toc-Version5_0_2"><span
class="toc-section-number">2.5</span> Version 5.0.2</a></li>
<li><a href="#Version5_0_1" id="toc-Version5_0_1"><span
class="toc-section-number">2.6</span> Version 5.0.1</a></li>
<li><a href="#Version5_0_0" id="toc-Version5_0_0"><span
class="toc-section-number">2.7</span> Version 5.0.0</a></li>
</ul></li>
<li><a href="#UserGuideIntroduction"
id="toc-UserGuideIntroduction"><span class="toc-section-number">3</span>
Introduction</a>
<ul>
<li><a href="#InstallingNCAlgebra" id="toc-InstallingNCAlgebra"><span
class="toc-section-number">3.1</span> Installing NCAlgebra</a></li>
<li><a href="#RunningNCAlgebra" id="toc-RunningNCAlgebra"><span
class="toc-section-number">3.2</span> Running NCAlgebra</a></li>
<li><a href="#now-what" id="toc-now-what"><span
class="toc-section-number">3.3</span> Now what?</a></li>
<li><a href="#testing" id="toc-testing"><span
class="toc-section-number">3.4</span> Testing</a></li>
<li><a href="#pre-2017-ncgb-c-version"
id="toc-pre-2017-ncgb-c-version"><span
class="toc-section-number">3.5</span> Pre-2017 NCGB C++ version</a></li>
</ul></li>
<li><a href="#MostBasicCommands" id="toc-MostBasicCommands"><span
class="toc-section-number">4</span> Most Basic Commands</a>
<ul>
<li><a href="#to-commute-or-not-to-commute"
id="toc-to-commute-or-not-to-commute"><span
class="toc-section-number">4.1</span> To Commute Or Not To
Commute?</a></li>
<li><a href="#BasicInverses" id="toc-BasicInverses"><span
class="toc-section-number">4.2</span> Inverses</a></li>
<li><a href="#transposes-and-adjoints"
id="toc-transposes-and-adjoints"><span
class="toc-section-number">4.3</span> Transposes and Adjoints</a></li>
<li><a href="#BasicReplace" id="toc-BasicReplace"><span
class="toc-section-number">4.4</span> Replace</a></li>
<li><a href="#polynomials" id="toc-polynomials"><span
class="toc-section-number">4.5</span> Polynomials</a></li>
<li><a href="#rationals-and-simplification"
id="toc-rationals-and-simplification"><span
class="toc-section-number">4.6</span> Rationals and
Simplification</a></li>
<li><a href="#calculus" id="toc-calculus"><span
class="toc-section-number">4.7</span> Calculus</a></li>
<li><a href="#BasicMatrices" id="toc-BasicMatrices"><span
class="toc-section-number">4.8</span> Matrices</a>
<ul>
<li><a href="#BasicMatrices:Inverses"
id="toc-BasicMatrices:Inverses"><span
class="toc-section-number">4.8.1</span> Inverses, Products, Adjoints,
etc</a></li>
<li><a href="#BasicMatrices:LUDecomposition"
id="toc-BasicMatrices:LUDecomposition"><span
class="toc-section-number">4.8.2</span> LU Decomposition</a></li>
<li><a href="#BasicMatrices:LUDecompositionWithCompletePivoting"
id="toc-BasicMatrices:LUDecompositionWithCompletePivoting"><span
class="toc-section-number">4.8.3</span> LU Decomposition with Complete
Pivoting</a></li>
<li><a href="#BasicMatrices:LDLDecomposition"
id="toc-BasicMatrices:LDLDecomposition"><span
class="toc-section-number">4.8.4</span> LDL Decomposition</a></li>
<li><a href="#ReplaceWithMatrices" id="toc-ReplaceWithMatrices"><span
class="toc-section-number">4.8.5</span> Replace with Matrices</a></li>
</ul></li>
<li><a href="#Quadratic" id="toc-Quadratic"><span
class="toc-section-number">4.9</span> Quadratic Polynomials, Second
Directional Derivatives and Convexity</a></li>
</ul></li>
<li><a href="#MoreAdvancedCommands" id="toc-MoreAdvancedCommands"><span
class="toc-section-number">5</span> More Advanced Commands</a>
<ul>
<li><a href="#AdvancedReplace" id="toc-AdvancedReplace"><span
class="toc-section-number">5.1</span> Advanced Rules and
Replacements</a>
<ul>
<li><a href="#replaceall-.-and-replacerepeated-.-often-fail"
id="toc-replaceall-.-and-replacerepeated-.-often-fail"><span
class="toc-section-number">5.1.1</span> <code>ReplaceAll</code>
(<code>/.</code>) and <code>ReplaceRepeated</code> (<code>//.</code>)
often fail</a></li>
<li><a href="#the-fix-is-ncreplace" id="toc-the-fix-is-ncreplace"><span
class="toc-section-number">5.1.2</span> The fix is
<code>NCReplace</code></a></li>
<li><a href="#matching-monomials-with-powers"
id="toc-matching-monomials-with-powers"><span
class="toc-section-number">5.1.3</span> Matching monomials with
powers</a></li>
<li><a href="#trouble-with-block-and-module"
id="toc-trouble-with-block-and-module"><span
class="toc-section-number">5.1.4</span> Trouble with <code>Block</code>
and <code>Module</code></a></li>
</ul></li>
<li><a href="#AdvancedMatrices" id="toc-AdvancedMatrices"><span
class="toc-section-number">5.2</span> Expanding matrix products</a>
<ul>
<li><a href="#trouble-with-plus-and-matrices"
id="toc-trouble-with-plus-and-matrices"><span
class="toc-section-number">5.2.1</span> Trouble with <code>Plus</code>
(<code>+</code>) and matrices</a></li>
</ul></li>
<li><a href="#PolysWithCommutativeCoefficients"
id="toc-PolysWithCommutativeCoefficients"><span
class="toc-section-number">5.3</span> Polynomials with commutative
coefficients</a></li>
<li><a href="#polynomials-with-noncommutative-coefficients"
id="toc-polynomials-with-noncommutative-coefficients"><span
class="toc-section-number">5.4</span> Polynomials with noncommutative
coefficients</a></li>
<li><a href="#Linear" id="toc-Linear"><span
class="toc-section-number">5.5</span> Linear polynomials</a></li>
</ul></li>
<li><a href="#NCGB" id="toc-NCGB"><span
class="toc-section-number">6</span> Noncommutative Gröbner Basis</a>
<ul>
<li><a href="#what-is-a-gröbner-basis"
id="toc-what-is-a-gröbner-basis"><span
class="toc-section-number">6.1</span> What is a Gröbner Basis?</a></li>
<li><a href="#solving-equations" id="toc-solving-equations"><span
class="toc-section-number">6.2</span> Solving Equations</a></li>
<li><a href="#a-slightly-more-challenging-example"
id="toc-a-slightly-more-challenging-example"><span
class="toc-section-number">6.3</span> A Slightly more Challenging
Example</a></li>
<li><a href="#simplifying-polynomial-expressions"
id="toc-simplifying-polynomial-expressions"><span
class="toc-section-number">6.4</span> Simplifying Polynomial
Expressions</a></li>
<li><a href="#PolynomialsAndRules" id="toc-PolynomialsAndRules"><span
class="toc-section-number">6.5</span> Polynomials and Rules</a></li>
<li><a href="#minimal-versus-reduced-gröbner-basis"
id="toc-minimal-versus-reduced-gröbner-basis"><span
class="toc-section-number">6.6</span> Minimal versus Reduced Gröbner
Basis</a></li>
<li><a href="#SimplifyingRationalExpressions"
id="toc-SimplifyingRationalExpressions"><span
class="toc-section-number">6.7</span> Simplifying Rational
Expressions</a></li>
<li><a href="#simplification-with-ncgbsimplifyrational"
id="toc-simplification-with-ncgbsimplifyrational"><span
class="toc-section-number">6.8</span> Simplification with
NCGBSimplifyRational</a></li>
<li><a href="#Orderings" id="toc-Orderings"><span
class="toc-section-number">6.9</span> Ordering on Variables and
Monomials</a>
<ul>
<li><a href="#lex-order-the-simplest-elimination-order"
id="toc-lex-order-the-simplest-elimination-order"><span
class="toc-section-number">6.9.1</span> Lex Order: the simplest
elimination order</a></li>
<li><a href="#graded-lex-ordering-a-non-elimination-order"
id="toc-graded-lex-ordering-a-non-elimination-order"><span
class="toc-section-number">6.9.2</span> Graded Lex Ordering: a
non-elimination order</a></li>
<li><a href="#multigraded-lex-ordering-a-variety-of-elimination-orders"
id="toc-multigraded-lex-ordering-a-variety-of-elimination-orders"><span
class="toc-section-number">6.9.3</span> Multigraded Lex Ordering: a
variety of elimination orders</a></li>
</ul></li>
<li><a
href="#a-complete-example-the-partially-prescribed-matrix-inverse-problem"
id="toc-a-complete-example-the-partially-prescribed-matrix-inverse-problem"><span
class="toc-section-number">6.10</span> A Complete Example: the partially
prescribed matrix inverse problem</a></li>
<li><a href="#AdvancedProcessingOfRationalExpressions"
id="toc-AdvancedProcessingOfRationalExpressions"><span
class="toc-section-number">6.11</span> Advanced Processing of Rational
Expressions</a></li>
</ul></li>
<li><a href="#SemidefiniteProgramming"
id="toc-SemidefiniteProgramming"><span
class="toc-section-number">7</span> Semidefinite Programming</a>
<ul>
<li><a href="#semidefinite-programs-in-matrix-variables"
id="toc-semidefinite-programs-in-matrix-variables"><span
class="toc-section-number">7.1</span> Semidefinite Programs in Matrix
Variables</a></li>
<li><a href="#semidefinite-programs-in-vector-variables"
id="toc-semidefinite-programs-in-vector-variables"><span
class="toc-section-number">7.2</span> Semidefinite Programs in Vector
Variables</a></li>
</ul></li>
<li><a href="#TeX" id="toc-TeX"><span
class="toc-section-number">8</span> Pretty Output with Notebooks and
 </a>
<ul>
<li><a href="#Pretty_Output" id="toc-Pretty_Output"><span
class="toc-section-number">8.1</span> Pretty Output</a></li>
<li><a href="#Using_NCTeX" id="toc-Using_NCTeX"><span
class="toc-section-number">8.2</span> Using NCTeX</a>
<ul>
<li><a href="#NCTeX_Options" id="toc-NCTeX_Options"><span
class="toc-section-number">8.2.1</span> NCTeX Options</a></li>
</ul></li>
<li><a href="#Using_NCTeXForm" id="toc-Using_NCTeXForm"><span
class="toc-section-number">8.3</span> Using NCTeXForm</a></li>
</ul></li>
<li><a href="#ReferenceIntroduction"
id="toc-ReferenceIntroduction"><span class="toc-section-number">9</span>
Reference Manual</a>
<ul>
<li><a href="#ManualInstallation" id="toc-ManualInstallation"><span
class="toc-section-number">9.1</span> Manual Installation</a>
<ul>
<li><a href="#via-git-clone" id="toc-via-git-clone"><span
class="toc-section-number">9.1.1</span> Via
<code>git clone</code></a></li>
<li><a href="#from-the-github-download-button"
id="toc-from-the-github-download-button"><span
class="toc-section-number">9.1.2</span> From the github download
button</a></li>
<li><a href="#from-one-of-our-releases"
id="toc-from-one-of-our-releases"><span
class="toc-section-number">9.1.3</span> From one of our
releases</a></li>
<li><a href="#post-download-installation"
id="toc-post-download-installation"><span
class="toc-section-number">9.1.4</span> Post-download
installation</a></li>
</ul></li>
<li><a href="#PackageNC" id="toc-PackageNC"><span
class="toc-section-number">9.2</span> NC</a></li>
<li><a href="#PackageNCAlgebra" id="toc-PackageNCAlgebra"><span
class="toc-section-number">9.3</span> NCAlgebra</a>
<ul>
<li><a href="#NCAlgebraMessages" id="toc-NCAlgebraMessages"><span
class="toc-section-number">9.3.1</span> Messages</a></li>
<li><a href="#PackageNCOptions" id="toc-PackageNCOptions"><span
class="toc-section-number">9.3.2</span> NCOptions</a></li>
</ul></li>
</ul></li>
<li><a href="#ManipulatingNCExpressions"
id="toc-ManipulatingNCExpressions"><span
class="toc-section-number">10</span> Packages for manipulating NC
expressions</a>
<ul>
<li><a href="#PackageNonCommutativeMultiply"
id="toc-PackageNonCommutativeMultiply"><span
class="toc-section-number">10.1</span> NonCommutativeMultiply</a>
<ul>
<li><a href="#aj" id="toc-aj"><span
class="toc-section-number">10.1.1</span> aj</a></li>
<li><a href="#co" id="toc-co"><span
class="toc-section-number">10.1.2</span> co</a></li>
<li><a href="#Id" id="toc-Id"><span
class="toc-section-number">10.1.3</span> Id</a></li>
<li><a href="#inv" id="toc-inv"><span
class="toc-section-number">10.1.4</span> inv</a></li>
<li><a href="#rt" id="toc-rt"><span
class="toc-section-number">10.1.5</span> rt</a></li>
<li><a href="#tp" id="toc-tp"><span
class="toc-section-number">10.1.6</span> tp</a></li>
<li><a href="#CommutativeQ" id="toc-CommutativeQ"><span
class="toc-section-number">10.1.7</span> CommutativeQ</a></li>
<li><a href="#NonCommutativeQ" id="toc-NonCommutativeQ"><span
class="toc-section-number">10.1.8</span> NonCommutativeQ</a></li>
<li><a href="#SetCommutative" id="toc-SetCommutative"><span
class="toc-section-number">10.1.9</span> SetCommutative</a></li>
<li><a href="#SetCommutativeHold" id="toc-SetCommutativeHold"><span
class="toc-section-number">10.1.10</span> SetCommutativeHold</a></li>
<li><a href="#SetNonCommutative" id="toc-SetNonCommutative"><span
class="toc-section-number">10.1.11</span> SetNonCommutative</a></li>
<li><a href="#SetNonCommutativeHold"
id="toc-SetNonCommutativeHold"><span
class="toc-section-number">10.1.12</span> SetNonCommutativeHold</a></li>
<li><a href="#SetCommutativeFunction"
id="toc-SetCommutativeFunction"><span
class="toc-section-number">10.1.13</span>
SetCommutativeFunction</a></li>
<li><a href="#SetNonCommutativeFunction"
id="toc-SetNonCommutativeFunction"><span
class="toc-section-number">10.1.14</span>
SetNonCommutativeFunction</a></li>
<li><a href="#SNC" id="toc-SNC"><span
class="toc-section-number">10.1.15</span> SNC</a></li>
<li><a href="#SetCommutingOperators"
id="toc-SetCommutingOperators"><span
class="toc-section-number">10.1.16</span> SetCommutingOperators</a></li>
<li><a href="#UnsetCommutingOperators"
id="toc-UnsetCommutingOperators"><span
class="toc-section-number">10.1.17</span>
UnsetCommutingOperators</a></li>
<li><a href="#CommutingOperatorsQ" id="toc-CommutingOperatorsQ"><span
class="toc-section-number">10.1.18</span> CommutingOperatorsQ</a></li>
<li><a href="#NCNonCommutativeSymbolOrSubscriptQ"
id="toc-NCNonCommutativeSymbolOrSubscriptQ"><span
class="toc-section-number">10.1.19</span>
NCNonCommutativeSymbolOrSubscriptQ</a></li>
<li><a href="#NCNonCommutativeSymbolOrSubscriptExtendedQ"
id="toc-NCNonCommutativeSymbolOrSubscriptExtendedQ"><span
class="toc-section-number">10.1.20</span>
NCNonCommutativeSymbolOrSubscriptExtendedQ</a></li>
<li><a href="#NCPowerQ" id="toc-NCPowerQ"><span
class="toc-section-number">10.1.21</span> NCPowerQ</a></li>
<li><a href="#Commutative" id="toc-Commutative"><span
class="toc-section-number">10.1.22</span> Commutative</a></li>
<li><a href="#CommuteEverything" id="toc-CommuteEverything"><span
class="toc-section-number">10.1.23</span> CommuteEverything</a></li>
<li><a href="#BeginCommuteEverything"
id="toc-BeginCommuteEverything"><span
class="toc-section-number">10.1.24</span>
BeginCommuteEverything</a></li>
<li><a href="#EndCommuteEverything" id="toc-EndCommuteEverything"><span
class="toc-section-number">10.1.25</span> EndCommuteEverything</a></li>
<li><a href="#ExpandNonCommutativeMultiply"
id="toc-ExpandNonCommutativeMultiply"><span
class="toc-section-number">10.1.26</span>
ExpandNonCommutativeMultiply</a></li>
<li><a href="#NCExpand" id="toc-NCExpand"><span
class="toc-section-number">10.1.27</span> NCExpand</a></li>
<li><a href="#NCE" id="toc-NCE"><span
class="toc-section-number">10.1.28</span> NCE</a></li>
<li><a href="#NCExpandExponents" id="toc-NCExpandExponents"><span
class="toc-section-number">10.1.29</span> NCExpandExponents</a></li>
<li><a href="#NCToList" id="toc-NCToList"><span
class="toc-section-number">10.1.30</span> NCToList</a></li>
</ul></li>
<li><a href="#PackageNCTr" id="toc-PackageNCTr"><span
class="toc-section-number">10.2</span> NCTr</a>
<ul>
<li><a href="#tr" id="toc-tr"><span
class="toc-section-number">10.2.1</span> tr</a></li>
<li><a href="#SortCyclicPermutation"
id="toc-SortCyclicPermutation"><span
class="toc-section-number">10.2.2</span> SortCyclicPermutation</a></li>
<li><a href="#SortedCyclicPermutationQ"
id="toc-SortedCyclicPermutationQ"><span
class="toc-section-number">10.2.3</span>
SortedCyclicPermutationQ</a></li>
</ul></li>
<li><a href="#PackageNCCollect" id="toc-PackageNCCollect"><span
class="toc-section-number">10.3</span> NCCollect</a>
<ul>
<li><a href="#NCCollect" id="toc-NCCollect"><span
class="toc-section-number">10.3.1</span> NCCollect</a></li>
<li><a href="#NCCollectExponents" id="toc-NCCollectExponents"><span
class="toc-section-number">10.3.2</span> NCCollectExponents</a></li>
<li><a href="#NCCollectSelfAdjoint" id="toc-NCCollectSelfAdjoint"><span
class="toc-section-number">10.3.3</span> NCCollectSelfAdjoint</a></li>
<li><a href="#NCCollectSymmetric" id="toc-NCCollectSymmetric"><span
class="toc-section-number">10.3.4</span> NCCollectSymmetric</a></li>
<li><a href="#NCStrongCollect" id="toc-NCStrongCollect"><span
class="toc-section-number">10.3.5</span> NCStrongCollect</a></li>
<li><a href="#NCStrongCollectSelfAdjoint"
id="toc-NCStrongCollectSelfAdjoint"><span
class="toc-section-number">10.3.6</span>
NCStrongCollectSelfAdjoint</a></li>
<li><a href="#NCStrongCollectSymmetric"
id="toc-NCStrongCollectSymmetric"><span
class="toc-section-number">10.3.7</span>
NCStrongCollectSymmetric</a></li>
<li><a href="#NCCompose" id="toc-NCCompose"><span
class="toc-section-number">10.3.8</span> NCCompose</a></li>
<li><a href="#NCDecompose" id="toc-NCDecompose"><span
class="toc-section-number">10.3.9</span> NCDecompose</a></li>
<li><a href="#NCTermsOfDegree" id="toc-NCTermsOfDegree"><span
class="toc-section-number">10.3.10</span> NCTermsOfDegree</a></li>
<li><a href="#NCTermsOfTotalDegree" id="toc-NCTermsOfTotalDegree"><span
class="toc-section-number">10.3.11</span> NCTermsOfTotalDegree</a></li>
</ul></li>
<li><a href="#PackageNCReplace" id="toc-PackageNCReplace"><span
class="toc-section-number">10.4</span> NCReplace</a>
<ul>
<li><a href="#NCReplace" id="toc-NCReplace"><span
class="toc-section-number">10.4.1</span> NCReplace</a></li>
<li><a href="#NCReplaceAll" id="toc-NCReplaceAll"><span
class="toc-section-number">10.4.2</span> NCReplaceAll</a></li>
<li><a href="#NCReplaceList" id="toc-NCReplaceList"><span
class="toc-section-number">10.4.3</span> NCReplaceList</a></li>
<li><a href="#NCReplaceRepeated" id="toc-NCReplaceRepeated"><span
class="toc-section-number">10.4.4</span> NCReplaceRepeated</a></li>
<li><a href="#NCExpandReplaceRepeated"
id="toc-NCExpandReplaceRepeated"><span
class="toc-section-number">10.4.5</span>
NCExpandReplaceRepeated</a></li>
<li><a href="#NCR" id="toc-NCR"><span
class="toc-section-number">10.4.6</span> NCR</a></li>
<li><a href="#NCRA" id="toc-NCRA"><span
class="toc-section-number">10.4.7</span> NCRA</a></li>
<li><a href="#NCRR" id="toc-NCRR"><span
class="toc-section-number">10.4.8</span> NCRR</a></li>
<li><a href="#NCRL" id="toc-NCRL"><span
class="toc-section-number">10.4.9</span> NCRL</a></li>
<li><a href="#NCMakeRuleSymmetric" id="toc-NCMakeRuleSymmetric"><span
class="toc-section-number">10.4.10</span> NCMakeRuleSymmetric</a></li>
<li><a href="#NCMakeRuleSelfAdjoint"
id="toc-NCMakeRuleSelfAdjoint"><span
class="toc-section-number">10.4.11</span> NCMakeRuleSelfAdjoint</a></li>
<li><a href="#NCReplaceSymmetric" id="toc-NCReplaceSymmetric"><span
class="toc-section-number">10.4.12</span> NCReplaceSymmetric</a></li>
<li><a href="#NCReplaceAllSymmetric"
id="toc-NCReplaceAllSymmetric"><span
class="toc-section-number">10.4.13</span> NCReplaceAllSymmetric</a></li>
<li><a href="#NCReplaceRepeatedSymmetric"
id="toc-NCReplaceRepeatedSymmetric"><span
class="toc-section-number">10.4.14</span>
NCReplaceRepeatedSymmetric</a></li>
<li><a href="#NCExpandReplaceRepeatedSymmetric"
id="toc-NCExpandReplaceRepeatedSymmetric"><span
class="toc-section-number">10.4.15</span>
NCExpandReplaceRepeatedSymmetric</a></li>
<li><a href="#NCReplaceListSymmetric"
id="toc-NCReplaceListSymmetric"><span
class="toc-section-number">10.4.16</span>
NCReplaceListSymmetric</a></li>
<li><a href="#NCRSym" id="toc-NCRSym"><span
class="toc-section-number">10.4.17</span> NCRSym</a></li>
<li><a href="#NCRASym" id="toc-NCRASym"><span
class="toc-section-number">10.4.18</span> NCRASym</a></li>
<li><a href="#NCRRSym" id="toc-NCRRSym"><span
class="toc-section-number">10.4.19</span> NCRRSym</a></li>
<li><a href="#NCRLSym" id="toc-NCRLSym"><span
class="toc-section-number">10.4.20</span> NCRLSym</a></li>
<li><a href="#NCReplaceSelfAdjoint" id="toc-NCReplaceSelfAdjoint"><span
class="toc-section-number">10.4.21</span> NCReplaceSelfAdjoint</a></li>
<li><a href="#NCReplaceAllSelfAdjoint"
id="toc-NCReplaceAllSelfAdjoint"><span
class="toc-section-number">10.4.22</span>
NCReplaceAllSelfAdjoint</a></li>
<li><a href="#NCReplaceRepeatedSelfAdjoint"
id="toc-NCReplaceRepeatedSelfAdjoint"><span
class="toc-section-number">10.4.23</span>
NCReplaceRepeatedSelfAdjoint</a></li>
<li><a href="#NCExpandReplaceRepeatedSelfAdjoint"
id="toc-NCExpandReplaceRepeatedSelfAdjoint"><span
class="toc-section-number">10.4.24</span>
NCExpandReplaceRepeatedSelfAdjoint</a></li>
<li><a href="#NCReplaceListSelfAdjoint"
id="toc-NCReplaceListSelfAdjoint"><span
class="toc-section-number">10.4.25</span>
NCReplaceListSelfAdjoint</a></li>
<li><a href="#NCRSA" id="toc-NCRSA"><span
class="toc-section-number">10.4.26</span> NCRSA</a></li>
<li><a href="#NCRASA" id="toc-NCRASA"><span
class="toc-section-number">10.4.27</span> NCRASA</a></li>
<li><a href="#NCRRSA" id="toc-NCRRSA"><span
class="toc-section-number">10.4.28</span> NCRRSA</a></li>
<li><a href="#NCRLSA" id="toc-NCRLSA"><span
class="toc-section-number">10.4.29</span> NCRLSA</a></li>
<li><a href="#NCMatrixExpand" id="toc-NCMatrixExpand"><span
class="toc-section-number">10.4.30</span> NCMatrixExpand</a></li>
<li><a href="#NCMatrixReplaceAll" id="toc-NCMatrixReplaceAll"><span
class="toc-section-number">10.4.31</span> NCMatrixReplaceAll</a></li>
<li><a href="#NCMatrixReplaceRepeated"
id="toc-NCMatrixReplaceRepeated"><span
class="toc-section-number">10.4.32</span>
NCMatrixReplaceRepeated</a></li>
<li><a href="#NCReplacePowerRule" id="toc-NCReplacePowerRule"><span
class="toc-section-number">10.4.33</span> NCReplacePowerRule</a></li>
</ul></li>
<li><a href="#PackageNCSelfAdjoint" id="toc-PackageNCSelfAdjoint"><span
class="toc-section-number">10.5</span> NCSelfAdjoint</a>
<ul>
<li><a href="#NCSymmetricQ" id="toc-NCSymmetricQ"><span
class="toc-section-number">10.5.1</span> NCSymmetricQ</a></li>
<li><a href="#NCSymmetricTest" id="toc-NCSymmetricTest"><span
class="toc-section-number">10.5.2</span> NCSymmetricTest</a></li>
<li><a href="#NCSymmetricPart" id="toc-NCSymmetricPart"><span
class="toc-section-number">10.5.3</span> NCSymmetricPart</a></li>
<li><a href="#NCSelfAdjointQ" id="toc-NCSelfAdjointQ"><span
class="toc-section-number">10.5.4</span> NCSelfAdjointQ</a></li>
<li><a href="#NCSelfAdjointTest" id="toc-NCSelfAdjointTest"><span
class="toc-section-number">10.5.5</span> NCSelfAdjointTest</a></li>
</ul></li>
<li><a href="#PackageNCSimplifyRational"
id="toc-PackageNCSimplifyRational"><span
class="toc-section-number">10.6</span> NCSimplifyRational</a>
<ul>
<li><a href="#NCNormalizeInverse" id="toc-NCNormalizeInverse"><span
class="toc-section-number">10.6.1</span> NCNormalizeInverse</a></li>
<li><a href="#NCSimplifyRational" id="toc-NCSimplifyRational"><span
class="toc-section-number">10.6.2</span> NCSimplifyRational</a></li>
<li><a href="#NCSR" id="toc-NCSR"><span
class="toc-section-number">10.6.3</span> NCSR</a></li>
<li><a href="#NCSimplifyRationalSinglePass"
id="toc-NCSimplifyRationalSinglePass"><span
class="toc-section-number">10.6.4</span>
NCSimplifyRationalSinglePass</a></li>
<li><a href="#NCPreSimplifyRational"
id="toc-NCPreSimplifyRational"><span
class="toc-section-number">10.6.5</span> NCPreSimplifyRational</a></li>
<li><a href="#NCPreSimplifyRationalSinglePass"
id="toc-NCPreSimplifyRationalSinglePass"><span
class="toc-section-number">10.6.6</span>
NCPreSimplifyRationalSinglePass</a></li>
</ul></li>
<li><a href="#PackageNCDiff" id="toc-PackageNCDiff"><span
class="toc-section-number">10.7</span> NCDiff</a>
<ul>
<li><a href="#NCDirectionalD" id="toc-NCDirectionalD"><span
class="toc-section-number">10.7.1</span> NCDirectionalD</a></li>
<li><a href="#NCGrad" id="toc-NCGrad"><span
class="toc-section-number">10.7.2</span> NCGrad</a></li>
<li><a href="#NCHessian" id="toc-NCHessian"><span
class="toc-section-number">10.7.3</span> NCHessian</a></li>
<li><a href="#DirectionalD" id="toc-DirectionalD"><span
class="toc-section-number">10.7.4</span> DirectionalD</a></li>
<li><a href="#NCIntegrate" id="toc-NCIntegrate"><span
class="toc-section-number">10.7.5</span> NCIntegrate</a></li>
</ul></li>
<li><a href="#PackageNCConvexity" id="toc-PackageNCConvexity"><span
class="toc-section-number">10.8</span> NCConvexity</a>
<ul>
<li><a href="#NCIndependent" id="toc-NCIndependent"><span
class="toc-section-number">10.8.1</span> NCIndependent</a></li>
<li><a href="#NCConvexityRegion" id="toc-NCConvexityRegion"><span
class="toc-section-number">10.8.2</span> NCConvexityRegion</a></li>
</ul></li>
</ul></li>
<li><a href="#packages-for-manipulating-nc-block-matrices"
id="toc-packages-for-manipulating-nc-block-matrices"><span
class="toc-section-number">11</span> Packages for manipulating NC block
matrices</a>
<ul>
<li><a href="#PackageNCDot" id="toc-PackageNCDot"><span
class="toc-section-number">11.1</span> NCDot</a>
<ul>
<li><a href="#tpMat" id="toc-tpMat"><span
class="toc-section-number">11.1.1</span> tpMat</a></li>
<li><a href="#ajMat" id="toc-ajMat"><span
class="toc-section-number">11.1.2</span> ajMat</a></li>
<li><a href="#coMat" id="toc-coMat"><span
class="toc-section-number">11.1.3</span> coMat</a></li>
<li><a href="#NCDot" id="toc-NCDot"><span
class="toc-section-number">11.1.4</span> NCDot</a></li>
<li><a href="#NCInverse" id="toc-NCInverse"><span
class="toc-section-number">11.1.5</span> NCInverse</a></li>
</ul></li>
<li><a href="#PackageNCMatrixDecompositions"
id="toc-PackageNCMatrixDecompositions"><span
class="toc-section-number">11.2</span> NCMatrixDecompositions</a>
<ul>
<li><a href="#NCLUDecompositionWithPartialPivoting"
id="toc-NCLUDecompositionWithPartialPivoting"><span
class="toc-section-number">11.2.1</span>
NCLUDecompositionWithPartialPivoting</a></li>
<li><a href="#NCLUDecompositionWithCompletePivoting"
id="toc-NCLUDecompositionWithCompletePivoting"><span
class="toc-section-number">11.2.2</span>
NCLUDecompositionWithCompletePivoting</a></li>
<li><a href="#NCLDLDecomposition" id="toc-NCLDLDecomposition"><span
class="toc-section-number">11.2.3</span> NCLDLDecomposition</a></li>
<li><a href="#NCUpperTriangularSolve"
id="toc-NCUpperTriangularSolve"><span
class="toc-section-number">11.2.4</span> NCUpperTriangularSolve</a></li>
<li><a href="#NCLowerTriangularSolve"
id="toc-NCLowerTriangularSolve"><span
class="toc-section-number">11.2.5</span> NCLowerTriangularSolve</a></li>
<li><a href="#NCLUInverse" id="toc-NCLUInverse"><span
class="toc-section-number">11.2.6</span> NCLUInverse</a></li>
<li><a href="#NCLUPartialPivoting" id="toc-NCLUPartialPivoting"><span
class="toc-section-number">11.2.7</span> NCLUPartialPivoting</a></li>
<li><a href="#NCLUCompletePivoting" id="toc-NCLUCompletePivoting"><span
class="toc-section-number">11.2.8</span> NCLUCompletePivoting</a></li>
<li><a href="#NCLeftDivide" id="toc-NCLeftDivide"><span
class="toc-section-number">11.2.9</span> NCLeftDivide</a></li>
<li><a href="#NCRightDivide" id="toc-NCRightDivide"><span
class="toc-section-number">11.2.10</span> NCRightDivide</a></li>
</ul></li>
<li><a href="#PackageMatrixDecompositions"
id="toc-PackageMatrixDecompositions"><span
class="toc-section-number">11.3</span> MatrixDecompositions: linear
algebra templates</a>
<ul>
<li><a href="#LUDecompositionWithPartialPivoting"
id="toc-LUDecompositionWithPartialPivoting"><span
class="toc-section-number">11.3.1</span>
LUDecompositionWithPartialPivoting</a></li>
<li><a href="#LUDecompositionWithCompletePivoting"
id="toc-LUDecompositionWithCompletePivoting"><span
class="toc-section-number">11.3.2</span>
LUDecompositionWithCompletePivoting</a></li>
<li><a href="#LDLDecomposition" id="toc-LDLDecomposition"><span
class="toc-section-number">11.3.3</span> LDLDecomposition</a></li>
<li><a href="#UpperTriangularSolve" id="toc-UpperTriangularSolve"><span
class="toc-section-number">11.3.4</span> UpperTriangularSolve</a></li>
<li><a href="#LowerTriangularSolve" id="toc-LowerTriangularSolve"><span
class="toc-section-number">11.3.5</span> LowerTriangularSolve</a></li>
<li><a href="#LUInverse" id="toc-LUInverse"><span
class="toc-section-number">11.3.6</span> LUInverse</a></li>
<li><a href="#GetLUMatrices" id="toc-GetLUMatrices"><span
class="toc-section-number">11.3.7</span> GetLUMatrices</a></li>
<li><a href="#GetFullLUMatrices" id="toc-GetFullLUMatrices"><span
class="toc-section-number">11.3.8</span> GetFullLUMatrices</a></li>
<li><a href="#GetLDUMatrices" id="toc-GetLDUMatrices"><span
class="toc-section-number">11.3.9</span> GetLDUMatrices</a></li>
<li><a href="#GetFullLDUMatrices" id="toc-GetFullLDUMatrices"><span
class="toc-section-number">11.3.10</span> GetFullLDUMatrices</a></li>
<li><a href="#GetDiagonal" id="toc-GetDiagonal"><span
class="toc-section-number">11.3.11</span> GetDiagonal</a></li>
<li><a href="#LUPartialPivoting" id="toc-LUPartialPivoting"><span
class="toc-section-number">11.3.12</span> LUPartialPivoting</a></li>
<li><a href="#LUCompletePivoting" id="toc-LUCompletePivoting"><span
class="toc-section-number">11.3.13</span> LUCompletePivoting</a></li>
<li><a href="#LURowReduce" id="toc-LURowReduce"><span
class="toc-section-number">11.3.14</span> LURowReduce</a></li>
<li><a href="#LURowReduceIncremental"
id="toc-LURowReduceIncremental"><span
class="toc-section-number">11.3.15</span>
LURowReduceIncremental</a></li>
</ul></li>
</ul></li>
<li><a href="#packages-for-pretty-output-testing-and-utilities"
id="toc-packages-for-pretty-output-testing-and-utilities"><span
class="toc-section-number">12</span> Packages for pretty output,
testing, and utilities</a>
<ul>
<li><a href="#PackageNCOutput" id="toc-PackageNCOutput"><span
class="toc-section-number">12.1</span> NCOutput</a>
<ul>
<li><a href="#NCSetOutput" id="toc-NCSetOutput"><span
class="toc-section-number">12.1.1</span> NCSetOutput</a></li>
</ul></li>
<li><a href="#PackageNCTeX" id="toc-PackageNCTeX"><span
class="toc-section-number">12.2</span> NCTeX</a>
<ul>
<li><a href="#NCTeX" id="toc-NCTeX"><span
class="toc-section-number">12.2.1</span> NCTeX</a></li>
<li><a href="#NCRunDVIPS" id="toc-NCRunDVIPS"><span
class="toc-section-number">12.2.2</span> NCRunDVIPS</a></li>
<li><a href="#NCRunLaTeX" id="toc-NCRunLaTeX"><span
class="toc-section-number">12.2.3</span> NCRunLaTeX</a></li>
<li><a href="#NCRunPDFLaTeX" id="toc-NCRunPDFLaTeX"><span
class="toc-section-number">12.2.4</span> NCRunPDFLaTeX</a></li>
<li><a href="#NCRunPDFViewer" id="toc-NCRunPDFViewer"><span
class="toc-section-number">12.2.5</span> NCRunPDFViewer</a></li>
<li><a href="#NCRunPS2PDF" id="toc-NCRunPS2PDF"><span
class="toc-section-number">12.2.6</span> NCRunPS2PDF</a></li>
</ul></li>
<li><a href="#PackageNCTeXForm" id="toc-PackageNCTeXForm"><span
class="toc-section-number">12.3</span> NCTeXForm</a>
<ul>
<li><a href="#NCTeXForm" id="toc-NCTeXForm"><span
class="toc-section-number">12.3.1</span> NCTeXForm</a></li>
<li><a href="#NCTeXFormSetStarStar" id="toc-NCTeXFormSetStarStar"><span
class="toc-section-number">12.3.2</span> NCTeXFormSetStarStar</a></li>
<li><a href="#NCTeXFormSetStar" id="toc-NCTeXFormSetStar"><span
class="toc-section-number">12.3.3</span> NCTeXFormSetStar</a></li>
</ul></li>
<li><a href="#PackageNCRun" id="toc-PackageNCRun"><span
class="toc-section-number">12.4</span> NCRun</a>
<ul>
<li><a href="#NCRun" id="toc-NCRun"><span
class="toc-section-number">12.4.1</span> NCRun</a></li>
</ul></li>
<li><a href="#PackageNCTest" id="toc-PackageNCTest"><span
class="toc-section-number">12.5</span> NCTest</a>
<ul>
<li><a href="#NCTest" id="toc-NCTest"><span
class="toc-section-number">12.5.1</span> NCTest</a></li>
<li><a href="#NCTestCheck" id="toc-NCTestCheck"><span
class="toc-section-number">12.5.2</span> NCTestCheck</a></li>
<li><a href="#NCTestRun" id="toc-NCTestRun"><span
class="toc-section-number">12.5.3</span> NCTestRun</a></li>
<li><a href="#NCTestSummarize" id="toc-NCTestSummarize"><span
class="toc-section-number">12.5.4</span> NCTestSummarize</a></li>
</ul></li>
<li><a href="#PackageNCDebug" id="toc-PackageNCDebug"><span
class="toc-section-number">12.6</span> NCDebug</a>
<ul>
<li><a href="#NCDebug" id="toc-NCDebug"><span
class="toc-section-number">12.6.1</span> NCDebug</a></li>
</ul></li>
<li><a href="#PackageNCUtil" id="toc-PackageNCUtil"><span
class="toc-section-number">12.7</span> NCUtil</a>
<ul>
<li><a href="#NCGrabSymbols" id="toc-NCGrabSymbols"><span
class="toc-section-number">12.7.1</span> NCGrabSymbols</a></li>
<li><a href="#NCGrabNCSymbols" id="toc-NCGrabNCSymbols"><span
class="toc-section-number">12.7.2</span> NCGrabNCSymbols</a></li>
<li><a href="#NCGrabFunctions" id="toc-NCGrabFunctions"><span
class="toc-section-number">12.7.3</span> NCGrabFunctions</a></li>
<li><a href="#NCGrabIndeterminants" id="toc-NCGrabIndeterminants"><span
class="toc-section-number">12.7.4</span> NCGrabIndeterminants</a></li>
<li><a href="#NCVariables" id="toc-NCVariables"><span
class="toc-section-number">12.7.5</span> NCVariables</a></li>
<li><a href="#NCConsolidateList" id="toc-NCConsolidateList"><span
class="toc-section-number">12.7.6</span> NCConsolidateList</a></li>
<li><a href="#NCConsistentQ" id="toc-NCConsistentQ"><span
class="toc-section-number">12.7.7</span> NCConsistentQ</a></li>
<li><a href="#NCSymbolOrSubscriptQ" id="toc-NCSymbolOrSubscriptQ"><span
class="toc-section-number">12.7.8</span> NCSymbolOrSubscriptQ</a></li>
<li><a href="#NCSymbolOrSubscriptExtendedQ"
id="toc-NCSymbolOrSubscriptExtendedQ"><span
class="toc-section-number">12.7.9</span>
NCSymbolOrSubscriptExtendedQ</a></li>
<li><a href="#NCLeafCount" id="toc-NCLeafCount"><span
class="toc-section-number">12.7.10</span> NCLeafCount</a></li>
<li><a href="#NCReplaceData" id="toc-NCReplaceData"><span
class="toc-section-number">12.7.11</span> NCReplaceData</a></li>
<li><a href="#NCToExpression" id="toc-NCToExpression"><span
class="toc-section-number">12.7.12</span> NCToExpression</a></li>
<li><a href="#NotMatrixQ" id="toc-NotMatrixQ"><span
class="toc-section-number">12.7.13</span> NotMatrixQ</a></li>
</ul></li>
</ul></li>
<li><a href="#data-structures-for-fast-calculations"
id="toc-data-structures-for-fast-calculations"><span
class="toc-section-number">13</span> Data structures for fast
calculations</a>
<ul>
<li><a href="#PackageNCPoly" id="toc-PackageNCPoly"><span
class="toc-section-number">13.1</span> NCPoly</a>
<ul>
<li><a
href="#efficient-storage-of-nc-polynomials-with-rational-coefficients"
id="toc-efficient-storage-of-nc-polynomials-with-rational-coefficients"><span
class="toc-section-number">13.1.1</span> Efficient storage of NC
polynomials with rational coefficients</a></li>
<li><a href="#ways-to-represent-nc-polynomials"
id="toc-ways-to-represent-nc-polynomials"><span
class="toc-section-number">13.1.2</span> Ways to represent NC
polynomials</a></li>
<li><a href="#access-and-utlity-functions"
id="toc-access-and-utlity-functions"><span
class="toc-section-number">13.1.3</span> Access and utlity
functions</a></li>
<li><a href="#formating-functions" id="toc-formating-functions"><span
class="toc-section-number">13.1.4</span> Formating functions</a></li>
<li><a href="#arithmetic-functions" id="toc-arithmetic-functions"><span
class="toc-section-number">13.1.5</span> Arithmetic functions</a></li>
<li><a href="#state-space-realization-functions"
id="toc-state-space-realization-functions"><span
class="toc-section-number">13.1.6</span> State space realization
functions</a></li>
<li><a href="#auxiliary-functions" id="toc-auxiliary-functions"><span
class="toc-section-number">13.1.7</span> Auxiliary functions</a></li>
</ul></li>
<li><a href="#PackageNCPolyInterface"
id="toc-PackageNCPolyInterface"><span
class="toc-section-number">13.2</span> NCPolyInterface</a>
<ul>
<li><a href="#NCToNCPoly" id="toc-NCToNCPoly"><span
class="toc-section-number">13.2.1</span> NCToNCPoly</a></li>
<li><a href="#NCPolyToNC" id="toc-NCPolyToNC"><span
class="toc-section-number">13.2.2</span> NCPolyToNC</a></li>
<li><a href="#NCMonomialOrderQ" id="toc-NCMonomialOrderQ"><span
class="toc-section-number">13.2.3</span> NCMonomialOrderQ</a></li>
<li><a href="#NCMonomialOrder" id="toc-NCMonomialOrder"><span
class="toc-section-number">13.2.4</span> NCMonomialOrder</a></li>
<li><a href="#NCRationalToNCPoly" id="toc-NCRationalToNCPoly"><span
class="toc-section-number">13.2.5</span> NCRationalToNCPoly</a></li>
<li><a href="#NCRuleToPoly" id="toc-NCRuleToPoly"><span
class="toc-section-number">13.2.6</span> NCRuleToPoly</a></li>
<li><a href="#NCToRule" id="toc-NCToRule"><span
class="toc-section-number">13.2.7</span> NCToRule</a></li>
<li><a href="#NCReduce" id="toc-NCReduce"><span
class="toc-section-number">13.2.8</span> NCReduce</a></li>
<li><a href="#NCReduceRepeated" id="toc-NCReduceRepeated"><span
class="toc-section-number">13.2.9</span> NCReduceRepeated</a></li>
<li><a href="#NCMonomialList" id="toc-NCMonomialList"><span
class="toc-section-number">13.2.10</span> NCMonomialList</a></li>
<li><a href="#NCCoefficientRules" id="toc-NCCoefficientRules"><span
class="toc-section-number">13.2.11</span> NCCoefficientRules</a></li>
<li><a href="#NCCoefficientList" id="toc-NCCoefficientList"><span
class="toc-section-number">13.2.12</span> NCCoefficientList</a></li>
<li><a href="#NCCoefficientQ" id="toc-NCCoefficientQ"><span
class="toc-section-number">13.2.13</span> NCCoefficientQ</a></li>
<li><a href="#NCMonomialQ" id="toc-NCMonomialQ"><span
class="toc-section-number">13.2.14</span> NCMonomialQ</a></li>
<li><a href="#NCPolynomialQ" id="toc-NCPolynomialQ"><span
class="toc-section-number">13.2.15</span> NCPolynomialQ</a></li>
</ul></li>
<li><a href="#PackageNCPolynomial" id="toc-PackageNCPolynomial"><span
class="toc-section-number">13.3</span> NCPolynomial</a>
<ul>
<li><a href="#efficient-storage-of-nc-polynomials-with-nc-coefficients"
id="toc-efficient-storage-of-nc-polynomials-with-nc-coefficients"><span
class="toc-section-number">13.3.1</span> Efficient storage of NC
polynomials with nc coefficients</a></li>
<li><a href="#ways-to-represent-nc-polynomials-1"
id="toc-ways-to-represent-nc-polynomials-1"><span
class="toc-section-number">13.3.2</span> Ways to represent NC
polynomials</a></li>
<li><a href="#grouping-terms-by-degree"
id="toc-grouping-terms-by-degree"><span
class="toc-section-number">13.3.3</span> Grouping terms by
degree</a></li>
<li><a href="#utilities" id="toc-utilities"><span
class="toc-section-number">13.3.4</span> Utilities</a></li>
<li><a href="#operations-on-nc-polynomials"
id="toc-operations-on-nc-polynomials"><span
class="toc-section-number">13.3.5</span> Operations on NC
polynomials</a></li>
</ul></li>
<li><a href="#PackageNCQuadratic" id="toc-PackageNCQuadratic"><span
class="toc-section-number">13.4</span> NCQuadratic</a>
<ul>
<li><a href="#NCToNCQuadratic" id="toc-NCToNCQuadratic"><span
class="toc-section-number">13.4.1</span> NCToNCQuadratic</a></li>
<li><a href="#NCPToNCQuadratic" id="toc-NCPToNCQuadratic"><span
class="toc-section-number">13.4.2</span> NCPToNCQuadratic</a></li>
<li><a href="#NCQuadraticToNC" id="toc-NCQuadraticToNC"><span
class="toc-section-number">13.4.3</span> NCQuadraticToNC</a></li>
<li><a href="#NCQuadraticToNCPolynomial"
id="toc-NCQuadraticToNCPolynomial"><span
class="toc-section-number">13.4.4</span>
NCQuadraticToNCPolynomial</a></li>
<li><a href="#NCMatrixOfQuadratic" id="toc-NCMatrixOfQuadratic"><span
class="toc-section-number">13.4.5</span> NCMatrixOfQuadratic</a></li>
<li><a href="#NCQuadraticMakeSymmetric"
id="toc-NCQuadraticMakeSymmetric"><span
class="toc-section-number">13.4.6</span>
NCQuadraticMakeSymmetric</a></li>
</ul></li>
<li><a href="#PackageNCSylvester" id="toc-PackageNCSylvester"><span
class="toc-section-number">13.5</span> NCSylvester</a>
<ul>
<li><a href="#NCToNCSylvester" id="toc-NCToNCSylvester"><span
class="toc-section-number">13.5.1</span> NCToNCSylvester</a></li>
<li><a href="#NCPToNCSylvester" id="toc-NCPToNCSylvester"><span
class="toc-section-number">13.5.2</span> NCPToNCSylvester</a></li>
<li><a href="#NCSylvesterToNC" id="toc-NCSylvesterToNC"><span
class="toc-section-number">13.5.3</span> NCSylvesterToNC</a></li>
<li><a href="#NCSylvesterToNCPolynomial"
id="toc-NCSylvesterToNCPolynomial"><span
class="toc-section-number">13.5.4</span>
NCSylvesterToNCPolynomial</a></li>
</ul></li>
</ul></li>
<li><a href="#NCGBChapter" id="toc-NCGBChapter"><span
class="toc-section-number">14</span> Noncommutative Gröbner Bases
Algorithms</a>
<ul>
<li><a href="#PackageNCGBX" id="toc-PackageNCGBX"><span
class="toc-section-number">14.1</span> NCGBX</a>
<ul>
<li><a href="#SetMonomialOrder" id="toc-SetMonomialOrder"><span
class="toc-section-number">14.1.1</span> SetMonomialOrder</a></li>
<li><a href="#SetKnowns" id="toc-SetKnowns"><span
class="toc-section-number">14.1.2</span> SetKnowns</a></li>
<li><a href="#SetUnknowns" id="toc-SetUnknowns"><span
class="toc-section-number">14.1.3</span> SetUnknowns</a></li>
<li><a href="#ClearMonomialOrder" id="toc-ClearMonomialOrder"><span
class="toc-section-number">14.1.4</span> ClearMonomialOrder</a></li>
<li><a href="#GetMonomialOrder" id="toc-GetMonomialOrder"><span
class="toc-section-number">14.1.5</span> GetMonomialOrder</a></li>
<li><a href="#PrintMonomialOrder" id="toc-PrintMonomialOrder"><span
class="toc-section-number">14.1.6</span> PrintMonomialOrder</a></li>
<li><a href="#NCMakeGB" id="toc-NCMakeGB"><span
class="toc-section-number">14.1.7</span> NCMakeGB</a></li>
<li><a href="#NCProcess" id="toc-NCProcess"><span
class="toc-section-number">14.1.8</span> NCProcess</a></li>
<li><a href="#NCGBSimplifyRational" id="toc-NCGBSimplifyRational"><span
class="toc-section-number">14.1.9</span> NCGBSimplifyRational</a></li>
</ul></li>
<li><a href="#PackageNCPolyGroebner"
id="toc-PackageNCPolyGroebner"><span
class="toc-section-number">14.2</span> NCPolyGroebner</a>
<ul>
<li><a href="#NCPolyGroebner" id="toc-NCPolyGroebner"><span
class="toc-section-number">14.2.1</span> NCPolyGroebner</a></li>
</ul></li>
<li><a href="#PackageNCGB" id="toc-PackageNCGB"><span
class="toc-section-number">14.3</span> NCGB</a></li>
</ul></li>
<li><a href="#SDPChapter" id="toc-SDPChapter"><span
class="toc-section-number">15</span> Semidefinite Programming
Algorithms</a>
<ul>
<li><a href="#PackageNCSDP" id="toc-PackageNCSDP"><span
class="toc-section-number">15.1</span> NCSDP</a>
<ul>
<li><a href="#NCSDP" id="toc-NCSDP"><span
class="toc-section-number">15.1.1</span> NCSDP</a></li>
<li><a href="#NCSDPForm" id="toc-NCSDPForm"><span
class="toc-section-number">15.1.2</span> NCSDPForm</a></li>
<li><a href="#NCSDPDual" id="toc-NCSDPDual"><span
class="toc-section-number">15.1.3</span> NCSDPDual</a></li>
<li><a href="#NCSDPDualForm" id="toc-NCSDPDualForm"><span
class="toc-section-number">15.1.4</span> NCSDPDualForm</a></li>
</ul></li>
<li><a href="#PackageSDP" id="toc-PackageSDP"><span
class="toc-section-number">15.2</span> SDP</a>
<ul>
<li><a href="#SDPMatrices" id="toc-SDPMatrices"><span
class="toc-section-number">15.2.1</span> SDPMatrices</a></li>
<li><a href="#SDPSolve" id="toc-SDPSolve"><span
class="toc-section-number">15.2.2</span> SDPSolve</a></li>
<li><a href="#SDPEval" id="toc-SDPEval"><span
class="toc-section-number">15.2.3</span> SDPEval</a></li>
<li><a href="#SDPPrimalEval" id="toc-SDPPrimalEval"><span
class="toc-section-number">15.2.4</span> SDPPrimalEval</a></li>
<li><a href="#SDPDualEval" id="toc-SDPDualEval"><span
class="toc-section-number">15.2.5</span> SDPDualEval</a></li>
<li><a href="#SDPSylvesterEval" id="toc-SDPSylvesterEval"><span
class="toc-section-number">15.2.6</span> SDPSylvesterEval</a></li>
</ul></li>
<li><a href="#PackageSDPFlat" id="toc-PackageSDPFlat"><span
class="toc-section-number">15.3</span> SDPFlat</a>
<ul>
<li><a href="#SDPFlatData" id="toc-SDPFlatData"><span
class="toc-section-number">15.3.1</span> SDPFlatData</a></li>
<li><a href="#SDPFlatPrimalEval" id="toc-SDPFlatPrimalEval"><span
class="toc-section-number">15.3.2</span> SDPFlatPrimalEval</a></li>
<li><a href="#SDPFlatDualEval" id="toc-SDPFlatDualEval"><span
class="toc-section-number">15.3.3</span> SDPFlatDualEval</a></li>
<li><a href="#SDPFlatSylvesterEval" id="toc-SDPFlatSylvesterEval"><span
class="toc-section-number">15.3.4</span> SDPFlatSylvesterEval</a></li>
</ul></li>
<li><a href="#PackageSDPSylvester" id="toc-PackageSDPSylvester"><span
class="toc-section-number">15.4</span> SDPSylvester</a>
<ul>
<li><a href="#SDPSylvesterSDPEval" id="toc-SDPSylvesterSDPEval"><span
class="toc-section-number">15.4.1</span> SDPEval</a></li>
<li><a href="#SDPSylvesterPrimalEval"
id="toc-SDPSylvesterPrimalEval"><span
class="toc-section-number">15.4.2</span> SDPSylvesterPrimalEval</a></li>
<li><a href="#SDPSylvesterDualEval" id="toc-SDPSylvesterDualEval"><span
class="toc-section-number">15.4.3</span> SDPSylvesterDualEval</a></li>
<li><a href="#SDPSylvesterSylvesterEval"
id="toc-SDPSylvesterSylvesterEval"><span
class="toc-section-number">15.4.4</span>
SDPSylvesterSylvesterEval</a></li>
</ul></li>
<li><a href="#PackagePrimalDual" id="toc-PackagePrimalDual"><span
class="toc-section-number">15.5</span> PrimalDual</a>
<ul>
<li><a href="#PrimalDual" id="toc-PrimalDual"><span
class="toc-section-number">15.5.1</span> PrimalDual</a></li>
</ul></li>
<li><a href="#PackageNCPolySOS" id="toc-PackageNCPolySOS"><span
class="toc-section-number">15.6</span> NCPolySOS</a>
<ul>
<li><a href="#NCPolySOS" id="toc-NCPolySOS"><span
class="toc-section-number">15.6.1</span> NCPolySOS</a></li>
<li><a href="#NCPolySOSToSDP" id="toc-NCPolySOSToSDP"><span
class="toc-section-number">15.6.2</span> NCPolySOSToSDP</a></li>
</ul></li>
</ul></li>
<li><a href="#WorkInProgress" id="toc-WorkInProgress"><span
class="toc-section-number">16</span> Work in Progress</a>
<ul>
<li><a href="#PackageNCRational" id="toc-PackageNCRational"><span
class="toc-section-number">16.1</span> NCRational</a>
<ul>
<li><a href="#state-space-realizations-for-nc-rationals"
id="toc-state-space-realizations-for-nc-rationals"><span
class="toc-section-number">16.1.1</span> State-space realizations for NC
rationals</a></li>
<li><a href="#utilities-1" id="toc-utilities-1"><span
class="toc-section-number">16.1.2</span> Utilities</a></li>
<li><a href="#operations-on-nc-rationals"
id="toc-operations-on-nc-rationals"><span
class="toc-section-number">16.1.3</span> Operations on NC
rationals</a></li>
<li><a href="#minimal-realizations" id="toc-minimal-realizations"><span
class="toc-section-number">16.1.4</span> Minimal realizations</a></li>
</ul></li>
<li><a href="#PackageNCRealization" id="toc-PackageNCRealization"><span
class="toc-section-number">16.2</span> NCRealization</a>
<ul>
<li><a href="#NCDescriptorRealization"
id="toc-NCDescriptorRealization"><span
class="toc-section-number">16.2.1</span>
NCDescriptorRealization</a></li>
<li><a href="#NCDeterminantalRepresentationReciprocal"
id="toc-NCDeterminantalRepresentationReciprocal"><span
class="toc-section-number">16.2.2</span>
NCDeterminantalRepresentationReciprocal</a></li>
<li><a href="#NCMatrixDescriptorRealization"
id="toc-NCMatrixDescriptorRealization"><span
class="toc-section-number">16.2.3</span>
NCMatrixDescriptorRealization</a></li>
<li><a href="#NCMinimalDescriptorRealization"
id="toc-NCMinimalDescriptorRealization"><span
class="toc-section-number">16.2.4</span>
NCMinimalDescriptorRealization</a></li>
<li><a href="#NCSymmetricDescriptorRealization"
id="toc-NCSymmetricDescriptorRealization"><span
class="toc-section-number">16.2.5</span>
NCSymmetricDescriptorRealization</a></li>
<li><a href="#NCSymmetricDeterminantalRepresentationDirect"
id="toc-NCSymmetricDeterminantalRepresentationDirect"><span
class="toc-section-number">16.2.6</span>
NCSymmetricDeterminantalRepresentationDirect</a></li>
<li><a href="#NCSymmetricDeterminantalRepresentationReciprocal"
id="toc-NCSymmetricDeterminantalRepresentationReciprocal"><span
class="toc-section-number">16.2.7</span>
NCSymmetricDeterminantalRepresentationReciprocal</a></li>
<li><a href="#NCSymmetrizeMinimalDescriptorRealization"
id="toc-NCSymmetrizeMinimalDescriptorRealization"><span
class="toc-section-number">16.2.8</span>
NCSymmetrizeMinimalDescriptorRealization</a></li>
<li><a href="#NonCommutativeLift" id="toc-NonCommutativeLift"><span
class="toc-section-number">16.2.9</span> NonCommutativeLift</a></li>
<li><a href="#SignatureOfAffineTerm"
id="toc-SignatureOfAffineTerm"><span
class="toc-section-number">16.2.10</span> SignatureOfAffineTerm</a></li>
<li><a href="#TestDescriptorRealization"
id="toc-TestDescriptorRealization"><span
class="toc-section-number">16.2.11</span>
TestDescriptorRealization</a></li>
<li><a href="#PinnedQ" id="toc-PinnedQ"><span
class="toc-section-number">16.2.12</span> PinnedQ</a></li>
<li><a href="#PinningSpace" id="toc-PinningSpace"><span
class="toc-section-number">16.2.13</span> PinningSpace</a></li>
</ul></li>
</ul></li>
<li><a href="#references" id="toc-references">References</a></li>
</ul>
</nav>
<h1 class="unnumbered" id="license">License</h1>
<p><strong>NCAlgebra</strong> is distributed under the terms of the BSD
License:</p>
<pre><code>Copyright (c) 2023, J. William Helton and Mauricio C. de Oliveira
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:
    * Redistributions of source code must retain the above copyright
      notice, this list of conditions and the following disclaimer.
    * Redistributions in binary form must reproduce the above copyright
      notice, this list of conditions and the following disclaimer in the
      documentation and/or other materials provided with the distribution.
    * Neither the name NCAlgebra nor the names of its contributors may be
      used to endorse or promote products derived from this software without
      specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDERS BE LIABLE FOR ANY
DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</code></pre>
<h1 class="unnumbered" id="acknowledgements">Acknowledgements</h1>
<p>This work was partially supported by the Division of Mathematical
Sciences of the National Science Foundation.</p>
<p>The program was written by the authors with major earlier
contributions from:</p>
<ul>
<li>Mark Stankus, Math, Cal Poly San Luis Obispo</li>
<li>Robert L. Miller, General Atomics Corp</li>
</ul>
<p>Considerable recent help came from</p>
<ul>
<li>Igor Klep, University of Ljubljana</li>
<li>Aidan Epperly</li>
</ul>
<p>Other contributors include:</p>
<ul>
<li>David Hurst, Daniel Lamm, Orlando Merino, Robert Obar, Henry
Pfister, Mike Walker, John Wavrik, Lois Yu, J. Camino, J. Griffin, J.
Ovall, T. Shaheen, John Shopple.</li>
</ul>
<p>The beginnings of the program come from eran@slac.</p>
<h1 data-number="1" id="Version6_0"><span
class="header-section-number">1</span> Changes in Version 6.0</h1>
<h2 data-number="1.1" id="Version6_0_1"><span
class="header-section-number">1.1</span> Version 6.0.1</h2>
<ol type="1">
<li>Fixed SparseArray Mathematica bug affecting
<code>NCFromDigits</code>.</li>
</ol>
<h2 data-number="1.2" id="Version6_0_0"><span
class="header-section-number">1.2</span> Version 6.0.0</h2>
<ol type="1">
<li><p>NCAlgebra is now distributed as a <em>paclet</em>!</p></li>
<li><p>Changed cannonical representation of noncommutative expressions
to allow for powers to be present in
<code>NonCommutativeMultiply</code>.</p>
<blockquote>
<p><strong>WARNING:</strong> THIS IS A BREAKING CHANGE THAT CAN AFFECT
EXISTING PROGRAMS USING NCALGEBRA. THE MOST NOTABLE LIKELY CONSTRUCTION
THAT IS AFFECTED BY THIS CHANGE IS THE APPLICATION OF RULES BASED ON
PATTERN MATCHING, WHICH NOW NEED TO EXPLICITLY TAKE INTO ACCOUNT THE
PRESENCE OF EXPONENTS. SEE <a href="#BasicReplace">NOTES ON MANUAL</a>
FOR DETAILS ON HOW TO MITIGATE THE IMPACT OF THIS CHANGE. ALL NCALGEBRA
COMMANDS HAVE BEEN REWRITTEN TO ACCOMODATE FOR THIS CHANGE IN
REPRESENTATION.</p>
</blockquote></li>
<li><p><code>NCTEST</code> renamed <code>NCCORETEST</code></p></li>
<li><p>Tests must now be run as contexts:
e.g. <code>&lt;&lt; NCCORETEST`</code> instead of
<code>&lt;&lt; NCCORETEST</code></p></li>
<li><p><code>NonCommutativeMultiply</code>: new functions <a
href="#NCExpandExponents">NCExpandExponents</a> and <a
href="#NCToList">NCToList</a>.</p></li>
<li><p><code>NCReplace</code>: new functions <a
href="#NCReplacePowerRule">NCReplacePowerRule</a>, <a
href="#NCExpandReplaceRepeated">NCExpandReplaceRepeated</a>; <a
href="#NCExpandReplaceRepeatedSymmetric">NCExpandReplaceRepeatedSymmetric</a>;
<a
href="#NCExpandReplaceRepeatedSelfAdjoint">NCExpandReplaceRepeatedSelfAdjoint</a>;
new option <code>ApplyPowerRule</code>.</p></li>
<li><p><code>NCGBX</code>: <a href="#NCMakeGB">NCMakeGB</a> option
<code>ReduceBasis</code> now defaults to <code>True</code>.</p></li>
<li><p><code>NCCollect</code>: new function <a
href="#NCCollectExponents">NCCollectExponents</a>.</p></li>
<li><p><code>MatrixDecompositions</code>: functions <a
href="#GetLDUMatrices">GetLDUMatrices</a> and <a
href="#GetFullLDUMatrices">GetFullLDUMatrices</a> now produces low rank
matrices.</p></li>
<li><p><code>NCPoly</code>: new function <a
href="#NCPolyFromGramMatrixFactors">NCPolyFromGramMatrixFactors</a>.
<code>NCPolyFullReduce</code> renamed <a
href="#NCPolyReduceRepeated">NCPolyReduceRepeated</a>.</p></li>
<li><p><code>NCPolyInterface</code>: new functions <a
href="#NCToRule">NCToRule</a>, <a href="#NCReduce">NCReduce</a>, <a
href="#NCReduceRepeated">NCReduceRepeated</a>, <a
href="#NCRationalToNCPoly">NCRationalToNCPoly</a>, <a
href="#NCMonomialOrder">NCMonomialOrder</a>, and <a
href="#NCMonomialOrderQ">NCMonomialOrderQ</a>.</p></li>
<li><p>New utility functions <a
href="#SetCommutativeFunction">SetCommutativeFunction</a>, <a
href="#SetNonCommutativeFunction">SetNonCommutativeFunction</a> <a
href="#NCSymbolOrSubscriptExtendedQ">NCSymbolOrSubscriptExtendedQ</a>,
and <a
href="#NCNonCommutativeSymbolOrSubscriptExtendedQ">NCNonCommutativeSymbolOrSubscriptExtendedQ</a>.</p></li>
<li><p>The old <code>C++</code> version of <code>NCGB</code> is no
longer compatible with <code>NCAlgebra</code> <em>version 6</em>.
Consider using <a href="#PackageNCGBX"><code>NCGBX</code></a>
instead.</p></li>
<li><p>No longer loads the package <code>Notation</code> by default.
Controlled by the new option <code>UseNotation</code> in <a
href="#PackageNCOptions"><code>NCOptions</code></a>.</p></li>
<li><p>Streamlined rules for <a
href="#NCSimplifyRational">NCSimplifyRational</a>.</p></li>
</ol>
<h1 data-number="2" id="Version5_0"><span
class="header-section-number">2</span> Changes in Version 5.0</h1>
<h2 data-number="2.1" id="Version5_0_6"><span
class="header-section-number">2.1</span> Version 5.0.6</h2>
<ol type="1">
<li><code>NC</code> and <code>NCAlgebra</code> are now Contexts</li>
<li>NCMatrixExpand moved from NCDot to NCReplace</li>
<li>Added <a
href="#SetCommutativeFunction">SetCommutativeFunction</a></li>
<li>Added <a href="#tr">tr</a> operator</li>
<li>Tests fixed to work even if a-z are not defined as NC globally</li>
<li>More tests for CommutativeQ</li>
<li>Compatibility with Mathematica 13.0.0</li>
</ol>
<h2 data-number="2.2" id="Version5_0_5"><span
class="header-section-number">2.2</span> Version 5.0.5</h2>
<ol type="1">
<li>Improved documentation</li>
<li>Bug fixes. Thanks Igor Klep!</li>
</ol>
<h2 data-number="2.3" id="Version5_0_4"><span
class="header-section-number">2.3</span> Version 5.0.4</h2>
<ol type="1">
<li>First implementation of <a
href="#NCPolyGramMatrix">NCPolyGramMatrix</a> and <a
href="#NCPolyFromGramMatrix">NCPolyFromGramMatrix</a>.</li>
<li>Improvements in NCReplace.</li>
<li>Several bug fixes and improvements. Thanks Eric Evert!</li>
</ol>
<h2 data-number="2.4" id="Version5_0_3"><span
class="header-section-number">2.4</span> Version 5.0.3</h2>
<ol type="1">
<li>Restored functionality of <a
href="#SetCommutingOperators">SetCommutingOperators</a>.</li>
<li>Improved implementation of <a href="#CommutativeQ">CommutativeQ</a>
for arrays.</li>
</ol>
<h2 data-number="2.5" id="Version5_0_2"><span
class="header-section-number">2.5</span> Version 5.0.2</h2>
<ol type="1">
<li><code>NCCollect</code> and <code>NCStrongCollect</code> can handle
commutative variables.</li>
<li>Cleaned up initialization files.</li>
<li>New function <code>SetNonCommutativeHold</code> with
<code>HoldAll</code> attribute can be used to set Symbols that have been
previously assigned values.</li>
</ol>
<h2 data-number="2.6" id="Version5_0_1"><span
class="header-section-number">2.6</span> Version 5.0.1</h2>
<ol type="1">
<li>Introducing <code>NCWebInstall</code> and
<code>NCWebUpdate</code>.</li>
<li>Bug fixes.</li>
</ol>
<h2 data-number="2.7" id="Version5_0_0"><span
class="header-section-number">2.7</span> Version 5.0.0</h2>
<ol type="1">
<li>Completely rewritten core handling of noncommutative expressions
with significant speed gains.</li>
<li>Completely rewritten noncommutative Gröbner basis algorithm without
any dependence on compiled code. See chapter <a
href="#NCGB">Noncommutative Gröbner Basis</a> in the user guide and the
<a href="#PackageNCGBX">NCGBX</a> package. Some <code>NCGB</code>
features are not fully supported yet, most notably <a
href="#NCProcess">NCProcess</a>.</li>
<li>New algorithms for representing and operating with noncommutative
polynomials with commutative coefficients. These support the new package
<a href="#PackageNCGBX">NCGBX</a>. See this section in the chapter <a
href="#PolysWithCommutativeCoefficients">More Advanced Commands</a> and
the packages <a href="#PackageNCPolyInterface">NCPolyInterface</a> and
<a href="#PackageNCPoly">NCPoly</a>.</li>
<li>New algorithms for representing and operating with noncommutative
polynomials with noncommutative coefficients (<a
href="#PackageNCPolynomial">NCPolynomial</a>) with specialized
facilities for noncommutative quadratic polynomials (<a
href="#PackageNCQuadratic">NCQuadratic</a>) and noncommutative linear
polynomials (<a href="#PackageNCSylvester">NCSylvester</a>).</li>
<li>Modified behavior of <code>CommuteEverything</code> (see important
notes in <a href="#CommuteEverything">CommuteEverything</a>).</li>
<li>Improvements and consolidation of noncommutative calculus in the
package <a href="#PackageNCDiff">NCDiff</a>.</li>
<li>Added a complete set of linear algebra algorithms in the new package
<a href="#PackageMatrixDecompositions">MatrixDecompositions</a> and
their noncommutative versions in the new package <a
href="#PackageNCMatrixDecompositions">NCMatrixDecompositions</a>.</li>
<li>General improvements on the Semidefinite Programming package <a
href="#PackageNCSDP">NCSDP</a>.</li>
<li>New algorithms for simplification of noncommutative rationals (<a
href="#PackageNCSylvester">NCSimplifyRational</a>).</li>
<li>Commands <code>Transform</code>, <code>Substitute</code>,
<code>SubstituteSymmetric</code>, etc, have been replaced by the much
more reliable commands in the new package <a
href="#PackageNCReplace">NCReplace</a>.</li>
<li>Command <code>MatMult</code> has been replaced by <a
href="#NCDot">NCDot</a>. Alias <code>MM</code> has been deprecated.</li>
<li>Noncommutative power is now supported, with <code>x^3</code>
expanding to <code>x**x**x</code>, <code>x^-1</code> expanding to
<code>inv[x]</code>.</li>
<li><code>x^T</code> expands to <code>tp[x]</code> and <code>x^*</code>
expands to <code>aj[x]</code>. Symbol <code>T</code> is now
protected.</li>
<li>Support for subscripted variables in notebooks.</li>
</ol>
<h1 data-number="3" id="UserGuideIntroduction"><span
class="header-section-number">3</span> Introduction</h1>
<p>This <em>User Guide</em> attempts to document the many improvements
introduced in <code>NCAlgebra</code> <strong>Version 6</strong>. Please
be patient, as we move to incorporate the many recent changes into this
document.</p>
<p>See <a href="#ReferenceIntroduction">Reference Manual</a> for a
detailed description of the available commands.</p>
<p>There are also notebooks in the <code>NC/DEMOS</code> directory that
accompany each of the chapters of this user guide.</p>
<h2 data-number="3.1" id="InstallingNCAlgebra"><span
class="header-section-number">3.1</span> Installing NCAlgebra</h2>
<p>Starting with <strong>Version 6</strong>, it is recommended that
NCAlgebra be installed using our paclet distribution. Just type:</p>
<pre><code>PacletInstall[&quot;https://github.com/NCAlgebra/NC/blob/master/NCAlgebra-6.0.0.paclet?raw=true&quot;];</code></pre>
<p>or</p>
<pre><code>PacletInstall[&quot;https://github.com/NCAlgebra/NC/raw/NCAlgebra-6.0.1.paclet&quot;];</code></pre>
<p>for the latest beta version.</p>
<p>In the near future we plan to submit paclets to the Wolfram paclet
repository for easier updates.</p>
<p>Alternatively, you can download and install NCAlgebra as outlined in
the section <a href="#ManualInstallation">Manual Installation</a>.</p>
<h2 data-number="3.2" id="RunningNCAlgebra"><span
class="header-section-number">3.2</span> Running NCAlgebra</h2>
<p>In <em>Mathematica</em> (notebook or text interface), type</p>
<pre><code>&lt;&lt; NCAlgebra`</code></pre>
<p>to load <code>NCAlgebra</code>.</p>
<p>Advanced options for controlling the loading of <code>NC</code> and
<code>NCAlgebra</code> can be found in <a href="#NCOptions">here</a> and
<a href="#PackageNCAlgebra">here</a>.</p>
<blockquote>
<p>If you performed a manual installation of NCAlgebra you will need to
type</p>
<pre><code>&lt;&lt; NC`</code></pre>
<p>before loading NCAlgebra.</p>
<p>If this step fails, your installation has problems (check out
installation instructions in <a href="#ManualInstallation">Manual
Installation</a>). If your installation is succesful, you will see a
message like:</p>
<pre><code>NC::Directory: You are using the version of NCAlgebra which is
found in: &quot;/your_home_directory/NC&quot;.</code></pre>
<p>In the paclet version, it is no longer necessary to load the context
<code>NC</code> before running NCAlgebra.</p>
<p>Loading the context <code>NC</code> in the paclet version is however
still supported for backward compatibility. It does nothing more than
posting the message:</p>
<pre><code>NC::Directory: You are using a paclet version of NCAlgebra.</code></pre>
</blockquote>
<h2 data-number="3.3" id="now-what"><span
class="header-section-number">3.3</span> Now what?</h2>
<p>Extensive documentation is found at</p>
<p><a
href="https://NCAlgebra.github.io">https://NCAlgebra.github.io</a></p>
<p>and in the distribution directory</p>
<p><a
href="https://github.com/NCAlgebra/NC/DOCUMENTATION">https://github.com/NCAlgebra/NC/DOCUMENTATION</a></p>
<p>which includes this document.</p>
<p>You may want to try some of the several demo files in the directory
<code>DEMOS</code> after installing <code>NCAlgebra</code>.</p>
<p>You can also run some tests to see if things are working fine.</p>
<h2 data-number="3.4" id="testing"><span
class="header-section-number">3.4</span> Testing</h2>
<p>There are 3 test sets which you can use to troubleshoot parts of
NCAlgebra. The most comprehensive test set is run by typing:</p>
<pre><code>&lt;&lt; NCCORETEST`</code></pre>
<p>This will test the core functionality of NCAlgebra.</p>
<p>You can test functionality related to the package <a
href="#PackageNCPoly"><code>NCPoly</code></a>, including the new
<code>NCGBX</code> package <a
href="#PackageNCGBX"><code>NCGBX</code></a>, by typing:</p>
<pre><code>&lt;&lt; NCPOLYTEST`</code></pre>
<p>Finally our Semidefinite Programming Solver <a
href="#PackageNCSDP"><code>NCSDP</code></a> can be tested with</p>
<pre><code>&lt;&lt; NCSDPTEST`</code></pre>
<p>We recommend that you restart the kernel before and after running
tests. Each test takes a few minutes to run.</p>
<p>You can also call</p>
<pre><code>&lt;&lt; NCPOLYTESTGB`</code></pre>
<p>to perform extensive and long testing of <code>NCGBX</code>.</p>
<blockquote>
<p>If you performed a manual installation of NCAlgebra you will need to
type</p>
<pre><code>&lt;&lt; NC`</code></pre>
<p>before before running any of the tests above.</p>
</blockquote>
<h2 data-number="3.5" id="pre-2017-ncgb-c-version"><span
class="header-section-number">3.5</span> Pre-2017 NCGB C++ version</h2>
<p>Starting with <strong>Version 6</strong>, the old <code>C++</code>
version of our Groebner Basis Algorithm is no longer included. Consider
using <a href="#PackageNCGBX"><code>NCGBX</code></a>.</p>
<h1 data-number="4" id="MostBasicCommands"><span
class="header-section-number">4</span> Most Basic Commands</h1>
<p>This chapter provides a gentle introduction to some of the commands
available in <code>NCAlgebra</code>.</p>
<p>If you want a living analog of this chapter just run the notebook
<code>NC/DEMOS/1_MostBasicCommands.nb</code>.</p>
<p>Before you can use <code>NCAlgebra</code> you first load it with the
following commands:</p>
<pre><code>&lt;&lt; NC`
&lt;&lt; NCAlgebra`</code></pre>
<blockquote>
<p>If you installed the paclet version of NCAlgebra it is not necessary
to load the context <code>NC</code> before loading other
<code>NCAlgebra</code> packages. A dummy package <code>NC</code> is
provided in case you would like to keep your NCAlgebra work compatible
with previous versions.</p>
</blockquote>
<h2 data-number="4.1" id="to-commute-or-not-to-commute"><span
class="header-section-number">4.1</span> To Commute Or Not To
Commute?</h2>
<p>In <code>NCAlgebra</code>, the operator <code>**</code> denotes
<em>noncommutative multiplication</em>. At present, single-letter lower
case variables are noncommutative by default and all others are
commutative by default. For example:</p>
<pre><code>a**b-b**a</code></pre>
<p>results in</p>
<pre class="output"><code>a**b-b**a</code></pre>
<p>while</p>
<pre><code>A**B-B**A
A**b-b**A</code></pre>
<p>both result in <code>0</code>.</p>
<p>One of Bill’s favorite commands is <code>CommuteEverything</code>,
which temporarily makes all noncommutative symbols appearing in a given
expression to behave as if they were commutative and returns the
resulting commutative expression. For example:</p>
<pre><code>CommuteEverything[a**b-b**a]</code></pre>
<p>results in <code>0</code>. The command</p>
<pre><code>EndCommuteEverything[]</code></pre>
<p>restores the original noncommutative behavior.</p>
<p>One can make any symbol behave as noncommutative using
<code>SetNonCommutative</code>. For example:</p>
<pre><code>SetNonCommutative[A,B]
A**B-B**A</code></pre>
<p>results in:</p>
<pre class="output"><code>A**B-B**A</code></pre>
<p>Likewise, symbols can be made commutative using
<code>SetCommutative</code>. For example:</p>
<pre><code>SetNonCommutative[A] 
SetCommutative[B]
A**B-B**A</code></pre>
<p>results in <code>0</code>. <code>SNC</code> is an alias for
<code>SetNonCommutative</code>. So, <code>SNC</code> can be typed rather
than the longer <code>SetNonCommutative</code>:</p>
<pre><code>SNC[A];
A**a-a**A</code></pre>
<p>results in:</p>
<pre class="output"><code>-a**A+A**a</code></pre>
<p>One can check whether a given symbol is commutative or not using
<code>CommutativeQ</code> or <code>NonCommutativeQ</code>. For
example:</p>
<pre><code>CommutativeQ[B]
NonCommutativeQ[a]</code></pre>
<p>both return <code>True</code>.</p>
<blockquote>
<p><strong>WARNING:</strong> Prior to <strong>Version 6</strong>,
noncommutative monomials would be stored in expanded form, without
exponents. For example, the monomial</p>
<pre><code>a**b**a^2**b</code></pre>
<p>would be stored as</p>
<pre class="output"><code>NonCommutativeMultiply[a, b, a, a, b]</code></pre>
<p>The automatic expansion of powers of noncommutative symbols required
overloading the behavior of the built in <code>Power</code> operator,
which was interfering and causing much trouble when commutative
polynomial operations were performed inside an <code>NCAlgebra</code>
session.</p>
<p>Starting with <strong>Version 6</strong>, noncommutative monomials
are represented with exponents. For instance, the same monomial above is
now represented as</p>
<pre class="output"><code>NonCommutativeMultiply[a, b, Power[a, 2], b]</code></pre>
<p>Even if you type <code>a**b**a**a**b</code>, the repeated symbols get
compressed to the compact representation with exponents. Exponents are
now also used to represent the noncommutative inverse. See the notes in
the next section.</p>
</blockquote>
<h2 data-number="4.2" id="BasicInverses"><span
class="header-section-number">4.2</span> Inverses</h2>
<p>The multiplicative identity is denoted <code>Id</code> in the
program. At the present time, <code>Id</code> is set to 1.</p>
<p>A symbol <code>a</code> may have an inverse, which will be denoted by
<code>inv[a]</code>. <code>inv</code> operates as expected in most
cases.</p>
<p>For example:</p>
<pre><code>inv[a]**a
inv[a**b]**a**b</code></pre>
<p>both lead to <code>Id = 1</code> and</p>
<pre><code>a**b**inv[b]</code></pre>
<p>results in <code>a</code>.</p>
<blockquote>
<p><strong>WARNING:</strong> Starting with <strong>Version 6</strong>,
the <code>inv</code> operator acts mostly as a wrapper for
<code>Power</code>. For example, <code>inv[a]</code> internally
evaluates to <code>Power[a, -1]</code>. However, <code>inv</code> is
still available and used to display the noncommutative inverse of
noncommutative expressions outside of a notebook environment. Beware
that <code>inv[a**a]</code> now evaluates to <code>Power[a, -2]</code>,
hence certain patterns may no longer work. For example:</p>
<pre><code>NCReplace[inv[a**a], a**a -&gt; b]</code></pre>
<p>would produce <code>inv[b]</code> in previous versions of
<code>NCAlgebra</code> but will fail in <strong>Version 6</strong>.</p>
</blockquote>
<blockquote>
<p><strong>WARNING:</strong> Since <strong>Version 5</strong>,
<code>inv</code> no longer automatically distributes over noncommutative
products. If this more aggressive behavior is desired use
<code>SetOptions[inv, Distribute -&gt; True]</code>. For example</p>
<pre><code>SetOptions[inv, Distribute -&gt; True]
inv[a**b]</code></pre>
<p>returns <code>inv[b]**inv[a]</code>. Conversely</p>
<pre><code>SetOptions[inv, Distribute -&gt; False]
inv[a**b]</code></pre>
<p>returns <code>inv[a**b]</code>.</p>
</blockquote>
<h2 data-number="4.3" id="transposes-and-adjoints"><span
class="header-section-number">4.3</span> Transposes and Adjoints</h2>
<p><code>tp[x]</code> denotes the transpose of symbol <code>x</code> and
<code>aj[x]</code> denotes the adjoint of symbol <code>x</code>. Like
<code>inv</code>, the properties of transposes and adjoints that
everyone uses constantly are built-in. For example:</p>
<pre><code>tp[a**b]</code></pre>
<p>leads to</p>
<pre class="output"><code>tp[b]**tp[a]</code></pre>
<p>and</p>
<pre><code>tp[a+b]</code></pre>
<p>returns</p>
<pre class="output"><code>tp[a]+tp[b]</code></pre>
<p>Likewise, <code>tp[tp[a]] == a</code> and <code>tp</code> for
anything for which <code>CommutativeQ</code> returns <code>True</code>
is simply the identity. For example <code>tp[5] == 5</code>,
<code>tp[2 + 3I] == 2 + 3 I</code>, and <code>tp[B] == B</code>.</p>
<p>Similar properties hold to <code>aj</code>. Moreover</p>
<pre><code>aj[tp[a]]
tp[aj[a]]</code></pre>
<p>return <code>co[a]</code> where <code>co</code> stands for
complex-conjugate.</p>
<blockquote>
<p><strong>WARNING:</strong> Since <strong>Version 5</strong> transposes
(<code>tp</code>), adjoints (<code>aj</code>), complex conjugates
(<code>co</code>), and inverses (<code>inv</code>) in a notebook
environment render as <span class="math inline">\(x^T\)</span>, <span
class="math inline">\(x^*\)</span>, <span
class="math inline">\(\bar{x}\)</span>, and <span
class="math inline">\(x^{-1}\)</span>. <code>tp</code> and
<code>aj</code> can also be input directly as <code>x^T</code> and
<code>x^*</code>. For this reason the symbol <code>T</code> is now
protected in <code>NCAlgebra</code>.</p>
</blockquote>
<p>A trace like operator, <code>tr</code>, was introduced in
<strong>v5.0.6</strong>. It is a commutative operator keeps its list of
arguments cyclicly sorted so that <code>tr[b**a]</code> evaluates to
<code>tr[a**b]</code> and that automatically distribute over sums so
that an expression like</p>
<pre><code>tr[a**b - b**a]</code></pre>
<p>always simplifies to zero. Also <code>b**a**tr[b**a]</code>
simplifies to</p>
<pre class="output"><code>tr[a**b] a**b</code></pre>
<p>because <code>tr</code> is a commutative function. See <a
href="#SetCommutativeFunction">SetCommutativeFunction</a>.</p>
<p>A more interesting example is</p>
<pre><code>expr = (a**b - b**a)^3</code></pre>
<p>for which</p>
<pre><code>NCExpand[tr[expr]]</code></pre>
<p>evaluates to</p>
<pre class="output"><code>3 tr[a^2**b^2**a**b] - 3 tr[a^2**b**a**b^2]</code></pre>
<p>Use <a href="#NCMatrixExpand">NCMatrixExpand</a> to expand
<code>tr</code> over matrices with noncommutative entries. For
example,</p>
<pre><code>NCMatrixExpand[tr[{{a,b},{c,d}}]]</code></pre>
<p>evaluates to</p>
<pre class="output"><code>tr[a] + tr[d]</code></pre>
<h2 data-number="4.4" id="BasicReplace"><span
class="header-section-number">4.4</span> Replace</h2>
<p>A key feature of symbolic computation is the ability to perform
substitutions. The Mathematica substitute commands,
e.g. <code>ReplaceAll</code> (<code>/.</code>) and
<code>ReplaceRepeated</code> (<code>//.</code>), are not reliable in
<code>NCAlgebra</code>, so you must use our <code>NC</code> versions of
these commands. For example:</p>
<pre><code>NCReplaceAll[x**a**b,a**b-&gt;c]</code></pre>
<p>results in</p>
<pre class="output"><code>x**c</code></pre>
<p>and</p>
<pre><code>NCReplaceAll[tp[b**a]+b**a,b**a-&gt;c]</code></pre>
<p>results in</p>
<pre class="output"><code>c+tp[a]**tp[b]</code></pre>
<p>Use <a href="#NCMakeRuleSymmetric">NCMakeRuleSymmetric</a> and <a
href="#NCMakeRuleSelfAdjoint">NCMakeRuleSelfAdjoint</a> to automatically
create symmetric and self adjoint versions of your rules:</p>
<pre><code>NCReplaceAll[tp[b**a]+b**a, NCMakeRuleSymmetric[b**a -&gt; c]]</code></pre>
<p>returns</p>
<pre class="output"><code>c + tp[c]</code></pre>
<blockquote>
<p><strong>WARNING:</strong> The change in internal representation
introduced in <strong>Version 6</strong>, in which repeated letters in
monomials are represented as powers, presents a new challenge to pattern
matching for <code>NCAlgebra</code> expressions. For example, the
seemingly innocent substitution</p>
<pre><code>NCReplaceAll[a**b**b, a**b -&gt; c, ApplyPowerRule -&gt; False]</code></pre>
<p>which in previous versions returned <code>c**b</code> will fail in
<strong>Version 6</strong>. The reason for the failure is that
<code>a**b**b</code> is now internally represented as
<code>a**Power[b, 2]</code>, which does not match <code>a**b</code>. In
order to make rules with exponents work in <strong>Version 6</strong>,
they to be first modified by the new command <a
href="#NCReplacePowerRule">NCReplacePowerRule</a> as in</p>
<pre><code>NCReplaceAll[a**b**b, NCReplacePowerRule[a**b -&gt; c], ApplyPowerRule -&gt; False]</code></pre>
<p>For convenience, when the option <code>ApplyPowerRule</code> is set
to <code>True</code>, <code>NCReplacePowerRule</code> gets automatically
applied by all <code>NCReplace</code> family of functions. In this
way,</p>
<pre><code>NCReplaceAll[a**b**b, a**b -&gt; c]
NCReplaceAll[a**b**b, a**b -&gt; c, ApplyPowerRule -&gt; True]
NCReplaceAll[a**b**b, NCReplacePowerRule[a**b -&gt; c], ApplyPowerRule -&gt; False]</code></pre>
<p>all return the more familiar result</p>
<pre class="output"><code>c**b</code></pre>
<p>in <strong>Version 6</strong>.</p>
</blockquote>
<blockquote>
<p><strong>WARNING:</strong> <a
href="#NCReplacePowerRule">NCReplacePowerRule</a> and the option
<code>ApplyPowerRule</code> may not work with the most exoteric
replacements. See, for example, the note in section <a
href="#BasicInverses">Inverses</a>.</p>
</blockquote>
<p>The difference between <code>NCReplaceAll</code> and
<code>NCReplaceRepeated</code> can be understood in the example:</p>
<pre><code>NCReplaceAll[a**b^2, a**b -&gt; a]</code></pre>
<p>that results in</p>
<pre class="output"><code>a**b</code></pre>
<p>and</p>
<pre><code>NCReplaceRepeated[a**b^2, a**b -&gt; a]</code></pre>
<p>that results in</p>
<pre class="output"><code>a</code></pre>
<p>Beside <code>NCReplaceAll</code> and <code>NCReplaceRepeated</code>
we offer <code>NCReplace</code> and <code>NCReplaceList</code>, which
are analogous to the standard <code>ReplaceAll</code> (<code>/.</code>),
<code>ReplaceRepeated</code> (<code>//.</code>), <code>Replace</code>
and <code>ReplaceList</code>. Note that one rarely uses
<code>NCReplace</code> and <code>NCReplaceList</code>.</p>
<p>With <strong>Version 6</strong> we introduced <a
href="#NCExpandReplaceRepeated"><code>NCExpandReplaceRepeated</code></a>,
<a
href="#NCExpandReplaceRepeatedSymmetric"><code>NCExpandReplaceRepeatedSymmetric</code></a>,
and <a
href="#NCExpandReplaceRepeatedSelfAdjoint"><code>NCExpandReplaceRepeatedSelfAdjoint</code></a>,
which automate the tedious process of successive substitutions and
expansions that may be required to fully simplify expressions. For
example, consider the expression</p>
<pre><code>expr = a**b^2-b^2**a</code></pre>
<p>and the rule</p>
<pre><code>rule = a**b -&gt; a - b</code></pre>
<p>for which</p>
<pre><code>NCReplaceRepeated[expr, rule]</code></pre>
<p>results in the expression</p>
<pre class="output"><code>(a - b)**b - b^2**a</code></pre>
<p>Note the presence of <em>parenthesized</em> terms resulting from the
rule substitution. It is clear that after expanding</p>
<pre><code>NCExpand[NCReplaceRepeated[expr, rule]]</code></pre>
<p>to produce</p>
<pre class="output"><code>a**b - b^2 - b^2**a</code></pre>
<p>there are still terms that could be affected by the original
replacement rule, that, if replaced again,</p>
<pre><code>NCExpand[NCReplaceRepeated[expr, rule]]
NCExpand[NCReplaceRepeated[%, rule]]</code></pre>
<p>would ultimately lead to a simpler expression</p>
<pre class="output"><code>a - b - b^2 - b^2**a</code></pre>
<p>This successive expansion and substitution process is automated
in</p>
<pre><code>NCExpandReplaceRepeated[expr, rule]</code></pre>
<p>which produces the final expression</p>
<pre class="output"><code>a - b - b^2 - b^2**a</code></pre>
<p>in one shot.</p>
<p>See also the Sections <a href="#PolynomialsAndRules">Polynomials and
Rules</a> and <a href="#AdvancedReplace">Advanced Rules and
Replacement</a> for a deeper discussion on some issues involved with
rules and replacements in <code>NCAlgebra</code>.</p>
<blockquote>
<p><strong>WARNING:</strong> The commands <code>Substitute</code> and
<code>Transform</code> have been deprecated in <strong>Version
5</strong> in favor of the above nc versions of
<code>Replace</code>.</p>
</blockquote>
<h2 data-number="4.5" id="polynomials"><span
class="header-section-number">4.5</span> Polynomials</h2>
<p>The command <code>NCExpand</code> expands noncommutative products.
For example:</p>
<pre><code>NCExpand[(a+b)**x]</code></pre>
<p>returns</p>
<pre class="output"><code>a**x+b**x</code></pre>
<p>Conversely, one can collect noncommutative terms involving same
powers of a symbol using <code>NCCollect</code>. For example:</p>
<pre><code>NCCollect[a**x+b**x,x]</code></pre>
<p>recovers</p>
<pre class="output"><code>(a+b)**x</code></pre>
<p><code>NCCollect</code> groups terms by degree before collecting and
accepts more than one variable. For example:</p>
<pre><code>expr = a**x+b**x+y**c+y**d+a**x**y+b**x**y
NCCollect[expr, {x}]</code></pre>
<p>returns</p>
<pre class="output"><code>y**c+y**d+(a+b)**x**(1+y)</code></pre>
<p>and</p>
<pre><code>NCCollect[expr, {x, y}]</code></pre>
<p>returns</p>
<pre class="output"><code>(a+b)**x+y**(c+d)+(a+b)**x**y</code></pre>
<p>Note that the last term has degree 2 in <code>x</code> and
<code>y</code> and therefore does not get collected with the first order
terms.</p>
<p>The list of variables accepts <code>tp</code>, <code>aj</code> and
<code>inv</code>, and</p>
<pre><code>NCCollect[tp[x]**a**x+tp[x]**b**x+z,{x,tp[x]}]</code></pre>
<p>returns</p>
<pre class="output"><code>z+tp[x]**(a+b)**x</code></pre>
<p>Alternatively one could use</p>
<pre><code>NCCollectSymmetric[tp[x]**a**x+tp[x]**b**x+z,{x}]</code></pre>
<p>to obtain the same result. A similar command, <a
href="#NCCollectSelfAdjoint">NCCollectSelfAdjoint</a>, works with
self-adjoint variables.</p>
<p>There is also a stronger version of collect called
<code>NCStrongCollect</code>. <code>NCStrongCollect</code> does not
group terms by degree. For instance:</p>
<pre><code>NCStrongCollect[expr, {x, y}]</code></pre>
<p>produces</p>
<pre class="output"><code>y**(c+d)+(a+b)**x**(1+y)</code></pre>
<p>Keep in mind that <code>NCStrongCollect</code> often collects
<em>more</em> than one would normally expect.</p>
<blockquote>
<p><strong>WARNING:</strong> In <strong>Version 6</strong> the commands
<a href="#NCExpandExponents">NCExpandExponents</a> and <a
href="#NCCollectExponents">NCCollectExponents</a> expands and collects
exponents of expressions in noncommutative monomials. For example</p>
<pre><code>NCExpandExponents[a**(b**a)^2**b]</code></pre>
<p>produces</p>
<pre class="output"><code>a**b**a**b**a**b</code></pre>
<p>and</p>
<pre><code>NCCollectExponents[a**b**a**b**a**b]</code></pre>
<p>produces</p>
<pre class="output"><code>(a**b)^3</code></pre>
</blockquote>
<p><code>NCAlgebra</code> provides some commands for noncommutative
polynomial manipulation that are similar to the native Mathematica
(commutative) polynomial commands. Some of the next commands required
the loading of the package</p>
<pre><code>&lt;&lt; NCPolyInterface`</code></pre>
<p>which provides an interface between <code>NCAlgebra</code> and the
low-level package <a href="#PackageNCPoly">NCPoly</a>.</p>
<p>For example:</p>
<pre><code>SetCommutative[A, B]
expr = B + A y**x**y - 2 x
vars = NCVariables[expr]</code></pre>
<p>returns</p>
<pre class="output"><code>{x,y}</code></pre>
<p>and</p>
<pre><code>NCCoefficientList[expr, vars]
NCMonomialList[expr, vars]
NCCoefficientRules[expr, vars]</code></pre>
<p>returns</p>
<pre class="output"><code>{B, -2, A}
{1, x, y**x**y}
{1 -&gt; B, x -&gt; -2, y**x**y -&gt; A}</code></pre>
<p>Also for testing</p>
<pre><code>NCMonomialQ[expr]</code></pre>
<p>will return <code>False</code> and</p>
<pre><code>NCPolynomialQ[expr]</code></pre>
<p>will return <code>True</code>.</p>
<p>Another useful command is <code>NCTermsOfDegree</code>, which will
returns an expression with terms of a certain degree. For instance:</p>
<pre><code>NCTermsOfDegree[x**y**x - x^2**y + x**w + z**w, {x,y}, {2,1}]</code></pre>
<p>returns <code>x**y**x - x^2**y</code>,</p>
<pre><code>NCTermsOfDegree[x**y**x - x^2**y + x**w + z**w, {x,y}, {0,0}]</code></pre>
<p>returns <code>z**w</code>, and</p>
<pre><code>NCTermsOfDegree[x**y**x - x^2**y + x**w + z**w, {x,y}, {0,1}]</code></pre>
<p>returns <code>0</code>.</p>
<p>A similar command is <code>NCTermsOfTotalDegree</code>, which works
just like <code>NCTermsOfDegree</code> but considers the total degree in
all variables. For example:</p>
<p>For example,</p>
<pre><code>NCTermsOfTotalDegree[x**y**x - x^2**y + x**w + z**w, {x,y}, 3]</code></pre>
<p>returns <code>x**y**x - x^2**y</code>, and</p>
<pre><code>NCTermsOfTotalDegree[x**y**x - x^2**y + x**w + z**w, {x,y}, 2]</code></pre>
<p>returns <code>0</code>.</p>
<p>The above commands are based on special packages for efficiently
storing and calculating with nc polynomials. Those packages are</p>
<ul>
<li><a href="#PackageNCPolynomial"><code>NCPolynomial</code></a>: which
handles polynomials with noncommutative coefficients, and</li>
<li><a href="#PackageNCPoly"><code>NCPoly</code></a>: which handles
polynomials with real coefficients.</li>
</ul>
<p>For example:</p>
<pre><code>1 + y**x**y - A x</code></pre>
<p>is a polynomial with commutative coefficients in <span
class="math inline">\(x\)</span> and <span
class="math inline">\(y\)</span>, whereas</p>
<pre><code>a**y**b**x**c**y - A x**d</code></pre>
<p>is a polynomial with nc coefficients in <span
class="math inline">\(x\)</span> and <span
class="math inline">\(y\)</span>, where the letters <span
class="math inline">\(a\)</span>, <span
class="math inline">\(b\)</span>, <span
class="math inline">\(c\)</span>, and <span
class="math inline">\(d\)</span>, are the <em>nc coefficients</em>. Of
course</p>
<pre><code>1 + y**x**y - A x</code></pre>
<p>is a polynomial with nc coefficients if one considers only <span
class="math inline">\(x\)</span> as the variable of interest.</p>
<p>In order to take full advantage of <a
href="#PackageNCPoly"><code>NCPoly</code></a> and <a
href="#PackageNCPolynomial"><code>NCPolynomial</code></a> one would need
to <em>convert</em> an expression into those special formats. See <a
href="#PackageNCPolyInterface">NCPolyInterface</a>, <a
href="#PackageNCPoly">NCPoly</a>, and <a
href="#PackageNCPolynomial">NCPolynomial</a> for details.</p>
<h2 data-number="4.6" id="rationals-and-simplification"><span
class="header-section-number">4.6</span> Rationals and
Simplification</h2>
<p>One of the great challenges of noncommutative symbolic algebra is the
simplification of rational nc expressions. <code>NCAlgebra</code>
provides various algorithms that can be used for simplification and
general manipulation of nc rationals.</p>
<p>One such function is <code>NCSimplifyRational</code>, which attempts
to simplify noncommutative rationals using a predefined set of rules.
For example:</p>
<pre><code>expr = 1+inv[d]**c**inv[S-a]**b-inv[d]**c**inv[S-a+b**inv[d]**c]**b \
       -inv[d]**c**inv[S-a+b**inv[d]**c]**b**inv[d]**c**inv[S-a]**b
NCSimplifyRational[expr]</code></pre>
<p>leads to <code>1</code>. Of course the great challenge here is to
reveal well known identities that can lead to simplification. For
example, the two expressions:</p>
<pre><code>expr1 = a**inv[1+b**a]
expr2 = inv[1+a**b]**a</code></pre>
<p>and one can use <code>NCSimplifyRational</code> to test such
equivalence by evaluating</p>
<pre><code>NCSimplifyRational[expr1 - expr2]</code></pre>
<p>which results in <code>0</code> or</p>
<pre><code>NCSimplifyRational[expr1**inv[expr2]]</code></pre>
<p>which results in <code>1</code>. <code>NCSimplifyRational</code>
works by transforming nc rationals. For example, one can verify that</p>
<pre><code>NCSimplifyRational[expr2] == expr1</code></pre>
<p><code>NCAlgebra</code> has a number of packages that can be used to
manipulate rational nc expressions. The packages:</p>
<ul>
<li><a href="#PackageNCGBX"><code>NCGBX</code></a> perform calculations
with nc rationals using Gröbner basis, and</li>
<li><a href="#PackageNCRational"><code>NCRational</code></a> creates
state-space representations of nc rationals. This package is still
experimental.</li>
</ul>
<h2 data-number="4.7" id="calculus"><span
class="header-section-number">4.7</span> Calculus</h2>
<p>The package <a href="#PackageNCDiff"><code>NCDiff</code></a> provide
functions for calculating derivatives and integrals of nc polynomials
and nc rationals.</p>
<pre><code>&lt;&lt; NCDiff`</code></pre>
<p>The main command is <a
href="#NCDirectionalD"><code>NCDirectionalD</code></a> which calculates
directional derivatives in one or many variables. For example, if:</p>
<pre><code>expr = a**inv[1+x]**b + x**c**x</code></pre>
<p>then</p>
<pre><code>NCDirectionalD[expr, {x,h}]</code></pre>
<p>returns</p>
<pre class="output"><code>h**c**x + x**c**h - a**inv[1+x]**h**inv[1+x]**b</code></pre>
<p>In the case of more than one variables
<code>NCDirectionalD[expr, {x,h}, {y,k}]</code> takes the directional
derivative of <code>expr</code> with respect to <code>x</code> in the
direction <code>h</code> and with respect to <code>y</code> in the
direction <code>k</code>. For example, if:</p>
<pre><code>expr = x**q**x - y**x</code></pre>
<p>then</p>
<pre><code>NCDirectionalD[expr, {x,h}, {y,k}]</code></pre>
<p>returns</p>
<pre class="output"><code>h**q**x + x**q*h - y**h - k**x</code></pre>
<p>A further example, if:</p>
<pre><code>expr = x**a**x**b + x**c**x**d</code></pre>
<p>then its directional derivative in the direction <code>h</code>
is</p>
<pre><code>NCDirectionalD[expr, {x,h}]</code></pre>
<p>which returns</p>
<pre class="output"><code>h**a**x**b + x**a**h**b + h**c**x**d + x**c**h**d</code></pre>
<p>The command <code>NCGrad</code> calculates nc <em>gradients</em><a
href="#fn1" class="footnote-ref" id="fnref1"
role="doc-noteref"><sup>1</sup></a>.</p>
<p>For example:</p>
<pre><code>NCGrad[expr, x]</code></pre>
<p>returns the nc gradient</p>
<pre class="output"><code>a**x**b + b**x**a + c**x**d + d**x**c</code></pre>
<p>A further example, if:</p>
<pre><code>expr = x**a**x**b + x**c**y**d</code></pre>
<p>is a function on variables <code>x</code> and <code>y</code> then</p>
<pre><code>NCGrad[expr, x, y]</code></pre>
<p>returns the nc gradient list</p>
<pre class="output"><code>{a**x**b + b**x**a + c**y**d, d**x**c}</code></pre>
<p><strong>Version 5</strong> introduced experimental support for
integration of nc polynomials. See <a
href="#NCIntegrate"><code>NCIntegrate</code></a>.</p>
<h2 data-number="4.8" id="BasicMatrices"><span
class="header-section-number">4.8</span> Matrices</h2>
<p><code>NCAlgebra</code> has many commands for manipulating matrices
with noncommutative entries. Think block-matrices. Matrices are
represented in Mathematica using <em>lists of lists</em>. For
example</p>
<pre><code>m = {{a, b}, {c, d}}</code></pre>
<p>is a representation for the matrix</p>
<p><span class="math display">\[\left[\begin{array}{cc}
a &amp; b \\
c &amp; d
\end{array}\right]\]</span></p>
<p>The Mathematica command <code>MatrixForm</code> output pretty
matrices. <code>MatrixForm[m]</code> prints <code>m</code> in a form
similar to the above matrix. Beware when copying and pasting parts of an
expression rendered by<code>MatrixForm</code> because it may not execute
correctly. If in doubt, use <code>FullForm</code> to reveal the contents
of the expression.</p>
<p>The experienced matrix analyst should always remember that the
Mathematica convention for handling vectors is tricky.</p>
<ul>
<li><code>{{1, 2, 4}}</code> is a 1x3 <em>matrix</em> or a <em>row
vector</em>;</li>
<li><code>{{1}, {2}, {4}}</code> is a 3x1 <em>matrix</em> or a
<em>column vector</em>;</li>
<li><code>{1, 2, 4}</code> is a <em>vector</em> but <strong>not</strong>
a <em>matrix</em>. Indeed whether it is a row or column vector depends
on the context. We advise not to use <em>vectors</em>.</li>
</ul>
<h3 data-number="4.8.1" id="BasicMatrices:Inverses"><span
class="header-section-number">4.8.1</span> Inverses, Products, Adjoints,
etc</h3>
<p>A useful command is <a href="#NCInverse"><code>NCInverse</code></a>,
which is akin to Mathematica’s <code>Inverse</code> command and produces
a block-matrix inverse formula<a href="#fn2" class="footnote-ref"
id="fnref2" role="doc-noteref"><sup>2</sup></a> for an nc matrix. For
example</p>
<pre><code>NCInverse[m]</code></pre>
<p>returns</p>
<pre class="output"><code>{{inv[a]**(1 + b**inv[d - c**inv[a]**b]**c**inv[a]), -inv[a]**b**inv[d - c**inv[a]**b]}, 
{-inv[d - c**inv[a]**b]**c**inv[a], inv[d - c**inv[a]**b]}}</code></pre>
<p>or, using <code>MatrixForm</code>,</p>
<pre><code>NCInverse[m] // MatrixForm</code></pre>
<p>returns</p>
<p><span class="math display">\[\begin{bmatrix}
a^{-1} (1 + b (d - c a^{-1} b)^{-1} c a^{-1}) &amp; -a^{-1} b (d - c
a^{-1} b)^{-1} \\
-(d - c a^{-1} b)^{-1} c a^{-1} &amp; (d - c a^{-1} b)^{-1}
\end{bmatrix}\]</span></p>
<p>Note that <code>a</code> and <code>d - c**inv[a]**b</code> were
assumed invertible during the calculation.</p>
<p>Similarly, one can multiply matrices using <a
href="#NCDot"><code>NCDot</code></a>, which is similar to Mathematica’s
<code>Dot</code>. For example</p>
<pre><code>m1 = {{a, b}, {c, d}}
m2 = {{d, 2}, {e, 3}}
NCDot[m1, m2]</code></pre>
<p>result in</p>
<pre class="output"><code>{{a**d + b**e, 2 a + 3 b}, {c**d + d**e, 2 c + 3 d}}</code></pre>
<p>Note that products of nc symbols appearing in the matrices are
multiplied using <code>**</code>. Compare that with the standard
<code>Dot</code> (<code>.</code>) operator.</p>
<blockquote>
<p><strong>WARNING:</strong> <code>NCDot</code> replaces
<code>MatMult</code>, which is still available for backward
compatibility but will be deprecated in future releases.</p>
</blockquote>
<p>There are many new improvements with <strong>Version 5</strong>. For
instance, operators <code>tp</code>, <code>aj</code>, and
<code>co</code> now operate directly over matrices. That is</p>
<pre><code>aj[{{a,tp[b]},{co[c],aj[d]}}]</code></pre>
<p>returns</p>
<pre class="output"><code>{{aj[a],tp[c]},{co[b],d}}</code></pre>
<p>In previous versions one had to use the special commands
<code>tpMat</code>, <code>ajMat</code>, and <code>coMat</code>. Those
are still supported for backward compatibility.</p>
<p>See <a href="#AdvancedMatrices">advanced matrix commands</a> for
other useful matrix manipulation routines, such as <a
href="#NCMatrixExpand"><code>NCMatrixExpand</code></a>, <a
href="#NCMatrixReplaceAll"><code>NCMatrixReplaceAll</code></a>, <a
href="#NCMatrixReplaceRepeated"><code>NCMatrixReplaceRepeated</code></a>,
etc, that allow one to work with matrices with symbolic noncommutative
entries.</p>
<h3 data-number="4.8.2" id="BasicMatrices:LUDecomposition"><span
class="header-section-number">4.8.2</span> LU Decomposition</h3>
<p>Behind <code>NCInverse</code> there are a host of linear algebra
algorithms which are available in the package:</p>
<ul>
<li><a
href="#PackageNCMatrixDecompositions"><code>NCMatrixDecompositions</code></a>:
implements versions of the <span class="math inline">\(LU\)</span>
Decomposition with partial and complete pivoting, as well as <span
class="math inline">\(LDL\)</span> Decomposition which are suitable for
calculations with nc matrices. Those functions are based on the
templated algorithms from the package <a
href="#PackageMatrixDecompositions"><code>MatrixDecompositions</code></a>.</li>
</ul>
<p>For instance the function <a
href="#NCLUDecompositionWithPartialPivoting"><code>NCLUDecompositionWithPartialPivoting</code></a>
can be used as</p>
<pre><code>m = {{a, b}, {c, d}}
{lu, p} = NCLUDecompositionWithPartialPivoting[m]</code></pre>
<p>which returns</p>
<pre class="output"><code>lu = {{a, b}, {c**inv[a], d - c**inv[a]**b}}
p = {1, 2}</code></pre>
<p>Using <code>MatrixForm</code>:</p>
<pre><code>MatrixForm[lu]</code></pre>
<p>results in</p>
<p><span class="math display">\[\begin{bmatrix}
a &amp; b \\
c a^{-1} &amp; d - c a^{-1} b
\end{bmatrix}\]</span></p>
<p>The list <code>p</code> encodes the sequence of permutations
calculated during the execution of the algorithm. The matrix
<code>lu</code> contains the factors <span
class="math inline">\(L\)</span> and <span
class="math inline">\(U\)</span> in the way most common to numerical
analysts. These factors can be recovered using</p>
<pre><code>{ll, uu} = GetFullLUMatrices[lu]</code></pre>
<p>resulting in this case in</p>
<pre class="output"><code>ll = {{1, 0}, {c**inv[a], 1}}
uu = {{a, b}, {0, d - c**inv[a]**b}}</code></pre>
<p>Using <code>MatrixForm</code>:</p>
<pre><code>MatrixForm[ll]
MatrixForm[uu]</code></pre>
<p>results in</p>
<p><span class="math display">\[L = \begin{bmatrix}
1 &amp; 0 \\
c a^{-1} &amp; 1
\end{bmatrix}, \qquad
U = \begin{bmatrix}
a &amp; b \\
0 &amp; d - c a^{-1} b
\end{bmatrix}\]</span></p>
<p>To verify that <span class="math inline">\(M = L U\)</span>,
input</p>
<pre><code>m - NCDot[ll, uu]</code></pre>
<p>which should return a zero matrix.</p>
<p><strong>Note:</strong> if you are looking for efficiency, the
function <a href="#GetLUMatrices"><code>GetLUMatrices</code></a> (also
<a href="#GetLDUMatrices"><code>GetLDUMatrices</code></a>) returns the
factors <code>l</code> and <code>u</code> as
<code>SparseArrays</code>.</p>
<p>The default pivoting strategy prioritizes pivoting on simpler
expressions. For instance,</p>
<pre><code>m = {{a, b}, {1, d}}
{lu, p} = NCLUDecompositionWithPartialPivoting[m]
{ll, uu} = GetFullLUMatrices[lu]</code></pre>
<p>result in the factors</p>
<pre class="output"><code>ll = {{1, 0}, {a, 1}}
uu = {{1, d}, {0, b - a**d}}</code></pre>
<p>and a permutation list</p>
<pre class="output"><code>p = {2, 1}</code></pre>
<p>which indicates that the number <code>1</code>, appearing in the
second row, was used as the pivot rather than the symbol <code>a</code>
appearing on the first row. Because of the permutation, to verify that
<span class="math inline">\(P M = L U\)</span>, input</p>
<pre><code>m[[p]] - NCDot[ll, uu]</code></pre>
<p>which should return a zero matrix. Note that in the above example the
permutation matrix <span class="math inline">\(P\)</span> is never
constructed. Instead, the rows of <span class="math inline">\(M\)</span>
are directly permuted using Mathematica’s <code>Part</code>
(<code>[[]]</code>) command. Of course, if one prefers to work with
permutation matrices, they can be easily obtained by permuting the rows
of the identity matrix as in the following example</p>
<pre><code>p = {2, 1, 3}
IdentityMatrix[3][[p]] // MatrixForm</code></pre>
<p>to produce</p>
<p><span class="math display">\[\begin{bmatrix}
0 &amp; 1 &amp; 0 \\
1 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 1
\end{bmatrix}\]</span></p>
<p>Likewise</p>
<pre><code>m = {{a + b, b}, {c, d}}
{lu, p} = NCLUDecompositionWithPartialPivoting[m]
{ll, uu} = GetFullLUMatrices[lu]</code></pre>
<p>returns</p>
<pre class="output"><code>p = {2, 1}
ll = {{1, 0}, {(a + b)**inv[c], 1}} 
uu = {{c, d}, {0, b - (a + b)**inv[c]**d}}</code></pre>
<p>showing that the <em>simpler</em> expression <code>c</code> was taken
as a pivot instead of <code>a + b</code>.</p>
<p>The function <code>NCLUDecompositionWithPartialPivoting</code> is the
one that is used by <code>NCInverse</code>.</p>
<h3 data-number="4.8.3"
id="BasicMatrices:LUDecompositionWithCompletePivoting"><span
class="header-section-number">4.8.3</span> LU Decomposition with
Complete Pivoting</h3>
<p>Another factorization algorithm is <a
href="#NCLUDecompositionWithCompletePivoting"><code>NCLUDecompositionWithCompletePivoting</code></a>,
which can be used to calculate the symbolic rank of nc matrices. For
example</p>
<pre><code>m = {{2 a, 2 b}, {a, b}}
{lu, p, q, rank} = NCLUDecompositionWithCompletePivoting[m]</code></pre>
<p>returns the <em>left</em> and <em>right</em> permutation lists</p>
<pre class="output"><code>p = {2, 1}
q = {1, 2}</code></pre>
<p>and <code>rank</code> equal to <code>1</code>. Note that
<code>p = {2, 1}</code> and <code>q = {1,2}</code> tell us that the
element that was pivoted on was the symbol <code>a</code>, which is the
first entry of the second row, rather then <code>2 a</code>, which is
the first entry of the first row, because <code>a</code> is
<em>simpler</em> than <code>2 a</code> . The <span
class="math inline">\(L\)</span> and <span
class="math inline">\(U\)</span> factors can be obtained as before
using</p>
<pre><code>{ll, uu} = GetFullLUMatrices[lu]</code></pre>
<p>to get</p>
<pre class="output"><code>ll = {{1, 0}, {2, 1}}
uu = {{a, b}, {0, 0}}</code></pre>
<p>Using <code>MatrixForm</code>:</p>
<pre><code>MatrixForm[ll]
MatrixForm[uu]</code></pre>
<p>results in</p>
<p><span class="math display">\[L = \begin{bmatrix}
1 &amp; 0 \\
2 &amp; 1
\end{bmatrix}, \qquad
U = \begin{bmatrix}
a &amp; b \\
0 &amp; 0
\end{bmatrix}\]</span></p>
<p>In this case, to verify that <span class="math inline">\(P M Q = L
U\)</span> input</p>
<pre><code>NCDot[ll, uu] - m[[p, q]]</code></pre>
<p>which should return a zero matrix. As with partial pivoting, the
permutation matrices <span class="math inline">\(P\)</span> and <span
class="math inline">\(Q\)</span> are never constructed. Instead we used
<code>Part</code> (<code>[[]]</code>) to permute both rows and
columns.</p>
<h3 data-number="4.8.4" id="BasicMatrices:LDLDecomposition"><span
class="header-section-number">4.8.4</span> LDL Decomposition</h3>
<p>Finally <a
href="#NCLDLDecomposition"><code>NCLDLDecomposition</code></a> computes
the <span class="math inline">\(LDL^T\)</span> decomposition of
symmetric symbolic nc matrices. For example</p>
<pre><code>m = {{a, b}, {b, c}}
{ldl, p, s, rank} = NCLDLDecomposition[m]</code></pre>
<p>returns <code>ldl</code>, which contain the factors, and</p>
<pre class="output"><code>p = {1, 2}
s = {1, 1}
rank = 2</code></pre>
<p>The list <code>p</code> encodes left and right permutations,
<code>s</code> is a list specifying the size of the diagonal blocks
(entries can be either 1 or 2). The factors can be obtained using <a
href="#GetLDUMatrices"><code>GetLDUMatrices</code></a> as in</p>
<pre><code>{ll, dd, uu} = GetFullLDUMatrices[ldl, s]</code></pre>
<p>which in this case returns</p>
<pre class="output"><code>ll = {{1, 0}, {b**inv[a], 1}}
dd = {{a, 0}, {0, c - b**inv[a]**b}}
uu = {{1, inv[a]**b}, {0, 1}}}</code></pre>
<p>Because <span class="math inline">\(P M P^T = L D L^T\)</span>,</p>
<pre><code>NCDot[ll, dd, uu] - m[[p, p]]</code></pre>
<p>is the zero matrix and <span class="math inline">\(U =
L^T\)</span>.</p>
<p><code>NCLDLDecomposition</code> works only on symmetric matrices and,
whenever possible, will make invertibility and symmetry assumptions on
variables so that it can run successfully. If not possible it will warn
the users.</p>
<blockquote>
<p><strong>WARNING:</strong> Prior versions contained the command
<code>NCLDUDecomposition</code> which was deprecated in <strong>Version
5</strong> as its functionality is now provided by <a
href="#NCLDLDecomposition"><code>NCLDLDecomposition</code></a>, with a
slightly different syntax.</p>
</blockquote>
<h3 data-number="4.8.5" id="ReplaceWithMatrices"><span
class="header-section-number">4.8.5</span> Replace with Matrices</h3>
<p><a href="#NCMatrixReplaceAll"><code>NCMatrixReplaceAll</code></a> and
<a
href="#NCMatrixReplaceRepeated"><code>NCMatrixReplaceRepeated</code></a>
are special versions of <a
href="#NCReplaceAll"><code>NCReplaceAll</code></a> and <a
href="#NCReplaceRepeated"><code>NCReplaceRepeated</code></a> that take
extra steps to preserve matrix consistency when replacing expressions
with nc matrices. For example, with</p>
<pre><code>m1 = {{a, b}, {c, d}}
m2 = {{d, 2}, {e, 3}}</code></pre>
<p>and</p>
<pre><code>M = {{a11,a12}}</code></pre>
<p>the call</p>
<pre><code>MM = NCMatrixReplaceRepeated[M, {a11 -&gt; m1, a12 -&gt; m2}]</code></pre>
<p>produces as a result the matrix</p>
<pre class="output"><code>{{a, b, d, 2}, {c, d, e, 3}}</code></pre>
<p>or, using <code>MatrixForm</code>:</p>
<pre><code>MatrixForm[MM]</code></pre>
<p>to obtain</p>
<p><span class="math display">\[\begin{bmatrix}
a &amp; b &amp; d &amp; 2 \\
c &amp; d &amp; e &amp; 3
\end{bmatrix}\]</span></p>
<p>Note how the symbols were treated as block-matrices during the
substitution. As a second example, with</p>
<pre><code>M = {{a11, 0}, {0, a22}}</code></pre>
<p>the command</p>
<pre><code>MM = NCMatrixReplaceRepeated[M, {a11 -&gt; m1, a22 -&gt; m2}]</code></pre>
<p>produces the matrix</p>
<pre class="output"><code>{{a, b, 0, 0}, {c, d, 0, 0}, {0, 0, d, 2}, {0, 0, e, 3}}</code></pre>
<p>or, using <code>MatrixForm</code>:</p>
<pre><code>MatrixForm[MM]</code></pre>
<p>to obtain</p>
<p><span class="math display">\[\begin{bmatrix}
a &amp; b &amp; 0 &amp; 0 \\
c &amp; d &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; d &amp; 2 \\
0 &amp; 0 &amp; e &amp; 3
\end{bmatrix}\]</span></p>
<p>in which the <code>0</code> blocks were automatically expanded to fit
the adjacent block matrices.</p>
<p>Another feature of <code>NCMatrixReplace</code> and its variants is
its ability to withhold evaluation until all matrix substitutions have
taken place. For example,</p>
<pre><code>NCMatrixReplaceAll[x**y + y, {x -&gt; m1, y -&gt; m2}]</code></pre>
<p>produces</p>
<pre class="output"><code>{{d + a**d + b**e, 2 + 2 a + 3 b}, 
 {e + c**d + d**e, 3 + 2 c + 3 d}}</code></pre>
<p>Finally, <code>NCMatrixReplace</code> substitutes
<code>NCInverse</code> for <code>inv</code> so that, for instance, the
result of</p>
<pre><code>rule = {x -&gt; m1, y -&gt; m2, id -&gt; IdentityMatrix[2], z -&gt; {{id,x},{x,id}}}
NCMatrixReplaceRepeated[inv[z], rule]</code></pre>
<p>coincides with</p>
<pre><code>NCInverse[ArrayFlatten[{{IdentityMatrix[2], m1}, {m1, IdentityMatrix[2]}}]]</code></pre>
<h2 data-number="4.9" id="Quadratic"><span
class="header-section-number">4.9</span> Quadratic Polynomials, Second
Directional Derivatives and Convexity</h2>
<p>The closest related demo to the material in this section is
<code>NC/DEMOS/NCConvexity.nb</code>.</p>
<p>When working with nc quadratics it is useful to be able to “factor”
the quadratic into the following form</p>
<p><span class="math display">\[
    q(x) = c + s(x) + l(x) M r(x)
\]</span></p>
<p>where <span class="math inline">\(s\)</span> is linear <span
class="math inline">\(x\)</span> and <span
class="math inline">\(l\)</span> and <span
class="math inline">\(r\)</span> are vectors and <span
class="math inline">\(M\)</span> is a matrix. Load the package</p>
<pre><code>&lt;&lt; NCQuadratic`</code></pre>
<p>and use the command <a
href="#NCToNCQuadratic"><code>NCToNCQuadratic</code></a> to factor an nc
polynomial into the the above form:</p>
<pre><code>vars = {x, y};
expr = tp[x]**a**x**d + tp[x]**b**y + tp[y]**c**y + tp[y]**tp[b]**x**d;
{const, lin, left, middle, right} = NCToNCQuadratic[expr, vars];</code></pre>
<p>which returns</p>
<pre class="output"><code>left = {tp[x],tp[y]}
right = {y, x**d}
middle = {{a,b}, {tp[b],c}}</code></pre>
<p>and zero <code>const</code> and <code>lin</code>. The format for the
linear part <code>lin</code> will be discussed later in Section <a
href="#Linear">Linear</a>. Note that coefficients of an nc quadratic may
also appear on the left and right vectors, as <code>d</code> did in the
above example. Conversely, <a
href="#NCQuadraticToNC"><code>NCQuadraticToNC</code></a> converts a list
with factors back to an nc expression as in:</p>
<pre><code>NCQuadraticToNC[{const, lin, left, middle, right}]</code></pre>
<p>which results in</p>
<pre class="output"><code>(tp[x]**b + tp[y]**c)**y + (tp[x]**a + tp[y]**tp[b])**x**d</code></pre>
<p>An interesting application is the verification of the domain in which
an nc rational function is <em>convex</em>. This uses the second
directional derivative, called the Hessian. Take for example the
quartic</p>
<pre><code>expr = x^4;</code></pre>
<p>and calculate its noncommutative directional <em>Hessian</em></p>
<pre><code>hes = NCHessian[expr, {x, h}]</code></pre>
<p>This command returns</p>
<pre class="output"><code>2 h^2**x^2 + 2 h**x**h**x + 2 h**x^2**h + 2 x**h^2**x + 2 x**h**x**h + 2 x^2**h^2</code></pre>
<p>which is quadratic in the direction <code>h</code>. The decomposition
of the nc Hessian using <code>NCToNCQuadratic</code></p>
<pre><code>{const, lin, left, middle, right} = NCToNCQuadratic[hes, {h}];</code></pre>
<p>produces</p>
<pre class="output"><code>left = {h, x**h, x^2**h}
right = {h**x^2, h**x, h}
middle = {{2, 2 x, 2 x^2},{0, 2, 2 x},{0, 0, 2}}</code></pre>
<p>Note that the middle matrix</p>
<p><span class="math display">\[\begin{bmatrix}
2 &amp; 2 x &amp; 2 x^2 \\
0 &amp; 2 &amp; 2 x \\
0 &amp; 0 &amp; 2
\end{bmatrix}\]</span></p>
<p>is not <em>symmetric</em>, as one might have expected. The command <a
href="#NCQuadraticMakeSymmetric"><code>NCQuadraticMakeSymmetric</code></a>
can fix that and produce a symmetric decomposition. For the above
example</p>
<pre><code>{const, lin, sleft, smiddle, sright} = 
  NCQuadraticMakeSymmetric[{const, lin, left, middle, right}, 
                           SymmetricVariables -&gt; {x, h}]</code></pre>
<p>results in</p>
<pre class="output"><code>sleft = {x^2**h, x**h, h}
sright = {h**x^2, h**x, h}
middle = {{0, 0, 2}, {0, 2, 2 x}, {2, 2 x, 2 x^2}}</code></pre>
<p>in which <code>middle</code> is the symmetric matrix</p>
<p><span class="math display">\[\begin{bmatrix}
0 &amp; 0 &amp; 2 \\
0 &amp; 2 &amp; 2 x \\
2 &amp; 2 x &amp; 2 x^2
\end{bmatrix}\]</span></p>
<p>Note the argument <code>SymmetricVariables -&gt; {x,h}</code> which
tells <code>NCQuadraticMakeSymmetric</code> to consider <code>x</code>
and <code>y</code> as symmetric variables. Because the
<code>middle</code> matrix is never positive semidefinite for any
possible value of <span class="math inline">\(x\)</span> the
conclusion<a href="#fn3" class="footnote-ref" id="fnref3"
role="doc-noteref"><sup>3</sup></a> is that the nc quartic <span
class="math inline">\(x^4\)</span> is <em>not convex</em>.</p>
<p>The production of such symmetric quadratic decompositions is
automated by the convenience command <a
href="#NCMatrixOfQuadratic"><code>NCMatrixOfQuadratic</code></a>. Verify
that</p>
<pre><code>{sleft, smiddle, sright} = NCMatrixOfQuadratic[hes, {h}]</code></pre>
<p>automatically assumes that both <code>x</code> and <code>h</code> are
symmetric variables and produces suitable left and right vectors as well
as a symmetric middle matrix. Now we illustrate the application of such
command to checking the convexity region of a noncommutative rational
function.</p>
<p>If one is interested in checking convexity of nc rationals the
package <a href="#PackageNCConvexity"><code>NCConvexity</code></a> has
functions that automate the whole process, including the calculation of
the Hessian and the middle matrix, followed by the diagonalization of
the middle matrix as produced by <a
href="#NCLDLDecomposition"><code>NCLDLDecomposition</code></a>.</p>
<p>For example, the commands evaluate the nc Hessian and calculates its
quadratic decomposition</p>
<pre><code>expr = (x + b**y)**inv[1 - a**x**a + b**y + y**b]**(x + y**b);
{left, middle, right} = NCMatrixOfQuadratic[NCHessian[expr, {x, h}], {h}];</code></pre>
<p>The resulting middle matrix can be factored using</p>
<pre><code>{ldl, p, s, rank} = NCLDLDecomposition[middle];
{ll, dd, uu} = GetLDUMatrices[ldl, s];</code></pre>
<p>which produces the diagonal factors</p>
<p><span class="math display">\[\begin{bmatrix}
  2 (1 + b y + y b - a x a)^{-1} &amp; 0 &amp; 0 \\
  0 &amp; 0 &amp; 0 \\
  0 &amp; 0 &amp; 0
\end{bmatrix}\]</span></p>
<p>which indicates the the original nc rational is convex whenever</p>
<p><span class="math display">\[
(1 + b y + y b - a x a)^{-1} \succeq 0
\]</span></p>
<p>or, equivalently, whenever</p>
<p><span class="math display">\[
1 + b y + y b - a x a \succeq 0
\]</span></p>
<p>The above sequence of calculations is automated by the command <a
href="#NCConvexityRegion"><code>NCConvexityRegion</code></a> as in</p>
<pre><code>&lt;&lt; NCConvexity`
NCConvexityRegion[expr, {x}]</code></pre>
<p>which results in</p>
<pre class="output"><code>{2 inv[1 + b**y + y**b - a**x**a], 0}</code></pre>
<p>which correspond to the diagonal entries of the LDL decomposition of
the middle matrix of the nc Hessian.</p>
<h1 data-number="5" id="MoreAdvancedCommands"><span
class="header-section-number">5</span> More Advanced Commands</h1>
<p>In this chapter we describe some more advance features and
commands.</p>
<p>If you want a living version of this chapter just run the notebook
<code>NC/DEMOS/2_MoreAdvancedCommands.nb</code>.</p>
<pre><code>&lt;&lt; NC`
&lt;&lt; NCAlgebra`</code></pre>
<h2 data-number="5.1" id="AdvancedReplace"><span
class="header-section-number">5.1</span> Advanced Rules and
Replacements</h2>
<p>Substitution is a key feature of Symbolic computation. We will now
discuss some issues related to Mathematica’s implementation of rules and
replacements that can affect the behavior of <code>NCAlgebra</code>
expressions.</p>
<h3 data-number="5.1.1"
id="replaceall-.-and-replacerepeated-.-often-fail"><span
class="header-section-number">5.1.1</span> <code>ReplaceAll</code>
(<code>/.</code>) and <code>ReplaceRepeated</code> (<code>//.</code>)
often fail</h3>
<p>The first issue is related to how Mathematica performs substitutions,
which is through <a
href="http://reference.wolfram.com/language/guide/RulesAndPatterns.html">pattern
matching</a>. For a rule to be effective if has to match the
<em>structural</em> representation of an expression. That representation
might be different than one would normally think based on the usual
properties of mathematical operators. For example, one would expect the
rule:</p>
<pre class="output"><code>rule = 1 + x_ -&gt; x</code></pre>
<p>to match all the expressions bellow:</p>
<pre class="output"><code>1 + a
1 + 2 a
1 + a + b
1 + 2 a * b</code></pre>
<p>so that</p>
<pre class="output"><code>expr /. rule</code></pre>
<p>with <code>expr</code> taking the above expressions would result
in:</p>
<pre class="output"><code>a
2 a
a + b
2 a * b</code></pre>
<p>Indeed, Mathematica’s attribute <code>Flat</code> does precisely
that. Note that this is still <em>structural matching</em>, not
<em>mathematical matching</em>, since the pattern <code>1 + x_</code>
would not match an integer <code>2</code>, even though one could write
<code>2 = 1 + 1</code>!</p>
<p>Unfortunately, <code>**</code>, which is the
<code>NonCommutativeMultiply</code> operator, <em>is not</em>
<code>Flat</code><a href="#fn4" class="footnote-ref" id="fnref4"
role="doc-noteref"><sup>4</sup></a>. This is the reason why substitution
based on a simple rule such as:</p>
<pre><code>rule = a**b -&gt; c</code></pre>
<p>so that</p>
<pre class="output"><code>expr /. rule</code></pre>
<p>will work for some <code>expr</code> like</p>
<pre><code>1 + 2 a**b /. rule</code></pre>
<p>resulting in</p>
<pre class="output"><code>1 + 2 c</code></pre>
<p>but will fail to produce the <em>expected</em> result in cases
like:</p>
<pre><code>a**b**c /. rule</code></pre>
<p>or</p>
<pre><code>c**a**b /. rule
c**a**b**d /. rule
1 + 2 a**b**c /. rule</code></pre>
<p>That’s what the <code>NCAlgebra</code> family of replacement
functions discussed in the next section are made for.</p>
<h3 data-number="5.1.2" id="the-fix-is-ncreplace"><span
class="header-section-number">5.1.2</span> The fix is
<code>NCReplace</code></h3>
<p>Continuing with the example in the previous section, the calls</p>
<pre><code>NCReplaceAll[a**b**c, rule]
NCReplaceAll[ c**a**b, rule ]
NCReplaceAll[c**a**b**d, rule]
NCReplaceAll[1 + 2 a**b**c, rule ]</code></pre>
<p>produce the results one would expect:</p>
<pre class="output"><code>c^2
c^2
c^2**d
1 + 2 c^2</code></pre>
<p>For this reason, when substituting in <code>NCAlgebra</code> it is
always safer to use functions from the <a
href="#PackageNCReplace"><code>NCReplace</code> package</a> rather than
the corresponding Mathematica <code>Replace</code> family of functions.
Unfortunately, this comes at a the expense of sacrificing the standard
operators <code>/.</code> (<code>ReplaceAll</code>) and <code>//.</code>
(<code>ReplaceRepeated</code>), which cannot be safely overloaded,
forcing one to use the full names <code>NCReplaceAll</code> and
<code>NCReplaceRepeated</code>.</p>
<p>On the same vein, the following substitution rule</p>
<pre><code>NCReplaceAll[2 a**b + c, 2 a -&gt; b]</code></pre>
<p>will return <code>2 a**b + c</code> intact since</p>
<pre><code>FullForm[2 a**b]</code></pre>
<p>is actually</p>
<pre class="output"><code>Times[2, NonCommutativeMuliply[a, b]]</code></pre>
<p>which is not structurally related to</p>
<pre><code>FullForm[2 a]</code></pre>
<p>which is</p>
<pre class="output"><code>Times[2, a]</code></pre>
<p>Of course, in this case a simple solution is to use the alternative
rule:</p>
<pre><code>NCReplaceAll[2 a**b + c, a -&gt; b / 2]</code></pre>
<p>which results in <code>b^2 + c</code>, as one might expect.</p>
<h3 data-number="5.1.3" id="matching-monomials-with-powers"><span
class="header-section-number">5.1.3</span> Matching monomials with
powers</h3>
<p>Starting with <strong>Version 6</strong>, <code>NCAlgebra</code>
stores repeated symbols in noncommutative monomials using powers. This
means that</p>
<pre><code>expr = a**a**a**b**a**a**b**a**b
FullForm[expr]</code></pre>
<p>is internally stored as</p>
<pre class="output"><code>NonCommutativeMultiply[a^3, b, a^2, b, a, b]</code></pre>
<p>so that a replacement such as</p>
<pre><code>NCReplaceAll[expr, a**b -&gt; c, ApplyPowerRule -&gt; False]</code></pre>
<p>will result in</p>
<pre class="output"><code>a^3**b**a^2**b**c</code></pre>
<p>Note how the rule fails to match the <code>a**b</code> in the terms
<code>a**b^2</code> and <code>a**b^3</code>. This situation might be
familiar to an experienced Mathematica user who is a aware of the
difference between structural pattern matching and mathematical
matching<a href="#fn5" class="footnote-ref" id="fnref5"
role="doc-noteref"><sup>5</sup></a>.</p>
<p>As a convenience for <code>NCAlgebra</code> users, <strong>Version
6</strong> provides the function <a
href="#NCReplacePowerRule">NCReplacePowerRule</a> that modifies a user’s
rule in order to accomplish matching of symbols in
<code>NCAlgebra</code> expressions including powers. For example, for
the same <code>expr</code> above, the following replacement</p>
<pre><code>NCReplaceAll[expr, NCReplacePowerRule[a**b -&gt; c], ApplyPowerRule -&gt; False]</code></pre>
<p>will produce the more familiar</p>
<pre class="output"><code>a^2**c**a^2**b**a**b</code></pre>
<p>after matching <code>a**b</code> in the term <code>a^3**b</code>,
and</p>
<pre><code>NCReplaceRepeated[expr, NCReplacePowerRule[a**b -&gt; c], ApplyPowerRule -&gt; False]</code></pre>
<p>will produce</p>
<pre class="output"><code>a^2**c**a**c^2</code></pre>
<p>after matching <code>a**b</code> in <code>a^3**b</code>,
<code>a^2**b</code>, and <code>a**b</code>.</p>
<p>The command <code>NCReplacePowerRule</code> works by modifying
noncommutative patterns with symbols appearing at the edges of monomials
to account for the potential presence of <code>Power</code> in a
noncommutative monomial. For example,</p>
<pre><code>NCReplacePowerRule[a**c**b -&gt; d]</code></pre>
<p>produces the modified rule<a href="#fn6" class="footnote-ref"
id="fnref6" role="doc-noteref"><sup>6</sup></a></p>
<pre class="output"><code>a^n_.**c**b^m_. -&gt; a^(n-1)**d**b^(m-1)</code></pre>
<p>which can successfully match powers of the symbols <code>a</code> and
<code>b</code> appearing in the monomial <code>a**c**b</code>.</p>
<p>The application of <code>NCReplacePowerRule</code> can also be done
by invoking the option <code>ApplyPowerRule</code>, which is available
in all functions of the package <a
href="#PackageNCReplace">NCReplace</a>. Currently,
<code>ApplyPowerRule</code> is set to <code>True</code> by default so
that the commands</p>
<pre><code>NCReplaceRepeated[expr, a**b -&gt; c]
NCReplaceRepeated[expr, a**b -&gt; c, ApplyPowerRule -&gt; True]</code></pre>
<p>do the same thing as</p>
<pre><code>NCReplaceRepeated[expr, NCReplacePowerRule[a**b -&gt; c], ApplyPowerRule -&gt; False]</code></pre>
<p>This option can also be turned off globally for all calls to the
<code>NCReplace</code> family of functions in a <code>NCAlgebra</code>
session by calling</p>
<pre><code>SetOptions[NCReplace, ApplyPowerRule -&gt; False];</code></pre>
<p>After that, all calls to <code>NCReplace</code>,
<code>NCReplaceAll</code>, <code>NCReplaceRepeated</code>, and related
function, will be done with the option
<code>ApplyPowerRule -&gt; False</code> automatically.</p>
<p>To revert to the default behavior just set</p>
<pre><code>SetOptions[NCReplace, ApplyPowerRule -&gt; True];</code></pre>
<h3 data-number="5.1.4" id="trouble-with-block-and-module"><span
class="header-section-number">5.1.4</span> Trouble with
<code>Block</code> and <code>Module</code></h3>
<p>A second more esoteric issue related to substitution in
<code>NCAlgebra</code> does not have a clean solution. It is also one
that usually lurks in hidden pieces of code and can be very difficult to
spot. We have been victim of such “bugs” many times. Luckily it only
affect advanced users that are using <code>NCAlgebra</code> inside their
own functions using Mathematica’s <code>Block</code> and
<code>Module</code> constructions. It is also not a real bug, since it
follows from some often not well understood issues with the usage of <a
href="http://reference.wolfram.com/language/tutorial/BlocksComparedWithModules.html"><code>Block</code>
versus <code>Module</code></a>. Our goal here is therefore not to
<em>fix</em> the issue but simply to alert advanced users of its
existence. Start by first revisiting the following example from the <a
href="http://reference.wolfram.com/language/tutorial/BlocksComparedWithModules.html">Mathematica
documentation</a>. Let</p>
<pre><code>m = i^2</code></pre>
<p>and run</p>
<pre><code>Block[{i = a}, i + m]</code></pre>
<p>which returns the “expected”</p>
<pre class="output"><code>a + a^2</code></pre>
<p>versus</p>
<pre><code>Module[{i = a}, i + m]</code></pre>
<p>which returns the “surprising”</p>
<pre class="output"><code>a + i**i</code></pre>
<p>The reason for this behavior is that <code>Block</code> effectively
evaluates <code>i</code> as a <em>local variable</em> and evaluates
<code>m</code> using whatever values are available at the time of
evaluation, whereas <code>Module</code> only evaluates the symbol
<code>i</code> which appears <em>explicitly</em> in <code>i + m</code>
and not <code>m</code> using the local value of <code>i = a</code>. This
can lead to many surprises when using rules and substitution inside a
<code>Module</code>. For example:</p>
<pre><code>Block[{i = a}, i_ -&gt; i]</code></pre>
<p>will return</p>
<pre class="output"><code>i_ -&gt; a</code></pre>
<p>whereas</p>
<pre><code>Module[{i = a}, i_ -&gt; i]</code></pre>
<p>will return</p>
<pre class="output"><code>i_ -&gt; i</code></pre>
<p>More devastating for <code>NCAlgebra</code> is the fact that
<code>Module</code> will hide local definitions from rules, which will
often lead to disaster if local variables need to be declared
noncommutative. Consider for example the trivial definitions for
<code>F</code> and <code>G</code> below:</p>
<pre><code>F[exp_] := Module[
  {rule, aa, bb},
  SetNonCommutative[aa, bb];
  rule = aa_**bb_ -&gt; bb**aa;
  NCReplaceAll[exp, rule]
]

G[exp_] := Block[
  {rule, aa, bb},
  SetNonCommutative[aa, bb];
  rule = aa_**bb_ -&gt; bb**aa;
  NCReplaceAll[exp, rule]
]</code></pre>
<p>Their only difference is that one is defined using a
<code>Block</code> and the other is defined using a <code>Module</code>.
The task is to apply a rule that <em>flips</em> the noncommutative
product of their arguments, say, <code>x**y</code>, into
<code>y**x</code>. The problem is that only one of those definitions
work “as expected.” Indeed, verify that</p>
<pre><code>G[x**y]</code></pre>
<p>returns the “expected”</p>
<pre class="output"><code>y**x</code></pre>
<p>whereas</p>
<pre><code>F[x**y]</code></pre>
<p>returns</p>
<pre class="output"><code>x y</code></pre>
<p>which completely destroys the noncommutative product. The reason for
the catastrophic failure of the definition of <code>F</code>, which is
inside a <code>Module</code>, is that the letters <code>aa</code> and
<code>bb</code> appearing in <code>rule</code> are <em>not treated as
the local symbols <code>aa</code> and <code>bb</code></em><a href="#fn7"
class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a>.
For this reason, the right-hand side of the rule <code>rule</code>
involves the global symbols <code>aa</code> and <code>bb</code>, which
are, in the absence of a declaration to the contrary, commutative. On
the other hand, the definition of <code>G</code> inside a
<code>Block</code> makes sure that <code>aa</code> and <code>bb</code>
are evaluated with whatever value they might have locally at the time of
execution.</p>
<p>The above subtlety often manifests itself partially, sometimes
causing what might be perceived as some kind of <em>erratic
behavior</em>. Indeed, if one had used symbols that were already
declared globally noncommutative by <code>NCAlgebra</code>, such as
single small cap roman letters as in the definition:</p>
<pre><code>H[exp_] := Module[
  {rule, a, b},
  SetNonCommutative[a, b];
  rule = a_**b_ -&gt; b**a;
  NCReplaceAll[exp, rule]
]</code></pre>
<p>then calling</p>
<pre><code>H[x**y]</code></pre>
<p>works “as expected,” even if for the wrong reasons!</p>
<p>Another possible “fix” is to use a delayed rule, as in:</p>
<pre><code>H[exp_] := Module[
  {rule, aa, bb},
  SetNonCommutative[aa, bb];
  rule = aa_**bb_ :&gt; bb**aa;
  NCReplaceAll[exp, rule]
]</code></pre>
<p>with which</p>
<pre><code>H[x**y]</code></pre>
<p>would also work because the evaluation of the right-hand side of the
rule is delayed until the time of its application.</p>
<h2 data-number="5.2" id="AdvancedMatrices"><span
class="header-section-number">5.2</span> Expanding matrix products</h2>
<p>Starting at <strong>Version 5</strong> the operators <code>**</code>
and <code>inv</code> apply also to matrices. However, in order for
<code>**</code> and <code>inv</code> to continue to work as full fledged
operators, the result of multiplications or inverses of matrices is held
unevaluated until the user calls <a
href="#NCMatrixExpand"><code>NCMatrixExpand</code></a>. This is in the
the same spirit as good old fashion commutative operations in
Mathematica.</p>
<p>For example, with</p>
<pre><code>m1 = {{a, b}, {c, d}}
m2 = {{d, 2}, {e, 3}}</code></pre>
<p>the call</p>
<pre><code>m1**m2</code></pre>
<p>results in</p>
<pre class="output"><code>{{a, b}, {c, d}}**{{d, 2}, {e, 3}}</code></pre>
<p>Upon calling</p>
<pre><code>m1**m2 // NCMatrixExpand</code></pre>
<p>the matrix product evaluation takes place returning</p>
<pre class="output"><code>{{a**d + b**e, 2a + 3b}, {c**d + d**e, 2c + 3d}}</code></pre>
<p>which is what would have arisen from calling
<code>NCDot[m1,m2]</code><a href="#fn8" class="footnote-ref" id="fnref8"
role="doc-noteref"><sup>8</sup></a>. Likewise</p>
<pre><code>inv[m1]</code></pre>
<p>results in</p>
<pre class="output"><code>inv[{{a, b}, {c, d}}]</code></pre>
<p>and</p>
<pre><code>inv[m1] // NCMatrixExpand</code></pre>
<p>returns the evaluated result</p>
<pre class="output"><code>{{inv[a]**(1 + b**inv[d - c**inv[a]**b]**c**inv[a]), -inv[a]**b**inv[d - c**inv[a]**b]}, 
 {-inv[d - c**inv[a]**b]**c**inv[a], inv[d - c**inv[a]**b]}}</code></pre>
<p>or, using <code>MatrixForm</code>:</p>
<pre><code>inv[m1] // NCMatrixExpand // MatrixForm</code></pre>
<p>returns</p>
<p><span class="math display">\[\begin{bmatrix} a^{-1} (1 + b (d - c
a^{-1} b)^{-1} c a^{-1}) &amp; -a^{-1} b (d - c a^{-1} b)^{-1} \\ -(d -
c a^{-1} b)^{-1} c a^{-1} &amp; (d - c a^{-1} b)^{-1}
\end{bmatrix}\]</span></p>
<p>A less trivial example is</p>
<pre><code>m3 = m1**inv[IdentityMatrix[2] + m1] - inv[IdentityMatrix[2] + m1]**m1</code></pre>
<p>that returns</p>
<pre class="output"><code>-inv[{{1 + a, b}, {c, 1 + d}}]**{{a, b}, {c, d}} + 
     {{a, b}, {c, d}}**inv[{{1 + a, b}, {c, 1 + d}}]</code></pre>
<p>Expanding</p>
<pre><code>NCMatrixExpand[m3]</code></pre>
<p>results in</p>
<pre class="output"><code>{{b**inv[b - (1 + a)**inv[c]**(1 + d)] - inv[c]**(1 + (1 + d)**inv[b - 
    (1 + a)**inv[c]**(1 + d)]**(1 + a)**inv[c])**c - a**inv[c]**(1 + d)**inv[b - 
    (1 + a)**inv[c]**(1 + d)] + inv[c]**(1 + d)**inv[b - (1 + a)**inv[c]**(1 + d)]**a, 
  a**inv[c]**(1 + (1 + d)**inv[b - (1 + a)**inv[c]**(1 + d)]**(1 + a)**inv[c]) - 
    inv[c]**(1 + (1 + d)**inv[b - (1 + a)**inv[c]**(1 + d)]**(1 + a)**inv[c])**d - 
    b**inv[b - (1 + a)**inv[c]**(1 + d)]**(1 + a)**inv[c] + inv[c]**(1 + d)**inv[b - 
    (1 + a)**inv[c]**(1 + d)]** b}, 
 {d**inv[b - (1 + a)**inv[c]**(1 + d)] - (1 + d)**inv[b - (1 + a)**inv[c]**(1 + d)] - 
    inv[b - (1 + a)**inv[c]**(1 + d)]**a + inv[b - (1 + a)**inv[c]**(1 + d)]**(1 + a), 
  1 - inv[b - (1 + a)**inv[c]**(1 + d)]**b - d**inv[b - (1 + a)**inv[c]**(1 + d)]**(1 + 
    a)**inv[c] + (1 + d)**inv[b - (1 + a)**inv[c]**(1 + d)]**(1 + a)**inv[c] + 
    inv[b - (1 + a)**inv[c]**(1 + d)]**(1 + a)**inv[c]**d}}</code></pre>
<p>and, finally,</p>
<pre><code>NCMatrixExpand[m3] // NCSimplifyRational    </code></pre>
<p>returns</p>
<pre class="output"><code>{{0, 0}, {0, 0}}</code></pre>
<p>as expected.</p>
<h3 data-number="5.2.1" id="trouble-with-plus-and-matrices"><span
class="header-section-number">5.2.1</span> Trouble with
<code>Plus</code> (<code>+</code>) and matrices</h3>
<p>Mathematica’s choice of treating lists and matrix indistinctively can
cause much trouble when mixing <code>**</code> with <code>Plus</code>
(<code>+</code>) operator. The reason for that is that <code>Plus</code>
is <code>Listable</code>, and an expression like</p>
<pre><code>z + m1</code></pre>
<p>where <code>m1</code> is an array and <code>z</code> is not, is
automatically expanded into</p>
<pre class="output"><code>{{a + z, b + z}, {c + z, d + z}}</code></pre>
<p>or, using <code>MatrixForm</code>:</p>
<pre><code>z + m1 // MatrixForm</code></pre>
<p>resulting in</p>
<p><span class="math display">\[\begin{bmatrix} a + z &amp; b + z \\ c +
z &amp; d + z \end{bmatrix}\]</span></p>
<p>Because of this “feature”, the expression</p>
<pre><code>m1**m2 + m2 // NCMatrixExpand</code></pre>
<p>evaluates to the “wrong” result</p>
<pre class="output"><code>{{{{d + a**d + b**e, 2 a + 3 b + d}, {d + c**d + d**e, 2 c + 4 d}},
 {{2 + a**d + b**e, 2 + 2 a + 3 b}, {2 + c**d + d**e, 2 + 2 c + 3 d}}}, 
 {{{e + a**d + b**e, 2 a + 3 b + e}, {e + c**d + d**e, 2 c + 3 d + e}}, 
 {{3 + a**d + b**e, 3 + 2 a + 3 b}, {3 + c**d + d**e, 3 + 2 c + 3 d}}}}</code></pre>
<p>which is different than the “correct” result</p>
<pre class="output"><code>{{d + a**d + b**e, 2 + 2 a + 3 b}, 
 {e + c**d + d**e, 3 + 2 c + 3 d}}</code></pre>
<p>which is returned by either</p>
<pre><code>NCMatrixExpand[m1**m2] + m2</code></pre>
<p>or</p>
<pre><code>NCDot[m1, m2] + m2</code></pre>
<p>The reason for the behavior is that <code>m1**m2</code> is
essentially treated as a <em>scalar</em> (it does not have <em>head</em>
<code>List</code>) and therefore gets added entrywise to <code>m2</code>
<em>before</em> <code>NCMatrixExpand</code> has a chance to evaluate the
<code>**</code> product.</p>
<p>There are no easy fixes for this problem, which affects not only
<code>NCAlgebra</code> but any similar type of matrix product evaluation
in Mathematica. With <code>NCAlgebra</code>, a better option is to use
<a href="#NCMatrixReplaceAll"><code>NCMatrixReplaceAll</code></a> or <a
href="#NCMatrixReplaceRepeated"><code>NCMatrixReplaceRepeated</code></a>.
As seen in the section <a href="#ReplaceWithMatrices">Replace with
matrices</a>, the command</p>
<pre><code>NCMatrixReplaceAll[x**y + y, {x -&gt; m1, y -&gt; m2}]</code></pre>
<p>produces the expected result:</p>
<pre class="output"><code>{{d + a**d + b**e, 2 + 2 a + 3 b}, 
 {e + c**d + d**e, 3 + 2 c + 3 d}}</code></pre>
<p>Note that the above behavior might be erratic, since in an expression
like</p>
<pre><code>m1**m2 + m2**m1</code></pre>
<p>in which <code>**</code> is kept unevaluated as in</p>
<pre class="output"><code>{{a, b}, {c, d}}**{{d, 2}, {e, 3}} + {{d, 2}, {e, 3}}**{{a, b}, {c, d}}</code></pre>
<p>the command</p>
<pre><code>m1**m2 + m2**m1 // NCMatrixExpand</code></pre>
<p>expands to the expected result</p>
<pre class="output"><code>{{2 c + a**d + b**e + d**a, 2 a + 3 b + 2 d + d**b}, 
 {3 c + c**d + d**e + e**a, 2 c + 6 d + e**b}}</code></pre>
<h2 data-number="5.3" id="PolysWithCommutativeCoefficients"><span
class="header-section-number">5.3</span> Polynomials with commutative
coefficients</h2>
<p>The package <a href="#PackageNCPoly"><code>NCPoly</code></a> provides
an efficient structure for storing and operating with noncommutative
polynomials with commutative coefficients. There are two main goals:</p>
<ol type="1">
<li><em>Ordering</em>: to be able to sort polynomials based on an
<em>ordering</em> specified by the user. See the chapter <a
href="#NCGB">Noncommutative Gröbner Basis</a> for more details.</li>
<li><em>Efficiency</em>: to efficiently perform polynomial algebra with
as little overhead as possible.</li>
</ol>
<p>Those two properties allow for an efficient implementation of
<code>NCAlgebra</code>’s noncommutative Gröbner basis algorithm, new in
<strong>Version 5</strong>, without the use of auxiliary accelerating
<code>C</code> code, as in <code>NCGB</code>. See <a
href="#NCGB">Noncommutative Gröbner Basis</a>.</p>
<p>Before getting into details, to see how much more efficient
<code>NCPoly</code> is when compared with standard
<code>NCAlgebra</code> objects try</p>
<pre><code>Table[Timing[NCExpand[(1 + x)^i]][[1]], {i, 0, 15, 5}]</code></pre>
<p>which would typically return something like</p>
<pre class="output"><code>{0.000088, 0.001074, 0.017322, 0.240704, 3.61492}</code></pre>
<p>whereas the equivalent</p>
<pre><code>&lt;&lt; NCPoly`
Table[Timing[(1 + NCPolyMonomial[{x}, {x}])^i][[1]], {i, 0, 15, 5}]</code></pre>
<p>would return</p>
<pre class="output"><code>{0.00097, 0.001653, 0.002208, 0.003908, 0.004306}</code></pre>
<p>The best way to work with <code>NCPoly</code> in
<code>NCAlgebra</code> is by loading the package <a
href="#PackageNCPolyInterface"><code>NCPolyInterface</code></a>:</p>
<pre><code>&lt;&lt; NCPolyInterface`</code></pre>
<p>which provides the commands <a
href="#NCToNCPoly"><code>NCToNCPoly</code></a> and <a
href="#NCPolyToNC"><code>NCPolyToNC</code></a> to convert nc expressions
back and forth between <code>NCAlgebra</code> and
<code>NCPoly</code>.</p>
<p>For example</p>
<pre><code>vars = {x, y, z};
p = NCToNCPoly[1 + x**x - 2 x**y**z, vars]</code></pre>
<p>converts the polynomial <code>1 + x**x - 2 x**y**z</code> from the
standard <code>NCAlgebra</code> format into an <code>NCPoly</code>
object. The reason for the braces in the definition of <code>vars</code>
will be explained below, when we introduce <em>ordering</em>. See also
Section <a href="#NCGB">Noncommutative Gröbner Basis</a>. The result in
this case is the <code>NCPoly</code> object</p>
<pre class="output"><code>NCPoly[{1, 1, 1}, &lt;|{0, 0, 0, 0} -&gt; 1, {0, 0, 2, 0} -&gt; 1, {1, 1, 1, 5} -&gt; -2|&gt;]</code></pre>
<p>Conversely the command <a
href="#NCPolyToNC"><code>NCPolyToNC</code></a> converts an
<code>NCPoly</code> back into <code>NCAlgebra</code> format. For
example</p>
<pre><code>NCPolyToNC[p, vars]</code></pre>
<p>returns</p>
<pre class="output"><code>1 + x^2 - 2 x**y**z</code></pre>
<p>as expected. Note that an <code>NCPoly</code> object does not store
symbols, but rather a representation of the polynomial based on
specially encoded monomials. This is the reason why one should provide
<code>vars</code> as an argument to <code>NCPolyToNC</code>.</p>
<p>Alternatively, one could construct the same <code>NCPoly</code>
object by calling <code>NCPoly</code> directly as in</p>
<pre><code>NCPoly[{1, 1, -2}, {{}, {x, x}, {x, y, z}}, vars]</code></pre>
<p>In this syntax the first argument is a list of <em>coefficients</em>,
the second argument is a list of <em>monomials</em>, and the third is
the list of <em>variables</em>. <em>Monomials</em> are given as lists,
with <code>{}</code> being equivalent to a constant <code>1</code>.</p>
<p>The particular coefficients in the <code>NCPoly</code> object depend
not only on the polynomial being represented but also on the
<em>ordering</em> implied by the sequence of symbols in the list of
variables <code>vars</code>. For example:</p>
<pre><code>vars = {{x}, {y, z}};
p = NCToNCPoly[1 + x**x - 2 x**y**z, vars]</code></pre>
<p>produces:</p>
<pre class="output"><code>NCPoly[{1, 2}, &lt;|{0, 0, 0} -&gt; 1, {0, 2, 0} -&gt; 1, {2, 1, 5} -&gt; -2|&gt;</code></pre>
<p>The sequence of braces in the list of <em>variables</em> encodes the
<em>ordering</em> to be used for sorting <code>NCPoly</code>s. Orderings
specify how monomials should be ordered, and is discussed in detail in
<a href="#NCGB">Noncommutative Gröbner Basis</a>. We provide the
convenience command <a
href="#NCPolyDisplayOrder"><code>NCPolyDisplayOrder</code></a> that
prints the polynomial ordering implied by a list of symbols. For
example</p>
<pre><code>NCPolyDisplayOrder[{x,y,z}]</code></pre>
<p>prints out</p>
<p><span class="math display">\[x \ll y \ll z\]</span></p>
<p>and</p>
<pre><code>NCPolyDisplayOrder[{{x},{y,z}}]</code></pre>
<p>prints out</p>
<p><span class="math display">\[x \ll y &lt; z\]</span></p>
<p>from where you can see that grouping variables inside braces induces
a graded type ordering, as discussed in <a href="#NCGB">Noncommutative
Gröbner Basis</a>. <code>NCPoly</code>s constructed from different
orderings cannot be combined.</p>
<p>There is also a special constructor for monomials. For example</p>
<pre><code>NCPolyMonomial[{y,x}, vars]
NCPolyMonomial[{x,y}, vars]</code></pre>
<p>return the monomials corresponding to <span class="math inline">\(y
x\)</span> and <span class="math inline">\(x y\)</span>.</p>
<p>Operations on <code>NCPoly</code> objects result in another
<code>NCPoly</code> object that is always expanded. For example:</p>
<pre><code>vars = {{x}, {y, z}};
1 + NCPolyMonomial[{x, y}, vars] - 2 NCPolyMonomial[{y, x}, vars]</code></pre>
<p>returns</p>
<pre class="output"><code>NCPoly[{1, 2}, &lt;|{0, 0, 0} -&gt; 1, {1, 1, 1} -&gt; 1, {1, 1, 3} -&gt; -2|&gt;]</code></pre>
<p>and</p>
<pre><code>p = (1 + NCPolyMonomial[{x}, vars]**NCPolyMonomial[{y}, vars])^2</code></pre>
<p>returns</p>
<pre class="output"><code>NCPoly[{1, 2}, &lt;|{0, 0, 0} -&gt; 1, {1, 1, 1} -&gt; 2, {2, 2, 10} -&gt; 1|&gt;]</code></pre>
<p>Another convenience function is <code>NCPolyDisplay</code> which
returns a list with the monomials appearing in an <code>NCPoly</code>
object. For example:</p>
<pre><code>NCPolyDisplay[p, vars]</code></pre>
<p>returns</p>
<pre class="output"><code>{x.y.x.y, 2 x.y, 1}</code></pre>
<p>The reason for displaying an <code>NCPoly</code> object as a list is
so that the monomials can appear in the same order as they are stored.
Using <code>Plus</code> would revert to Mathematica’s default ordering.
For example</p>
<pre><code>p = NCToNCPoly[1 + x**y**x - 2 x**x + z, vars]
NCPolyDisplay[p, vars]</code></pre>
<p>returns</p>
<pre class="output"><code>{x.y.x, z, -2 x.x, 1}</code></pre>
<p>whereas</p>
<pre><code>NCPolyToNC[p, vars]</code></pre>
<p>would return</p>
<pre class="output"><code>1 - 2 x^2 + z + x**y**x</code></pre>
<p>in which the sorting of the monomials has been destroyed by
<code>Plus</code>.</p>
<p>The monomials appear sorted in decreasing order from left to right,
with <code>z</code> being the <em>leading term</em> in the above
example.</p>
<p>With <code>NCPoly</code> the Mathematica command <code>Sort</code> is
modified to sort lists of polynomials. For example</p>
<pre><code>polys = NCToNCPoly[{x**x**x, 2 y**x - z, z, y**x - x**x}, vars];
ColumnForm[NCPolyDisplay[Sort[polys], vars]]</code></pre>
<p>returns</p>
<pre class="output"><code>{x.x.x}
{z}
{y.x, -x.x}
{2 y.x, -z}</code></pre>
<p><code>Sort</code> produces a list of polynomials sorted in
<em>ascending</em> order based on their <em>leading terms</em>.</p>
<h2 data-number="5.4"
id="polynomials-with-noncommutative-coefficients"><span
class="header-section-number">5.4</span> Polynomials with noncommutative
coefficients</h2>
<p>A larger class of polynomials in noncommutative variables is that of
polynomials with noncommutative coefficients. Think of a polynomial with
commutative coefficients in which certain variables are considered to be
unknown, i.e. <em>variables</em>, where others are considered to be
known, i.e. <em>coefficients</em>. For example, in many problems in
systems and control the following expression</p>
<p><span class="math display">\[p(x) = a x + x a^T - x b x +
c\]</span></p>
<p>is often seen as a polynomial in the noncommutative unknown
<code>x</code> with known noncommutative coefficients <code>a</code>,
<code>b</code>, and <code>c</code>. A typical problem is the
determination of a solution to the equation <span
class="math inline">\(p(x) = 0\)</span> or the inequality <span
class="math inline">\(p(x) \succeq 0\)</span>.</p>
<p>The package <a
href="#PackageNCPolynomial"><code>NCPolynomial</code></a> handles such
polynomials with noncommutative coefficients. As with <a
href="#PackageNCPoly"><code>NCPoly</code></a>, the package provides the
commands <a href="#NCToNCPolynomial"><code>NCToNCPolynomial</code></a>
and <a href="#NCPolynomialToNC"><code>NCPolynomialToNC</code></a> to
convert nc expressions back and forth between <code>NCAlgebra</code> and
<code>NCPolynomial</code>. For example</p>
<pre><code>vars = {x}
p = NCToNCPolynomial[a**x + x**tp[a] - x**b**x + c, vars]</code></pre>
<p>converts the polynomial <code>a**x + x**tp[a] - x**b**x + c</code>
from the standard <code>NCAlgebra</code> format into an
<code>NCPolynomial</code> object. The result in this case is the
<code>NCPolynomial</code> object</p>
<pre class="output"><code>NCPolynomial[c, &lt;|{x} -&gt; {{1, a, 1}, {1, 1, tp[a]}}, {x, x} -&gt; {{-1, 1, b, 1}}|&gt;, {x}]</code></pre>
<p>Conversely the command <a
href="#NCPolynomialToNC"><code>NCPolynomialToNC</code></a> converts an
<code>NCPolynomial</code> back into <code>NCAlgebra</code> format. For
example</p>
<pre><code>NCPolynomialToNC[p]</code></pre>
<p>returns</p>
<pre class="output"><code>c + a**x + x**tp[a] - x**b**x</code></pre>
<p>An <code>NCPolynomial</code> does store information about the
polynomial symbols and a list of variables is required only at the time
of creation of the <code>NCPolynomial</code> object.</p>
<p>As with <code>NCPoly</code>, operations on <code>NCPolynomial</code>
objects result on another <code>NCPolynomial</code> object that is
always expanded. For example:</p>
<pre><code>vars = {x,y}
1 + NCToNCPolynomial[x**y, vars] - 2 NCToNCPolynomial[y**x, vars]</code></pre>
<p>returns</p>
<pre class="output"><code>NCPolynomial[1, &lt;|{y**x} -&gt; {{-2, 1, 1}}, {x**y} -&gt; {{1, 1, 1}}|&gt;, {x, y}]</code></pre>
<p>and</p>
<pre><code>(1 + NCToNCPolynomial[x, vars]**NCToNCPolynomial[y, vars])^2</code></pre>
<p>returns</p>
<pre class="output"><code>NCPolynomial[1, &lt;|{x**y**x**y} -&gt; {{1, 1, 1}}, {x**y} -&gt; {{2, 1, 1}}|&gt;, {x, y}]</code></pre>
<p>To see how much more efficient <code>NCPolynomial</code> is when
compared with standard <code>NCAlgebra</code> objects try</p>
<pre><code>Table[Timing[(NCToNCPolynomial[x, vars])^i][[1]], {i, 0, 15, 5}]</code></pre>
<p>would return</p>
<pre class="output"><code>{0.000493, 0.003345, 0.005974, 0.013479, 0.018575}</code></pre>
<p>As you can see, <code>NCPolynomial</code>s are not as efficient as
<code>NCPoly</code>s but still much more efficient than
<code>NCAlgebra</code> polynomials.</p>
<p><code>NCPolynomials</code> do not support <em>orderings</em> but we
do provide the <code>NCPSort</code> command that produces a list of
terms sorted by degree. For example</p>
<pre><code>NCPSort[p]</code></pre>
<p>returns</p>
<pre class="output"><code>{c, a**x, x**tp[a], -x**b**x}</code></pre>
<p>A useful feature of <code>NCPolynomial</code> is the capability of
handling polynomial matrices. For example</p>
<pre><code>mat1 = {{a**x + x**tp[a] + c**y + tp[y]**tp[c] - x**q**x, b**x}, 
        {x**tp[b], 1}};
p1 = NCToNCPolynomial[mat1, {x, y}];

mat2 = {{1, x**tp[c]}, {c**x, 1}};
p2 = NCToNCPolynomial[mat2, {x, y}];</code></pre>
<p>constructs <code>NCPolynomial</code> objects representing the
polynomial matrices <code>mat1</code> and <code>mat2</code>. Verify
that</p>
<pre><code>NCPolynomialToNC[p1**p2] - NCDot[mat1, mat2] // NCExpand</code></pre>
<p>is zero as expected. Internally <code>NCPolynomial</code> represents
a polynomial matrix by constructing matrix factors. For example the
representation of the matrix <code>mat1</code> correspond to the factors
<span class="math display">\[
\begin{aligned}
\begin{bmatrix}
    a x + x a^T + c y + y^T c^T - x q x &amp; b x \\
    x b^T &amp; 1
\end{bmatrix}
&amp;=
\begin{bmatrix} 0 &amp; 0 \\ 0 &amp; 1 \end{bmatrix}
+
\begin{bmatrix} a \\ 0 \end{bmatrix}
x
\begin{bmatrix} 1 &amp; 0 \end{bmatrix}
+
\begin{bmatrix} 1 \\ 0 \end{bmatrix}
x
\begin{bmatrix} a^T &amp; 0 \end{bmatrix}
+
\begin{bmatrix} -1 \\ 0 \end{bmatrix}
x q x
\begin{bmatrix} 1 &amp; 0 \end{bmatrix}
+ \\ &amp; \qquad \quad
\begin{bmatrix} b \\ 0 \end{bmatrix}
x
\begin{bmatrix} 0 &amp; 1 \end{bmatrix}
+
\begin{bmatrix} 0 \\ 1 \end{bmatrix}
x
\begin{bmatrix} b^T &amp; 0 \end{bmatrix}
+
\begin{bmatrix} c \\ 0 \end{bmatrix}
y
\begin{bmatrix} 1 &amp; 0 \end{bmatrix}
+
\begin{bmatrix} 1 \\ 0 \end{bmatrix}
y^T
\begin{bmatrix} c^T &amp; 0 \end{bmatrix}
\end{aligned}
\]</span></p>
<p>See section <a href="#Linear">linear polynomials</a> for more
features on linear polynomial matrices.</p>
<h2 data-number="5.5" id="Linear"><span
class="header-section-number">5.5</span> Linear polynomials</h2>
<p>Another interesting class of nc polynomials is that of linear
polynomials, which can be factored in the form:</p>
<p><span class="math display">\[s(x) = l (F \otimes x) r\]</span></p>
<p>where <span class="math inline">\(l\)</span> and <span
class="math inline">\(r\)</span> are vectors with symbolic expressions
and <span class="math inline">\(F\)</span> is a numeric matrix. This
functionality is in the package</p>
<pre><code>&lt;&lt; NCSylvester`</code></pre>
<p>Use the command <a
href="#NCToNCSylvester"><code>NCToNCSylvester</code></a> to factor a
linear nc polynomial into the the above form. For example:</p>
<pre><code>vars = {x, y};
expr = 1 + a**x + x**tp[a] - x + b**y**d + tp[d]**tp[y]**tp[b];
{const, lin} = NCToNCSylvester[expr, vars];</code></pre>
<p>which returns</p>
<pre class="output"><code>const = 1</code></pre>
<p>and an <code>Association</code> <code>lin</code> containing the
factorization. For example</p>
<pre><code>lin[x]</code></pre>
<p>returns a list with the left and right vectors <code>l</code> and
<code>r</code> and the coefficient array <code>F</code>.</p>
<pre class="output"><code>{{1, a}, {1, a^T}, SparseArray[&lt; 2 &gt;, {2, 2}]}</code></pre>
<p>which in this case is the matrix:</p>
<p><span class="math display">\[
\begin{bmatrix}
    -1 &amp; 1\\
    1 &amp; 0
\end{bmatrix}
\]</span></p>
<p>and</p>
<pre><code>lin[tp[y]]</code></pre>
<p>returns</p>
<pre class="output"><code>{{d^T}, {b^T}, SparseArray[&lt; 1 &gt;, {1, 1}]}</code></pre>
<p>Note that transposes and adjoints are treated as independent
variables.</p>
<p>Perhaps the most useful consequence of the above factorization is the
possibility of producing a linear polynomial which has the smallest
possible number of terms, as explaining in detail in <span
class="citation" data-cites="oliveira:SSP:2012">(Oliveira 2012)</span>.
This is done automatically by <a
href="#NCSylvesterToNC"><code>NCSylvesterToNC</code></a>. For
example</p>
<pre><code>vars = {x, y};
expr = a**x**c - a**x**d - a**y**c + a**y**d + b**x**c - b**x**d - b**y**c + b**y**d;
{const, lin} = NCToNCSylvester[expr, vars];
NCSylvesterToNC[{const, lin}]</code></pre>
<p>produces:</p>
<pre class="output"><code>(a + b)**x**(c - d) + (a + b)**y**(-c + d)</code></pre>
<p>This factorization even works with linear matrix polynomials, and is
used by the our semidefinite programming algorithm (see Chapter <a
href="#SemidefiniteProgramming">Semidefinite Programming</a>) to factor
linear matrix inequalities in the least possible number of terms. For
example:</p>
<pre><code>vars = {x};
expr = {{a**x + x**tp[a], b**x, tp[c]},
        {x**tp[b], -1, tp[d]},
        {c, d, -1}};
{const, lin} = NCToNCSylvester[expr, vars]</code></pre>
<p>result in:</p>
<pre class="output"><code>const = SparseArray[&lt; 6 &gt;, {3, 3}]
lin = &lt;|x -&gt; {{1, a, b}, {1, tp[a], tp[b]}, SparseArray[&lt; 4 &gt;, {9, 9}]}|&gt;</code></pre>
<p>See <span class="citation" data-cites="oliveira:SSP:2012">(Oliveira
2012)</span> for details on the structure of the constant array <span
class="math inline">\(F\)</span> in this case.</p>
<h1 data-number="6" id="NCGB"><span
class="header-section-number">6</span> Noncommutative Gröbner Basis</h1>
<p>Gröbner Basis are useful in the study of algebraic relations. The
package <code>NCGBX</code> provides an implementation of a
noncommutative Gröbner Basis algorithm.</p>
<blockquote>
<p>Starting with <strong>Version 6</strong>, the old <code>C++</code>
version of our Groebner Basis Algorithm is no longer included.</p>
</blockquote>
<p>If you want a living version of this chapter just run the notebook
<code>NC/DEMOS/3_NCGroebnerBasis.nb</code>.</p>
<p>In order to load <code>NCGBX</code> one types:</p>
<pre><code>&lt;&lt; NC`
&lt;&lt; NCAlgebra`
&lt;&lt; NCGBX`</code></pre>
<p>or simply</p>
<pre><code>&lt;&lt; NCGBX`</code></pre>
<p>if <code>NC</code> and <code>NCAlgebra</code> have already been
loaded.</p>
<h2 data-number="6.1" id="what-is-a-gröbner-basis"><span
class="header-section-number">6.1</span> What is a Gröbner Basis?</h2>
<p>Most commutative algebra packages contain commands based on Gröbner
Basis and uses of Gröbner Basis. For example, in Mathematica, the
<code>Solve</code> command puts collections of equations in a
<em>canonical form</em> which, for simple collections, readily yields a
solution. Likewise, the Mathematica <code>Eliminate</code> command tries
to convert a collection of <span class="math inline">\(m\)</span>
polynomial equations (often called relations)</p>
<p><span class="math display">\[\begin{aligned}
    p_1(x_1,\ldots,x_n) &amp;= 0 \\
    p_2(x_1,\ldots,x_n) &amp;= 0 \\
    \vdots \quad &amp; \quad \, \, \vdots \\
    p_m(x_1,\ldots,x_n) &amp;= 0
\end{aligned}\]</span></p>
<p>in variables <span class="math inline">\(x_1,x_2, \ldots x_n\)</span>
to a <em>triangular</em> form, that is a new collection of equations
like</p>
<p><span class="math display">\[\begin{aligned}
    q_1(x_1) &amp;= 0 \\
    q_2(x_1,x_2) &amp;= 0 \\
    q_3(x_1,x_2) &amp;= 0 \\
    q_4(x_1,x_2,x_3)&amp;=0 \\
    \vdots \quad &amp; \quad \, \, \vdots \\
    q_{r}(x_1,\ldots,x_n) &amp;= 0.
\end{aligned}\]</span></p>
<p>Here the polynomials <span class="math inline">\(\{q_j: 1\le j\le
k_2\}\)</span> generate the same <em>ideal</em> that the polynomials
<span class="math inline">\(\{p_j : 1\le j \le k_1\}\)</span> generate.
Therefore, the set of solutions to the collection of polynomial
equations <span class="math inline">\(\{p_j=0: 1\le j\le k_1\}\)</span>
equals the set of solutions to the collection of polynomial equations
<span class="math inline">\(\{q_j=0: 1\le j\le k_2\}\)</span>. This
canonical form greatly simplifies the task of solving collections of
polynomial equations by facilitating backsolving for <span
class="math inline">\(x_j\)</span> in terms of <span
class="math inline">\(x_1,\ldots,x_{j-1}\)</span>.</p>
<p>Readers who would like to know more about Gröbner Basis may want to
read [CLS]. The noncommutatative version of the algorithm implemented by
<code>NCGB</code> is loosely based on [Mora].</p>
<h2 data-number="6.2" id="solving-equations"><span
class="header-section-number">6.2</span> Solving Equations</h2>
<p>Before calculating a Gröbner Basis, one must declare which variables
will be used during the computation and must declare a <em>monomial
order</em> which can be done using <code>SetMonomialOrder</code> as
in:</p>
<pre><code>SetMonomialOrder[{a, b, c}, x];</code></pre>
<p>The monomial ordering imposes a relationship between the variables
which are used to <em>sort</em> the monomials in a polynomial. The
ordering implied by the above command can be visualized using:</p>
<pre><code>PrintMonomialOrder[]</code></pre>
<p>which in this case prints:</p>
<p><span class="math display">\[a &lt; b &lt; c \ll x.\]</span></p>
<p>A user does not need to know theoretical background related to
monomials orders. Indeed, as we shall see soon, in many engineering
problems, it suffices to know which variables correspond to quantities
which are <em>known</em> and which variables correspond to quantities
which are <em>unknown</em>. If one is solving for a variable or desires
to prove that a certain quantity is zero, then one would want to view
that variable as <em>unknown</em>. In the above example, the symbol
‘<span class="math inline">\(\ll\)</span>’ separate the <em>knowns</em>,
<span class="math inline">\(a, b, c\)</span>, from the <em>unknown</em>,
<span class="math inline">\(x\)</span>. For more details on orderings
see Section <a href="#Orderings">Orderings</a>.</p>
<p>Our goal is to calculate the Gröbner basis associated with the
following relations (i.e. a list of polynomials):</p>
<p><span class="math display">\[\begin{aligned}
    a \, x \, a &amp;= c, &amp;
    a \, b &amp;= 1, &amp;
    b \, a &amp;= 1.
\end{aligned}\]</span></p>
<p>We shall use the word <em>relation</em> to mean a polynomial in
noncommuting indeterminates. For example, if an analyst saw the equation
<span class="math inline">\(A B = 1\)</span> for matrices <span
class="math inline">\(A\)</span> and <span
class="math inline">\(B\)</span>, then he might say that <span
class="math inline">\(A\)</span> and <span
class="math inline">\(B\)</span> satisfy the polynomial equation <span
class="math inline">\(a\, b - 1 = 0\)</span>. An algebraist would say
that <span class="math inline">\(a\, b - 1\)</span> is a relation.</p>
<p>To calculate a Gröbner basis one defines a list of relations:</p>
<pre><code>rels = {a**x**a - c, a**b - 1, b**a - 1}</code></pre>
<p>and issues the command:</p>
<pre><code>gb = NCMakeGB[rels, 10]</code></pre>
<p>which should produce an output similar to:</p>
<pre class="output"><code>* * * * * * * * * * * * * * * *
* * *   NCPolyGroebner    * * *
* * * * * * * * * * * * * * * *
* Monomial order: a &lt; b &lt; c &lt;&lt; x
* Reduce and normalize initial set
&gt; Initial set could not be reduced
* Computing initial set of obstructions
&gt; MAJOR Iteration 1, 4 polys in the basis, 2 obstructions
&gt; MAJOR Iteration 2, 5 polys in the basis, 2 obstructions
* Cleaning up...
* Found Groebner basis with 3 polynomials
* * * * * * * * * * * * * * * *</code></pre>
<p>The number <code>10</code> in the call to <code>NCMakeGB</code> is
very important because a finite GB may not exist. It instructs
<code>NCMakeGB</code> to abort after <code>10</code> iterations if a GB
has not been found at that point.</p>
<p>The result of the above calculation is the list of relations in the
form of a list of rules:</p>
<pre class="output"><code>{x -&gt; b**c**b, a**b -&gt; 1, b**a -&gt; 1}</code></pre>
<blockquote>
<p><strong>Version 5:</strong> For efficiency, <code>NCMakeGB</code>
returns a list of rules instead of a list of polynomials. The left-hand
side of the rule is the leading monomial in the current order. This is
incompatible with early versions, which returned a list of polynomials.
You can recover the old behavior setting the option
<code>ReturnRules -&gt; False</code>. This can be done in the
<code>NCMakeGB</code> command or globally through
<code>SetOptions[ReturnRules -&gt; False]</code>.</p>
</blockquote>
<p>Our favorite format for displaying lists of relations is
<code>ColumnForm</code>.</p>
<pre><code>ColumnForm[gb]</code></pre>
<p>which results in</p>
<pre class="output"><code>x -&gt; b**c**b
a**b -&gt; 1
b**a -&gt; 1</code></pre>
<p>The <em>rules</em> in the output represent the relations in the GB
with the left-hand side of the rule being the leading monomial.
Replacing <code>Rule</code> by <code>Subtract</code> recovers the
relations but one would then loose the leading monomial as Mathematica
alphabetizes the resulting sum.</p>
<p>Someone not familiar with GB’s might find it instructive to note this
output GB effectively <em>solves</em> the input equation</p>
<p><span class="math display">\[a \, x \, a - c = 0\]</span></p>
<p>under the assumptions that</p>
<p><span class="math display">\[\begin{aligned}
    b \, a - 1 &amp;= 0, &amp;
    a \, b - 1 &amp; =0,
\end{aligned}\]</span></p>
<p>that is <span class="math inline">\(a = b^{-1}\)</span> and produces
the expected result in the form of the relation:</p>
<p><span class="math display">\[ x = b \, c \, b. \]</span></p>
<h2 data-number="6.3" id="a-slightly-more-challenging-example"><span
class="header-section-number">6.3</span> A Slightly more Challenging
Example</h2>
<p>For a slightly more challenging example consider the same monomial
order as before:</p>
<pre><code>SetMonomialOrder[{a, b, c}, x];</code></pre>
<p>that is</p>
<p><span class="math inline">\(a &lt; b &lt; c \ll x\)</span></p>
<p>and the relations:</p>
<p><span class="math display">\[\begin{aligned}
  a \, x - c &amp;= 0, \\
  a \, b \, a - a &amp;= 0, \\
  b \, a \, b - b &amp;= 0,
\end{aligned}\]</span></p>
<p>from which one can recognize the problem of solving the linear
equation <span class="math inline">\(a \, x = c\)</span> in terms of the
<em>pseudo-inverse</em> <span class="math inline">\(b =
a^\dagger\)</span>. The calculation:</p>
<pre><code>gb = NCMakeGB[{a**x - c, a**b**a - a, b**a**b - b}, 10];
ColumnForm[gb]</code></pre>
<p>finds the Gröbner basis:</p>
<pre class="output"><code>a**x -&gt; c
a**b**c -&gt; c
a**b**a -&gt; a 
b**a**b -&gt; b</code></pre>
<p>In this case the Gröbner basis cannot quite <em>solve</em> the
equations but it remarkably produces the necessary condition for
existence of solutions:</p>
<p><span class="math display">\[ 0 = a \, b \, c - c = a \, a^\dagger c
- c \]</span></p>
<p>that can be interpreted as <span class="math inline">\(c\)</span>
being in the range-space of <span class="math inline">\(a\)</span>.</p>
<h2 data-number="6.4" id="simplifying-polynomial-expressions"><span
class="header-section-number">6.4</span> Simplifying Polynomial
Expressions</h2>
<p>Our goal now is to verify if it is possible to <em>simplify</em> the
following expression:</p>
<pre><code>expr = b^2**a^2 - a^2**b^2 + a**b**a</code></pre>
<p>knowing that</p>
<p><span class="math display">\[ a \, b \, a = b \]</span></p>
<p>using Gröbner basis. With that in mind we set the ordering:</p>
<pre><code>SetMonomialOrder[a,b];</code></pre>
<p>and calculate the GB associated with the constraint:</p>
<pre><code>rels = {a**b**a - b};
rules = NCMakeGB[rels, 10];
ColumnForm[rules]</code></pre>
<p>which produces the output</p>
<pre class="output"><code>* * * * * * * * * * * * * * * *
* * *   NCPolyGroebner    * * *
* * * * * * * * * * * * * * * *
* Monomial order: a &lt;&lt; b
* Reduce and normalize initial set
&gt; Initial set could not be reduced
* Computing initial set of obstructions
&gt; MAJOR Iteration 1, 2 polys in the basis, 1 obstructions
* Cleaning up...
* Found Groebner basis with 2 polynomials
* * * * * * * * * * * * * * * *</code></pre>
<p>and the associated GB</p>
<pre class="output"><code>a**b**a -&gt; b
b^2**a -&gt; a**b^2</code></pre>
<p>The GB revealed another relationship that must hold true if <span
class="math inline">\(a \, b \, a = b\)</span>. One can use these
relationships to simplify the original expression using
<code>NCReplaceRepeated</code> as in</p>
<pre><code>NCReplaceRepeated[expr, rules]</code></pre>
<p>which simplifies <code>expr</code> into <code>b</code>.</p>
<p>An alternative, since we are working with polynomials, is to use <a
href="#NCReduce"><code>NCReduce</code></a> as in</p>
<pre><code>vars = GetMonomialOrder[];
NCReduce[expr, NCRuleToPoly[rules], vars]</code></pre>
<p>Note that <code>NCReduce</code> needs a list of variables to be used
as the desired ordering, which we obtain from the current ordering using
<a href="#GetMonomialOrder"><code>GetMonomialOrder</code></a>, and that
the rules in <code>rules</code> need to be converted to polynomials,
which we do using <a
href="NCRuleToPoly"><code>NCRuleToPoly</code></a>.</p>
<h2 data-number="6.5" id="PolynomialsAndRules"><span
class="header-section-number">6.5</span> Polynomials and Rules</h2>
<p>Having seen how polynomial relations can be interpreted as rules,
consider the expression</p>
<pre><code>expr = b^2**a^2 + a^2**b^3 + a**b**a</code></pre>
<p>and the polynomial relations</p>
<pre><code>rels = {a**b**a - b , b^2 - a + b}</code></pre>
<p>With respect to the monomial ordering</p>
<pre><code>SetMonomialOrder[a, b];</code></pre>
<p>we can interpret these relations as the rules</p>
<pre><code>vars = GetMonomialOrder[];
(rules = NCToRule[rels, vars]) // ColumnForm</code></pre>
<p>that is</p>
<pre class="output"><code>a**b**a -&gt; b
b^2 -&gt; a - b</code></pre>
<p>Note how we used <a
href="#GetMonomialOrder"><code>GetMonomialOrder</code></a> to obtain the
list of variables <code>vars</code> corresponding to the ordering</p>
<p><span class="math display">\[ a \ll b\]</span></p>
<p>and <a href="#NCToRule"><code>NCToRule</code></a> to convert the
polynomial relations into rules.</p>
<p>We can then apply these rules by using one of the
<code>NCReplace</code> functions, for example</p>
<pre><code>NCExpandReplaceRepeated[expr, rules]</code></pre>
<p>which produces</p>
<pre class="output"><code>b + a^2**b + a^3**b - b**a^2</code></pre>
<p>Note that we have made use of the new function <a
href="#NCExpandReplaceRepeated"><code>NCExpandReplaceRepeated</code></a>,
to automate the tedious cycles of expansion and substitution.</p>
<p>Alternatively, one can use <a
href="#NCReduce"><code>NCReduce</code></a> to perform the same
substitution. <code>NCReduce</code> takes in polynomial, instead of
rules, and a list of variables. For example,</p>
<pre><code>NCReduce[expr, rels, vars]</code></pre>
<p>produces</p>
<pre class="output"><code>a^2**b + a^3**b - b**a^2 + a**b**a</code></pre>
<p>which is the result of applying the rules only to the leading
monomial of <code>expr</code>. If you want substitutions to be applied
to all monomials then set the option <code>Complete</code> to
<code>True</code>, as in</p>
<pre><code>NCReduce[expr, rels, vars, Complete -&gt; True]</code></pre>
<p>This produces</p>
<pre class="output"><code>b + a^2**b + a^3**b - b**a^2</code></pre>
<p>which is the same result as above.</p>
<p>But, of course, by now one should wonder whether the above polynomial
relations could imply other simplifications, which we seek to find out
by running our Gröbner basis algorithm:</p>
<pre><code>rules = NCMakeGB[rels, 4];
ColumnForm[rules]</code></pre>
<p>that discovers the following additional relations</p>
<pre class="output"><code>b^2 -&gt; a - b
b**a -&gt; a**b
a^2**b -&gt; b
a^3 -&gt; a</code></pre>
<p>When used for simplification,</p>
<pre><code>NCExpandReplaceRepeated[expr, rules]</code></pre>
<p>reduces the original expression to the even simpler form</p>
<pre class="output"><code>b + a**b</code></pre>
<p>As before, rule substitution could also be performed by <a
href="#NCReduce"><code>NCReduce</code></a> as in</p>
<pre><code>NCReduce[expr, NCRuleToPoly[rules], vars]</code></pre>
<p>that, in this case, leads to the same result as above without the
need to recourse to the <code>Complete</code> flag.</p>
<h2 data-number="6.6" id="minimal-versus-reduced-gröbner-basis"><span
class="header-section-number">6.6</span> Minimal versus Reduced Gröbner
Basis</h2>
<p>The algorithm implemented by <code>NCGB</code> always produces a
Gröbner Basis with the <em>minimal</em> possible number of polynomials
at a given iteration. However, such polynomials are not necessarily the
“simplest” possible polynomials; called the <em>reduced</em> Gröbner
Basis. The <em>reduced</em> Gröbner Basis is unique given the relations
and the monomial ordering. Consider for example the following monomial
ordering</p>
<pre><code>SetMonomialOrder[x, y]</code></pre>
<p>and the relations</p>
<pre><code>rels = {x^3 - 2 x**y, x^2**y - 2 y^2 + x}</code></pre>
<p>for which</p>
<pre><code>NCMakeGB[rels, ReduceBasis -&gt; False] // ColumnForm</code></pre>
<p>produces the <em>minimal</em> Gröbner Basis</p>
<pre class="output"><code>x^2-&gt;0
x**y-&gt;x^3/2
y**x-&gt;x**y
y^2-&gt;x/2+x^2**y/2</code></pre>
<p>but</p>
<pre><code>NCMakeGB[rels, ReduceBasis -&gt; True] // ColumnForm</code></pre>
<p>returns the <em>reduced</em> Gröbner Basis</p>
<pre class="output"><code>x^2-&gt;0
x**y-&gt;0
y**x-&gt;0
y^2-&gt;x/2</code></pre>
<p>in which not only the leading monomials but also all lower-order
monomials have been reduced by the basis’ leading monomials. The option
<code>ReduceBasis</code> is set to <code>True</code> by default.</p>
<h2 data-number="6.7" id="SimplifyingRationalExpressions"><span
class="header-section-number">6.7</span> Simplifying Rational
Expressions</h2>
<p>It is often desirable to simplify expressions involving inverses of
noncommutative expressions. One challenge is to recognize identities
implied by the existence of certain inverses. For example, that the
expression</p>
<pre><code>expr = x**inv[1 - x] - inv[1 - x]**x</code></pre>
<p>is equivalent to <span class="math inline">\(0\)</span>. One can use
a nc Gröbner basis for that task. Consider for instance the ordering</p>
<p><span class="math display">\[ x \ll (1-x)^{-1} \]</span></p>
<p>implied by the command:</p>
<pre><code>SetMonomialOrder[x, inv[1-x]]</code></pre>
<p>This ordering encodes the following precise idea of what we mean by
<em>simple</em> versus <em>complicated</em>: it formally corresponds to
specifying that <span class="math inline">\(x\)</span> is simpler than
<span class="math inline">\((1-x)^{-1}\)</span>, which might sits well
with one’s intuition.</p>
<p>Now consider the following command:</p>
<pre><code>(rules = NCMakeGB[{}, 3]) // ColumnForm</code></pre>
<p>which produces the output</p>
<pre class="output"><code>* * * * * * * * * * * * * * * *
* * *   NCPolyGroebner    * * *
* * * * * * * * * * * * * * * *
* Monomial order: x &lt;&lt;  inv[x] &lt;&lt; inv[1 - x]
* Reduce and normalize initial set
&gt; Initial set could not be reduced
* Computing initial set of obstructions
&gt; MAJOR Iteration 1, 6 polys in the basis, 6 obstructions
* Cleaning up...
* Found Groebner basis with 6 polynomials
* * * * * * * * * * * * * * * *</code></pre>
<p>and results in the rules:</p>
<pre class="output"><code>x**inv[1 - x] -&gt; -1 + inv[1 - x],
inv[1-x]**x -&gt; -1 + inv[1-x],</code></pre>
<p>As in the previous example, the GB revealed new relationships that
must hold true if <span class="math inline">\(1- x\)</span> is
invertible, and one can use this relationship to <em>simplify</em> the
original expression using <code>NCReplaceRepeated</code> as in:</p>
<pre><code>NCReplaceRepeated[expr, rules]</code></pre>
<p>The above command results in <code>0</code>, as one would hope.</p>
<p>For a more challenging example consider the identity:</p>
<p><span class="math display">\[\left (1 - x - y (1 - x)^{-1} y \right
)^{-1} = \frac{1}{2} (1 - x - y)^{-1} + \frac{1}{2} (1 - x +
y)^{-1}\]</span></p>
<p>One can verify that the rule based command <a
href="#NCSimplifyRational">NCSimplifyRational</a> fails to simplify the
expression:</p>
<pre><code>expr = inv[1 - x - y**inv[1 - x]**y] - 1/2 (inv[1 - x + y] + inv[1 - x - y])
NCSimplifyRational[expr]</code></pre>
<p>We set the monomial ordering and calculate the Gröbner basis</p>
<pre><code>SetMonomialOrder[x, y, inv[1-x], inv[1-x+y], inv[1-x-y], inv[1-x-y**inv[1-x]**y]];
(rules = NCMakeGB[{}, 3]) // ColumnForm</code></pre>
<p>based on the rational involved in the original expression. The result
is the nc GB:</p>
<pre class="output"><code>inv[1-x-y**inv[1-x]**y] -&gt; (1/2)inv[1-x-y]+(1/2)inv[1-x+y]
x**inv[1-x] -&gt; -1+inv[1-x]
y**inv[1-x+y] -&gt; 1-inv[1-x+y]+x**inv[1-x+y]
y**inv[1-x-y] -&gt; -1+inv[1-x-y]-x**inv[1-x-y]
inv[1-x]**x -&gt; -1+inv[1-x]
inv[1-x+y]**y -&gt; 1-inv[1-x+y]+inv[1-x+y]**x
inv[1-x-y]**y -&gt; -1+inv[1-x-y]-inv[1-x-y]**x
inv[1-x+y]**x**inv[1-x-y] -&gt; -(1/2)inv[1-x-y]-(1/2)inv[1-x+y]+inv[1-x+y]**inv[1-x-y]
inv[1-x-y]**x**inv[1-x+y] -&gt; -(1/2)inv[1-x-y]-(1/2)inv[1-x+y]+inv[1-x-y]**inv[1-x+y]</code></pre>
<p>which successfully simplifies the original expression using:</p>
<pre><code>NCExpandReplaceRepeated[expr, rules]</code></pre>
<p>resulting in <code>0</code>.</p>
<p>See also <a href="#AdvancedProcessingOfRationalExpressions">Advanced
Processing of Rational Expressions</a> for more details on the lower
level handling of rational expressions.</p>
<h2 data-number="6.8"
id="simplification-with-ncgbsimplifyrational"><span
class="header-section-number">6.8</span> Simplification with
NCGBSimplifyRational</h2>
<p>The simplification process described above is automated in the
function <a href="#NCGBSimplifyRational">NCGBSimplifyRational</a>.</p>
<p>For example, calls to</p>
<pre><code>expr = x**inv[1 - x] - inv[1 - x]**x
NCGBSimplifyRational[expr]</code></pre>
<p>or</p>
<pre><code>expr = inv[1 - x - y**inv[1 - x]**y] - 1/2 (inv[1 - x + y] + inv[1 - x - y])
NCGBSimplifyRational[expr]</code></pre>
<p>both result in <code>0</code>.</p>
<h2 data-number="6.9" id="Orderings"><span
class="header-section-number">6.9</span> Ordering on Variables and
Monomials</h2>
<p>As seen above, one needs to declare a <em>monomial order</em> before
making a Gröbner Basis. There are various monomial orders which can be
used when computing Gröbner Basis. The most common are
<em>lexicographic</em> and <em>graded lexicographic</em> orders. We
consider also <em>multi-graded lexicographic</em> orders.</p>
<p>Lexicographic and multi-graded lexicographic orders are examples of
elimination orderings. An elimination ordering is an ordering which is
used for solving for some of the variables in terms of others.</p>
<p>We now discuss each of these types of orders.</p>
<h3 data-number="6.9.1"
id="lex-order-the-simplest-elimination-order"><span
class="header-section-number">6.9.1</span> Lex Order: the simplest
elimination order</h3>
<p>To impose lexicographic order, say <span class="math inline">\(a\ll
b\ll x\ll y\)</span> on <span class="math inline">\(a\)</span>, <span
class="math inline">\(b\)</span>, <span class="math inline">\(x\)</span>
and <span class="math inline">\(y\)</span>, one types</p>
<pre><code>SetMonomialOrder[a,b,x,y];</code></pre>
<p>or, equivalently</p>
<pre><code>SetMonomialOrder[{a},{b},{x},{y}];</code></pre>
<p>This order is useful for attempting to solve for <span
class="math inline">\(y\)</span> in terms of <span
class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>
and <span class="math inline">\(x\)</span>, since the highest priority
of the GB algorithm is to produce polynomials which do not contain <span
class="math inline">\(y\)</span>. If producing high order polynomials is
a consequence of this fanaticism so be it. Unlike graded orders, lex
orders pay little attention to the degree of terms. Likewise its second
highest priority is to eliminate <span
class="math inline">\(x\)</span>.</p>
<p>Once this order is set, one can use all of the commands in the
preceding section in exactly the same form.</p>
<p>We now give a simple example how one can solve for <span
class="math inline">\(y\)</span> given that <span
class="math inline">\(a\)</span>,<span
class="math inline">\(b\)</span>,<span class="math inline">\(x\)</span>
and <span class="math inline">\(y\)</span> satisfy the equations:</p>
<p><span class="math display">\[\begin{aligned}
-b\, x + x\, y  \, a + x\, b \, a \,  a &amp;= 0 \\
x \, a-1&amp;=0 \\
a\, x-1&amp;=0
\end{aligned}\]</span></p>
<p>The command</p>
<pre><code>NCMakeGB[{-b**x+x**y**a+x**b**a**a, x**a-1, a**x-1},4] // ColumnForm</code></pre>
<p>produces the Gröbner basis:</p>
<pre class="output"><code>y -&gt; -b**a + a**b**x^2
a**x -&gt; 1 
x**a -&gt; 1</code></pre>
<p>after one iteration.</p>
<p>Now, we change the ordering to</p>
<pre><code>SetMonomialOrder[y,x,b,a];</code></pre>
<p>and run the same <code>NCMakeGB</code> as above:</p>
<pre><code>NCMakeGB[{-b**x+x**y**a+x**b**a**a, x**a-1, a**x-1},4] // ColumnForm</code></pre>
<p>which, this time, results in</p>
<pre class="output"><code>b**x^3 -&gt; x**b+x**y**x
x**a -&gt; 1
a**x -&gt; 1
x**b**a -&gt; b**x^2 - x**y
a**b**x^2 -&gt; y+b**a
x**b^2**a -&gt; -x**b**y+b**x^2**b**x^2 - 
    x**y**b**x^2
b**a^2 -&gt; -y**a+a**b**x
b**a**b**a -&gt; -y^2 - b**a**y - y**b**a+
    a**b**x**b**x^2
b**a**b^2**a -&gt; -y**b**y - y**b^2**a - 
    y^2**b**x^2 - b**a**b**y - b**a**y**b**x^2+
    a**b**x**b**x^2**b**x^2</code></pre>
<p>which is not a Gröbner basis since the algorithm was interrupted at 4
iterations. Note the presence of the rule</p>
<pre class="output"><code>a**b**x**x -&gt; y+b**a</code></pre>
<p>which shows that the ordering is not set up to solve for <span
class="math inline">\(y\)</span> in terms of the other variables in the
sense that <span class="math inline">\(y\)</span> is not on the left
hand side of this rule (but a human could easily solve for <span
class="math inline">\(y\)</span> using this rule). Also the algorithm
created a number of other relations which involved <span
class="math inline">\(y\)</span>.</p>
<h3 data-number="6.9.2"
id="graded-lex-ordering-a-non-elimination-order"><span
class="header-section-number">6.9.2</span> Graded Lex Ordering: a
non-elimination order</h3>
<p>To impose graded lexicographic order, say <span
class="math inline">\(a&lt; b&lt; x&lt; y\)</span> on <span
class="math inline">\(a\)</span>, <span
class="math inline">\(b\)</span>, <span class="math inline">\(x\)</span>
and <span class="math inline">\(y\)</span>, one types</p>
<pre><code>SetMonomialOrder[{a,b,x,y}];</code></pre>
<p>This ordering puts high degree monomials high in the ordering. Thus
it tries to decrease the total degree of expressions. A call to</p>
<pre><code>NCMakeGB[{-b**x+x**y**a+x**b**a**a, x**a-1, a**x-1},4,ReduceBasis-&gt;True] // ColumnForm</code></pre>
<p>now produces</p>
<pre class="output"><code>a**x -&gt; 1,
x**a -&gt; 1,
b**a^2 -&gt; -y**a+a**b**x,
x**b**a -&gt; b**x^2 - x**y,
a**b**x^2 -&gt; y+b**a,
b**x^3 -&gt; x**b+x**y**x,
a**b**x**b**x^2 -&gt; y^2+b**a**y+y**b**a+b**a**b**a,
b**x^2**b**x^2 -&gt; x**b**y+x**b^2**a+x**y**b**x^2,
a**b**x**b**x**b**x^2 -&gt; y^3+b**a**y^2+y^2**b**a+y**b**a**y+
                         b**a**b**a**y+b**a**y**b**a+
                         y**b**a**b**a+b**a**b**a**b**a,
b**x^2**b**x**b**x^2 -&gt; x**b**y^2+x**b^2**a**y+x**b**y**b**a+
                        x**b^2**a**b**a+x**y**b**x**b**x^2</code></pre>
<p>which again fails to be a Gröbner basis and does not eliminate <span
class="math inline">\(y\)</span>. Instead, it tries to decrease the
total degree of expressions involving <span
class="math inline">\(a\)</span>, <span
class="math inline">\(b\)</span>, <span
class="math inline">\(x\)</span>, and <span
class="math inline">\(y\)</span>.</p>
<h3 data-number="6.9.3"
id="multigraded-lex-ordering-a-variety-of-elimination-orders"><span
class="header-section-number">6.9.3</span> Multigraded Lex Ordering: a
variety of elimination orders</h3>
<p>There are other useful monomial orders which one can use other than
graded lex and lex. Another type of order is what we call multigraded
lex and is a mixture of graded lex and lex order. To impose multi-graded
lexicographic order, say <span class="math inline">\(a&lt; b&lt; x\ll
y\)</span> on <span class="math inline">\(a\)</span>, <span
class="math inline">\(b\)</span>, <span class="math inline">\(x\)</span>
and <span class="math inline">\(y\)</span>, one types</p>
<pre><code>SetMonomialOrder[{a,b,x},y];</code></pre>
<p>which separates <span class="math inline">\(y\)</span> from the
remaining variables. This time, a call to</p>
<pre><code>NCMakeGB[{-b**x+x**y**a+x**b**a**a, x**a-1, a**x-1},4,ReduceBasis-&gt;True] // ColumnForm</code></pre>
<p>yields once again</p>
<pre class="output"><code>y -&gt; -b**a+a**b**x^2
a**x -&gt; 1
x**a -&gt; 1</code></pre>
<p>which not only eliminates <span class="math inline">\(y\)</span> but
is also Gröbner basis, calculated after one iteration.</p>
<p>For an intuitive idea of why multigraded lex is helpful, we think of
<span class="math inline">\(a\)</span>, <span
class="math inline">\(b\)</span>, and <span
class="math inline">\(x\)</span> as corresponding to variables in some
engineering problem which represent quantities which are <em>known</em>
and <span class="math inline">\(y\)</span> to be <em>unknown</em>. The
fact that <span class="math inline">\(a\)</span>, <span
class="math inline">\(b\)</span> and <span
class="math inline">\(x\)</span> are in the top level indicates that we
are very interested in solving for <span
class="math inline">\(y\)</span> in terms of <span
class="math inline">\(a\)</span>, <span
class="math inline">\(b\)</span>, and <span
class="math inline">\(x\)</span>, but are not willing to solve for, say
<span class="math inline">\(x\)</span>, in terms of expressions
involving <span class="math inline">\(y\)</span>.</p>
<p>This situation is so common that we provide the commands
<code>SetKnowns</code> and <code>SetUnknowns</code>. The above ordering
would be obtained after setting</p>
<pre><code>SetKnowns[a,b,x];
SetUnknowns[y];</code></pre>
<h2 data-number="6.10"
id="a-complete-example-the-partially-prescribed-matrix-inverse-problem"><span
class="header-section-number">6.10</span> A Complete Example: the
partially prescribed matrix inverse problem</h2>
<p>This is a type of problem known as a <em>matrix completion
problem</em>. This particular one was suggested by Hugo Woerdeman. We
are grateful to him for discussions.</p>
<p><strong>Problem:</strong> <em>Given matrices <span
class="math inline">\(a\)</span>, <span
class="math inline">\(b\)</span>, <span
class="math inline">\(c\)</span>, and <span
class="math inline">\(d\)</span>, we wish to determine under what
conditions there exists matrices x, y, z, and w such that the block
matrices</em></p>
<p><span class="math display">\[\begin{bmatrix} a &amp; x \\ y &amp; b
\end{bmatrix}
  \qquad
  \begin{bmatrix} w &amp; c \\ d &amp; z \end{bmatrix}\]</span></p>
<p><em>are inverses of each other. Also, we wish to find formulas for
<span class="math inline">\(x\)</span>, <span
class="math inline">\(y\)</span>, <span
class="math inline">\(z\)</span>, and <span
class="math inline">\(w\)</span>.</em></p>
<p>This problem was solved in a paper by W.W. Barrett, C.R. Johnson, M.
E. Lundquist and H. Woerderman [BJLW] where they showed it splits into
several cases depending upon which of <span
class="math inline">\(a\)</span>, <span
class="math inline">\(b\)</span>, <span class="math inline">\(c\)</span>
and <span class="math inline">\(d\)</span> are invertible. In our
example, we assume that <span class="math inline">\(a\)</span>, <span
class="math inline">\(b\)</span>, <span class="math inline">\(c\)</span>
and <span class="math inline">\(d\)</span> are invertible and discover
the result which they obtain in this case.</p>
<p>First we set the matrices <span class="math inline">\(a\)</span>,
<span class="math inline">\(b\)</span>, <span
class="math inline">\(c\)</span>, and <span
class="math inline">\(d\)</span> and their inverses as <em>knowns</em>
and <span class="math inline">\(x\)</span>, <span
class="math inline">\(y\)</span>, <span
class="math inline">\(w\)</span>, and <span
class="math inline">\(z\)</span> as unknowns:</p>
<pre><code>SetKnowns[a, inv[a], b, inv[b], c, inv[c], d, inv[d]];
SetUnknowns[{z}, {x, y, w}];</code></pre>
<p>Note that the graded ordering of the unknowns means that we care more
about solving for <span class="math inline">\(x\)</span>, <span
class="math inline">\(y\)</span> and <span
class="math inline">\(w\)</span> than for <span
class="math inline">\(z\)</span>.</p>
<p>Then we define the relations we are interested in, which are obtained
after multiplying the two block matrices on both sides and equating to
identity</p>
<pre><code>A = {{a, x}, {y, b}}
B = {{w, c}, {d, z}}

rels = {
  NCDot[A, B] - IdentityMatrix[2],
  NCDot[B, A] - IdentityMatrix[2]
} // Flatten</code></pre>
<p>We use <code>Flatten</code> to reduce the matrix relations to a
simple list of relations. The resulting relations in this case are:</p>
<pre class="output"><code>rels = {-1+a**w+x**d, a**c+x**z, b**d+y**w, -1+b**z+y**c,
        -1+c**y+w**a, c**b+w**x, d**a+z**y, -1+d**x+z**b}</code></pre>
<p>After running</p>
<pre><code>NCMakeGB[rels, 8] // ColumnForm</code></pre>
<p>we obtain the Gröbner basis:</p>
<pre class="output"><code>x -&gt; inv[d]-inv[d]**z**b
y -&gt; inv[c]-b**z**inv[c]
w -&gt; inv[a]**inv[d]**z**b**d
z**b**z -&gt; z+d**a**c
c**b**z**inv[c]**inv[a] -&gt; inv[a]**inv[d]**z**b**d
inv[c]**inv[a]**inv[d]**z**b -&gt; b**z**inv[c]**inv[a]**inv[d]
inv[d]**z**b**d**a -&gt; a**c**b**z**inv[c]
z**b**d**a**c -&gt; d**a**c**b**z
z**inv[c]**inv[a]**inv[d]**inv[b] -&gt; inv[b]**inv[c]**inv[a]**inv[d]**z
z**inv[c]**inv[a]**inv[d]**z -&gt; inv[b]+inv[b]**inv[c]**inv[a]**inv[d]**z
d**a**c**b**z**inv[c] -&gt; z**b**d**a</code></pre>
<p>after seven iterations. The first four relations</p>
<p><span class="math display">\[\begin{aligned}
    x &amp;= d^{-1}-d^{-1} \, z \, b \\
    y &amp;= c^{-1}-b \, z \, c^{-1} \\
    w &amp;= a^{-1} \, d^{-1}  \, z \, b \, d \\
    z \, b \, z &amp;= z + d \, a \, c
\end{aligned}\]</span></p>
<p>are the solutions we are looking for, which states that one can find
<span class="math inline">\(x\)</span>, <span
class="math inline">\(y\)</span>, <span
class="math inline">\(z\)</span>, and <span
class="math inline">\(w\)</span> such that the matrices above are
inverses of each other if and only if <span class="math inline">\(z \, b
\, z = z + d \, a \, c\)</span>. The first three relations gives
formulas for <span class="math inline">\(x\)</span>, <span
class="math inline">\(y\)</span> and <span
class="math inline">\(w\)</span> in terms of <span
class="math inline">\(z\)</span>.</p>
<p>A variety of scenarios can be quickly investigated under different
assumptions. For example, say that <span
class="math inline">\(c\)</span> is not invertible. Is it still possible
to solve the problem? One solution is obtained with the ordering implied
by</p>
<pre><code>SetKnowns[a, inv[a], b, inv[b], c, d, inv[d]];
SetUnknowns[{y}, {z, w, x}];</code></pre>
<p>In this case</p>
<pre><code>NCMakeGB[rels, 8] // ColumnForm</code></pre>
<p>produces the Gröbner basis:</p>
<pre class="output"><code>z -&gt; inv[b]-inv[b]**y**c
w -&gt; inv[a]-c**y**inv[a]
x -&gt; a**c**y**inv[a]**inv[d]
y**c**y -&gt; y+b**d**a
c**y**inv[a]**inv[d]**inv[b] -&gt; inv[a]**inv[d]**inv[b]**y**c
d**a**c**y**inv[a] -&gt; inv[b]**y**c**b**d
inv[d]**inv[b]**y**c**b -&gt; a**c**y**inv[a]**inv[d]
y**c**b**d**a -&gt; b**d**a**c**y
y**inv[a]**inv[d]**inv[b]**y**c -&gt; 1+y**inv[a]**inv[d]**inv[b]</code></pre>
<p>after five iterations. Once again, the first four relations</p>
<p><span class="math display">\[\begin{aligned}
    z &amp;= b^{-1}-b^{-1} \, y \, c \\
    w &amp;= a^{-1}-c \, y \, a^{-1} \\
    x &amp;= a \, c \, y \, a^{-1} \, d^{-1} \\
    y \, c \, y &amp;= y+b \, d \, a
\end{aligned}\]</span></p>
<p>provide formulas, this time for <span
class="math inline">\(z\)</span>, <span
class="math inline">\(w\)</span>, and <span
class="math inline">\(z\)</span> in terms of <span
class="math inline">\(y\)</span> satisfying <span
class="math inline">\(y \, c \, y = y+b \, d \, a\)</span>. Note that
these formulas do not involve <span
class="math inline">\(c^{-1}\)</span> since <span
class="math inline">\(c\)</span> is no longer assumed invertible.</p>
<h2 data-number="6.11"
id="AdvancedProcessingOfRationalExpressions"><span
class="header-section-number">6.11</span> Advanced Processing of
Rational Expressions</h2>
<p>Consider once again the task of simplifying the nc rational
expression</p>
<pre><code>expr = inv[1-x-y**inv[1-x]**y] - 1/2 (inv[1-x+y]+inv[1-x-y])</code></pre>
<p>considered before in <a
href="#SimplifyingRationalExpressions">Simplifying Rational
Expressions</a>. We will use this expression to illustrate how nc
rational expressions can be manipulated at a lower level, giving
advanced users more control of the conversion process to and from the
internal <a href="#NCPoly">NCPoly</a> representation.</p>
<p>The key functionality is provided by the functions <a
href="#NCMonomialOrder">NCMonomialOrder</a> and <a
href="#NCRationalToNCPoly">NCRationalToNCPoly</a>. <a
href="#NCMonomialOrder">NCMonomialOrder</a> provides the same
functionality as <a href="#SetMonomialOrder">SetMonomialOrder</a>, but
instead of setting the ordering globally, it returns an array
representing the ordering. For example,</p>
<pre><code>order = NCMonomialOrder[x, y]</code></pre>
<p>produces the array</p>
<pre><code>{{x},{y}}</code></pre>
<p>which represents the ordering <span class="math inline">\(x \ll
y\)</span>.</p>
<p>With a (preliminary) ordering in hand one can invoke <a
href="#NCRationalToNCPoly">NCRationalToNCPoly</a> as in</p>
<pre><code>{rels, vars, rules, labels} = NCRationalToNCPoly[expr, order];</code></pre>
<p>This function produces four lists as outputs:</p>
<p>The first, <code>rels</code>, is a list of <code>NCPoly</code>
objects representing the original expression and some additional
relations that were automatically generated. We will inspect
<code>rels</code> later.</p>
<p>The second, <code>vars</code>, is a list of variables that represent
the ordering used in the construction of the polynomials in
<code>rel</code>. In this example,</p>
<pre class="output"><code>vars = {{x}, {y}, {rat135, rat136, rat137, rat138}} </code></pre>
<p>which corresponds to the ordering</p>
<p><span class="math display">\[x \ll y \ll rat135 &lt; rat136 &lt;
rat137 &lt; rat138\]</span></p>
<p>In this case, the variables <code>rat135</code>, <code>rat136</code>,
<code>rat137</code>, <code>rat138</code> were automatically created and
assigned an ordering by <code>NCRationalToNCPoly</code>.</p>
<blockquote>
<p>It is unlikely that your variables will be assigned the same suffixes
<code>135</code> through <code>138</code>. Those suffixes were chosen by
Mathematica to make these variables unique in the global context, and
hence depend on a multitude of factors that can only be determined at
the time of execution.</p>
</blockquote>
<p>As with <a href="#SetMonomialOrder">SetMonomialOrder</a> and <a
href="#NCMakeGB">NCMakeGB</a>, rational terms can be explicitly added to
the ordering for finer control. For example, calling
<code>NCRationalToNCPoly</code> with</p>
<pre class="output"><code>order = NCMonomialOrder[x,y,inv[1-x],{inv[1-x+y],inv[1-x-y]}];</code></pre>
<p>would have produced</p>
<pre class="output"><code>vars = {{x}, {y}, {rat135}, {rat136, rat137}, {rat138}} </code></pre>
<p>which corresponds to the ordering</p>
<p><span class="math display">\[x \ll y \ll rat135 \ll rat136 &lt;
rat137 \ll rat138\]</span></p>
<p>The third is a list of rules relating the new variables with rational
terms appearing in the original expression <code>expr</code>. In this
example</p>
<pre class="output"><code>rules = {rat135 -&gt; inv[1-x], rat136 -&gt; inv[1-x-y],
         rat137 -&gt; inv[1-x+y], rat138 -&gt; inv[1-x-y**rat135**y]}</code></pre>
<p>Finally, the fourth is a list of labels that is used for printing or
displaying</p>
<pre class="output"><code>labels = {{x}, {y}, {inv[1-x], inv[1-x-y], inv[1-x+y],
inv[1-x-y**inv[1-x]**y]}} </code></pre>
<p>as used by <code>NCMakeGB</code> and <code>NCPolyDisplay</code>.</p>
<p>The relations in <code>rels</code> can be visualized by using
<code>NCPolyToNC</code>. For example,</p>
<pre><code>NCPolyToNC[#, vars] &amp; /@ rels // ColumnForm</code></pre>
<p>produces</p>
<pre class="output"><code>rat138-rat136/2-rat137/2 
rat135-rat135**x-1
rat135-x**rat135-1
rat136-rat136**x-rat136**y-1
rat136-x**rat136-y**rat136-1
rat137-rat137**x+rat137**y-1
rat137-x**rat137+y**rat137-1
rat138-rat138**x-rat138**y**rat135**y-1
rat138-x**rat138-y**rat135**y**rat138-1</code></pre>
<p>The first entry is simply the original <code>expr</code> in which
every rational expression has been substituted by a new variable. The
same could be obtained by applying reverse <code>rules</code> and
applying it repeatedly</p>
<pre><code>NCReplaceRepeated[expr, Reverse /@ rules]</code></pre>
<p>The remaining entries are polynomials encoding the rational
expressions that have been substituted by new variables. For example,
the first two additional relations,</p>
<pre class="output"><code>rat135-rat135**x-1
rat135-x**rat135-1</code></pre>
<p>correspond to the assertion that <code>rat153 == inv[1-x]</code>, and
so on.</p>
<p>Equipped with a set of polynomial relations encoding the rational
expression <code>expr</code> one can calculated a Gröebner basis by
calling the low-level implementation <a
href="#NCPolyGroebner">NCPolyGroebner</a>. In this example, calling</p>
<pre><code>{basis, tree} = NCPolyGroebner[Rest[rels], 4, Labels -&gt; labels];</code></pre>
<p>produces the output</p>
<pre class="output"><code>* * * * * * * * * * * * * * * *
* * *   NCPolyGroebner    * * *
* * * * * * * * * * * * * * * *
* Monomial order: x&lt;&lt;y&lt;&lt;inv[1-x]&lt;inv[1-x-y]&lt;inv[1-x+y]&lt;inv[1-x-y**inv[1-x]**y]
* Reduce and normalize initial set
&gt; Initial set could not be reduced
* Computing initial set of obstructions
&gt; MAJOR Iteration 1, 10 polys in the basis, 12 obstructions
&gt; MAJOR Iteration 2, 10 polys in the basis, 6 obstructions
&gt;  Found Groebner basis with 9 polynomials
* * * * * * * * * * * * * * * * </code></pre>
<p>Note the use of <code>labels</code> to pretty print the monomial
ordering. The resulting basis can be visualized once again using the
<code>labels</code></p>
<pre><code>NCPolyToNC[#, labels] &amp; /@ basis // ColumnForm</code></pre>
<p>which produces</p>
<pre class="output"><code>1-inv[1-x]+inv[1-x]**x
1-inv[1-x]+x**inv[1-x]
1-inv[1-x-y]+inv[1-x-y]**x+inv[1-x-y]**y
1-inv[1-x-y]+x**inv[1-x-y]+y**inv[1-x-y]
-1+inv[1-x+y]-inv[1-x+y]**x+inv[1-x+y]**y
-1+inv[1-x+y]-x**inv[1-x+y]+y**inv[1-x+y]
1/2 inv[1-x-y]+1/2 inv[1-x+y]-inv[1-x+y]**inv[1-x-y]+inv[1-x+y]**x**inv[1-x-y]
1/2 inv[1-x-y]+1/2 inv[1-x+y]-inv[1-x-y]**inv[1-x+y]+inv[1-x-y]**x**inv[1-x+y]}
-1/2 inv[1-x-y]-1/2 inv[1-x+y]+inv[1-x-y**inv[1-x]**y]</code></pre>
<p>The original expression <code>expr</code> can then be
<em>reduced</em> by the above basis by calling</p>
<pre><code>NCPolyReduce[rels[[1]], basis]</code></pre>
<p>which produces <code>0</code>, as expected.</p>
<p>The above process is conveniently automated by <a
href="#NCMakeGB">NCMakeGB</a>, but advanced users might still want to
take advantage of the increased speed of directly processing
<code>NCPoly</code>s by manually performing the conversion from a
rational statement to a polynomial statement. See the detailed
documentation of the package <a href="#NCPoly">NCPoly</a> for more
details.</p>
<h1 data-number="7" id="SemidefiniteProgramming"><span
class="header-section-number">7</span> Semidefinite Programming</h1>
<p>If you want a living version of this chapter just run the notebook
<code>NC/DEMOS/4_SemidefiniteProgramming.nb</code>.</p>
<p>There are two different packages for solving semidefinite
programs:</p>
<ul>
<li><p><a href="#PackageSDP"><code>SDP</code></a> provides a template
algorithm that can be customized to solve semidefinite programs with
special structure. Users can provide their own functions to evaluate the
primal and dual constraints and the associated Newton system. A built in
solver along conventional lines, working on vector variables, is
provided by default. It does not require NCAlgebra to run.</p></li>
<li><p><a href="#PackageNCSDP"><code>NCSDP</code></a> coordinates with
NCAlgebra to handle matrix variables, allowing constraints, etc, to be
entered directly as noncommutative expressions.</p></li>
</ul>
<h2 data-number="7.1"
id="semidefinite-programs-in-matrix-variables"><span
class="header-section-number">7.1</span> Semidefinite Programs in Matrix
Variables</h2>
<p>The package <a href="#PackageNCSDP">NCSDP</a> allows the symbolic
manipulation and numeric solution of semidefinite programs.</p>
<p>After loading NCAlgebra, the package NCSDP must be loaded using:</p>
<pre><code>&lt;&lt; NCSDP`</code></pre>
<p>Semidefinite programs consist of symbolic noncommutative expressions
representing inequalities and a list of rules for data replacement. For
example the semidefinite program: <span class="math display">\[
\begin{aligned}
\min_Y \quad &amp; &lt;I,Y&gt; \\
\text{s.t.} \quad &amp; A Y + Y A^T + I \preceq 0 \\
            &amp; Y \succeq 0
\end{aligned}
\]</span> can be solved by defining the noncommutative expressions</p>
<pre><code>SNC[a, y];
obj = {-1};
ineqs = {a ** y + y ** tp[a] + 1, -y};</code></pre>
<p>The inequalities are stored in the list <code>ineqs</code> in the
form of noncommutative linear polyonomials in the variable
<code>y</code> and the objective function constains the symbolic
coefficients of the inner product, in this case <code>-1</code>. The
reason for the negative signs in the objective as well as in the second
inequality is that semidefinite programs are expected to be cast in the
following <em>canonical form</em>: <span class="math display">\[
\begin{aligned}
  \max_y \quad &amp; &lt;b,y&gt; \\
  \text{s.t.} \quad &amp; f(y) \preceq 0
\end{aligned}
\]</span> or, equivalently: <span class="math display">\[
\begin{aligned}
  \max_y \quad &amp; &lt;b,y&gt; \\
  \text{s.t.} \quad &amp; f(y) + s = 0, \quad s \succeq 0
\end{aligned}
\]</span></p>
<p>Semidefinite programs can be visualized using <a
href="#NCSDPForm"><code>NCSDPForm</code></a> as in:</p>
<pre><code>vars = {y};
NCSDPForm[ineqs, vars, obj]</code></pre>
<p>The above commands produce a formatted output similar to the ones
shown above.</p>
<p>In order to obtaining a numerical solution for an instance of the
above semidefinite program one must provide a list of rules for data
substitution. For example:</p>
<pre><code>A = {{0, 1}, {-1, -2}};
data = {a -&gt; A};</code></pre>
<p>Equipped with the above list of rules representing a problem instance
one can load <a
href="#PackageSDPSylvester"><code>SDPSylvester</code></a> and use
<code>NCSDP</code> to create a problem instance as follows:</p>
<pre><code>{abc, rules} = NCSDP[ineqs, vars, obj, data];</code></pre>
<p>The resulting <code>abc</code> and <code>rules</code> objects are
used for calculating the numerical solution using <a
href="#SDPSolve"><code>SDPSolve</code></a>. The command:</p>
<pre><code>&lt;&lt; SDPSylvester`
{Y, X, S, flags} = SDPSolve[abc, rules];</code></pre>
<p>produces an output like the folowing:</p>
<pre><code>Problem data:
* Dimensions (total):
  - Variables             = 4
  - Inequalities          = 2
* Dimensions (detail):
  - Variables             = {{2,2}}
  - Inequalities          = {2,2}
Method:
* Method                  = PredictorCorrector
* Search direction        = NT
Precision:
* Gap tolerance           = 1.*10^(-9)
* Feasibility tolerance   = 1.*10^(-6)
* Rationalize iterates    = False
Other options:
* Debug level             = 0

 K     &lt;B, Y&gt;         mu  theta/tau      alpha     |X S|2    |X S|oo  |A* X-B|   |A Y+S-C|
-------------------------------------------------------------------------------------------
 1  1.638e+00  1.846e-01  2.371e-01  8.299e-01  1.135e+00  9.968e-01  9.868e-16  2.662e-16
 2  1.950e+00  1.971e-02  2.014e-02  8.990e-01  1.512e+00  9.138e-01  2.218e-15  2.937e-16
 3  1.995e+00  1.976e-03  1.980e-03  8.998e-01  1.487e+00  9.091e-01  1.926e-15  3.119e-16
 4  2.000e+00  9.826e-07  9.826e-07  9.995e-01  1.485e+00  9.047e-01  8.581e-15  2.312e-16
 5  2.000e+00  4.913e-10  4.913e-10  9.995e-01  1.485e+00  9.047e-01  1.174e-14  4.786e-16
-------------------------------------------------------------------------------------------
* Primal solution is not strictly feasible but is within tolerance
(0 &lt;= max eig(A* Y - C) = 8.06666*10^-10 &lt; 1.*10^-6 )
* Dual solution is within tolerance
(|| A X - B || = 1.96528*10^-9 &lt; 1.*10^-6)
* Feasibility radius = 0.999998
(should be less than 1 when feasible)</code></pre>
<p>The output variables <code>Y</code> and <code>S</code> are the
<em>primal</em> solutions and <code>X</code> is the <em>dual</em>
solution.</p>
<p>A symbolic dual problem can be calculated easily using <a
href="#NCSDPDual"><code>NCSDPDual</code></a>:</p>
<pre><code>{dIneqs, dVars, dObj} = NCSDPDual[ineqs, vars, obj];</code></pre>
<p>The dual program for the example problem above is: <span
class="math display">\[
\begin{aligned}
  \max_x \quad &amp; &lt;c,x&gt; \\
  \text{s.t.} \quad &amp; f^*(x) + b = 0, \quad x \succeq 0
\end{aligned}
\]</span> In the case of the above problem the dual program is <span
class="math display">\[
\begin{aligned}
\max_{X_1, X_2} \quad &amp; &lt;I,X_1&gt; \\
\text{s.t.} \quad &amp; A^T X_1 + X_1 A -X_2 - I = 0 \\
            &amp; X_1 \succeq 0, \\
        &amp; X_2 \succeq 0
\end{aligned}
\]</span> which can be visualized using <a
href="#NCSDPDualForm"><code>NCSDPDualForm</code></a> using:</p>
<pre><code>NCSDPDualForm[dIneqs, dVars, dObj]</code></pre>
<h2 data-number="7.2"
id="semidefinite-programs-in-vector-variables"><span
class="header-section-number">7.2</span> Semidefinite Programs in Vector
Variables</h2>
<p>The package <a href="#PackageSDP">SDP</a> provides a crude and not
very efficient way to define and solve semidefinite programs in standard
form, that is vectorized. You do not need to load <code>NCAlgebra</code>
if you just want to use the semidefinite program solver. But you still
need to load <code>NC</code> as in:</p>
<pre><code>&lt;&lt; NC`
&lt;&lt; SDP`</code></pre>
<p>Semidefinite programs are optimization problems of the form: <span
class="math display">\[
\begin{aligned}
  \max_{y, S} \quad &amp; b^T y \\
  \text{s.t.} \quad &amp; A y + S = c \\
                    &amp; S \succeq 0
\end{aligned}
\]</span> where <span class="math inline">\(S\)</span> is a symmetric
positive semidefinite matrix and <span class="math inline">\(y\)</span>
is a vector of decision variables.</p>
<p>A user can input the problem data, the triplet <span
class="math inline">\((A, b, c)\)</span>, or use the following
convenient methods for producing data in the proper format.</p>
<p>For example, problems can be stated as: <span class="math display">\[
\begin{aligned}
  \min_y \quad &amp; f(y), \\
  \text{s.t.} \quad &amp; G(y) \succeq 0
\end{aligned}
\]</span> where <span class="math inline">\(f(y)\)</span> and <span
class="math inline">\(G(y)\)</span> are affine functions of the vector
of variables <span class="math inline">\(y\)</span>.</p>
<p>Here is a simple example:</p>
<pre><code>y = {y0, y1, y2};
f = y2;
G = {y0 - 2, {{y1, y0}, {y0, 1}}, {{y2, y1}, {y1, 1}}};</code></pre>
<p>The list of constraints in <code>G</code> is to be interpreted as:
<span class="math display">\[
\begin{aligned}
  y_0 - 2 \geq 0, \\
  \begin{bmatrix} y_1 &amp; y_0 \\ y_0 &amp; 1 \end{bmatrix} \succeq 0,
\\
  \begin{bmatrix} y_2 &amp; y_1 \\ y_1 &amp; 1 \end{bmatrix} \succeq 0.
\end{aligned}
\]</span> The function <a
href="#SDPMatrices"><code>SDPMatrices</code></a> convert the above
symbolic problem into numerical data that can be used to solve an
SDP.</p>
<pre><code>abc = SDPMatrices[f, G, y]</code></pre>
<p>All required data, that is <span class="math inline">\(A\)</span>,
<span class="math inline">\(b\)</span>, and <span
class="math inline">\(c\)</span>, is stored in the variable
<code>abc</code> as Mathematica’s sparse matrices. Their contents can be
revealed using the Mathematica command <code>Normal</code>.</p>
<pre><code>Normal[abc]</code></pre>
<p>The resulting SDP is solved using <a
href="#SDPSolve"><code>SDPSolve</code></a>:</p>
<pre><code>{Y, X, S, flags} = SDPSolve[abc];</code></pre>
<p>The variables <code>Y</code> and <code>S</code> are the
<em>primal</em> solutions and <code>X</code> is the <em>dual</em>
solution. Detailed information on the computed solution is found in the
variable <code>flags</code>.</p>
<p>The package <code>SDP</code> is built so as to be easily overloaded
with more efficient or more structure functions. See for example <a
href="#PackageSDPFlat">SDPFlat</a> and <a
href="#PackageSDPSylvester">SDPSylvester</a>.</p>
<h1 data-number="8" id="TeX"><span
class="header-section-number">8</span> Pretty Output with Notebooks and
 </h1>
<p>If you want a living version of this chapter just run the notebook
<code>NC/DEMOS/5_PrettyOutput.nb</code>.</p>
<p><code>NCAlgebra</code> comes with several utilities for beautifying
expressions which are output. <a
href="#PackageNCTeXForm"><code>NCTeXForm</code></a> converts NC
expressions into . <a href="#PackageNCTeX"><code>NCTeX</code></a> goes a
step further and compiles the results expression in  and produces a PDF
that can be embedded in notebooks of used on its own.</p>
<h2 data-number="8.1" id="Pretty_Output"><span
class="header-section-number">8.1</span> Pretty Output</h2>
<p>In a Mathematica notebook session the package <a
href="#PackageNCOutput">NCOutput</a> can be used to control how nc
expressions are displayed. <code>NCOutput</code> does not alter the
internal representation of nc expressions, just the way they are
displayed on the screen.</p>
<p>The function <a href="#NCSetOutput">NCSetOutput</a> can be used to
set the display options. For example:</p>
<pre><code>NCSetOutput[tp -&gt; False, inv -&gt; True];</code></pre>
<p>makes the expression</p>
<pre><code>expr = inv[tp[a] + b]</code></pre>
<p>be displayed as <span class="math display">\[
(\mathrm{tp[a]} + \mathrm{b})^{-1}
\]</span> Conversely</p>
<pre><code>NCSetOutput[tp -&gt; True, inv -&gt; False];</code></pre>
<p>makes <code>expr</code> be displayed as <span class="math display">\[
\mathrm{inv}\mathrm{[}\mathrm{a}^T + \mathrm{b}\mathrm{]}
\]</span></p>
<p>The default settings are</p>
<pre><code>NCSetOutput[tp -&gt; True, inv -&gt; True];</code></pre>
<p>which makes <code>expr</code> be displayed as <span
class="math display">\[
(\mathrm{a}^\mathrm{T} + \mathrm{b})^{-1}
\]</span> The complete set of options and their default values are:</p>
<ul>
<li><code>NonCommutativeMultiply</code> (<code>False</code>): If
<code>True</code> <code>x**y</code> is displayed as ‘<span
class="math inline">\(\mathrm{x} \bullet \mathrm{y}\)</span>’;</li>
<li><code>tp</code> (<code>True</code>): If <code>True</code>
<code>tp[x]</code> is displayed as ‘<span
class="math inline">\(\mathrm{x}^\mathrm{T}\)</span>’;</li>
<li><code>inv</code> (<code>True</code>): If <code>True</code>
<code>inv[x]</code> is displayed as ‘<span
class="math inline">\(\mathrm{x}^{-1}\)</span>’;</li>
<li><code>aj</code> (<code>True</code>): If <code>True</code>
<code>aj[x]</code> is displayed as ‘<span
class="math inline">\(\mathrm{x}^*\)</span>’;</li>
<li><code>co</code> (<code>True</code>): If <code>True</code>
<code>co[x]</code> is displayed as ‘<span
class="math inline">\(\bar{\mathrm{x}}\)</span>’;</li>
<li><code>rt</code> (<code>True</code>): If <code>True</code>
<code>rt[x]</code> is displayed as ‘<span
class="math inline">\(\mathrm{x}^{1/2}\)</span>’.</li>
</ul>
<p>The special symbol <code>All</code> can be used to set all options to
<code>True</code> or <code>False</code>, as in</p>
<pre><code>NCSetOutput[All -&gt; True];</code></pre>
<h2 data-number="8.2" id="Using_NCTeX"><span
class="header-section-number">8.2</span> Using NCTeX</h2>
<p>You can load NCTeX using the following command</p>
<pre><code>&lt;&lt; NC` 
&lt;&lt; NCTeX`</code></pre>
<p><code>NCTeX</code> does not need <code>NCAlgebra</code> to work. You
may want to use it even when not using NCAlgebra. It uses <a
href="#PackageNCRun"><code>NCRun</code></a>, which is a replacement for
Mathematica’s Run command to run <code>pdflatex</code>,
<code>latex</code>, <code>divps</code>, etc.</p>
<p><strong>WARNING:</strong> Mathematica does not come with LaTeX,
dvips, etc. The package <code>NCTeX</code> does not install these
programs but rather assumes that they have been previously installed and
are available at the user’s standard shell. Use the <code>Verbose</code>
<a href="#NCTeX_Options">option</a> to troubleshoot installation
problems.</p>
<p>With <code>NCTeX</code> loaded you simply type
<code>NCTeX[expr]</code> and your expression will be converted to a PDF
image which, by default, appears in your notebook after being processed
by <code>LaTeX</code>. See <a href="#NCTeX_Options">options</a> for
information on how to change this behavior to display the PDF on a
separate window.</p>
<p>For example:</p>
<pre><code>expr = 1 + Sin[x + (y - z)/Sqrt[2]];
NCTeX[expr]</code></pre>
<p>produces</p>
<p><span class="math inline">\(1 + \sin \left ( x + \frac{y -
z}{\sqrt{2}} \right )\)</span></p>
<p>If <code>NCAlgebra</code> is not loaded then <code>NCTeX</code> uses
the built in <code>TeXForm</code> to produce the LaTeX expressions. If
<code>NCAlgebra</code> is loaded, <code>NCTeXForm</code> is used. See <a
href="#NCTeXForm">NCTeXForm</a> for details.</p>
<p>Here is another example:</p>
<pre><code>expr = {{1 + Sin[x + (y - z)/2 Sqrt[2]], x/y}, {z, n Sqrt[5]}};
NCTeX[expr]</code></pre>
<p>that produces</p>
<p><span class="math inline">\(\left( \begin{array}{cc}  \sin
\left(x+\frac{y-z}{\sqrt{2}}\right)+1 &amp;  \frac{x}{y} \\  z &amp;
\sqrt{5} n \\ \end{array} \right)\)</span></p>
<p>In some cases Mathematica will have difficulty displaying certain PDF
files. When this happens <code>NCTeX</code> will span a PDF viewer so
that you can look at the formula. If your PDF viewer does not pop up
automatically you can force it by passing the following option to
<code>NCTeX</code>:</p>
<pre><code>expr = {{1 + Sin[x + (y - z)/2 Sqrt[2]], x/y}, {z, n Sqrt[5]}};
NCTeX[exp, DisplayPDF -&gt; True]</code></pre>
<p>Here is another example were the current version of Mathematica fails
to import the PDF:</p>
<pre><code>expr = Table[x^i y^(-j) , {i, 0, 10}, {j, 0, 30}];
NCTeX[expr, DisplayPDF -&gt; True]</code></pre>
<p>You can also suppress Mathematica from importing the PDF altogether
as well. This and other options are covered in detail in the next
section.</p>
<h3 data-number="8.2.1" id="NCTeX_Options"><span
class="header-section-number">8.2.1</span> NCTeX Options</h3>
<p>The following command:</p>
<pre><code>expr = {{1 + Sin[x + (y - z)/2 Sqrt[2]], x/y}, {z, n Sqrt[5]}};
NCTeX[exp, DisplayPDF -&gt; True, ImportPDF -&gt; False]</code></pre>
<p>uses <code>DisplayPDF -&gt; True</code> to ensure that the PDF viewer
is called and <code>ImportPDF -&gt; False</code> to prevent Mathematica
from displaying the formula inline. In other words, it displays the
formula in the PDF viewer without trying to import the PDF into
Mathematica. The default values for these options when using the
Mathematica notebook interface are:</p>
<ol type="1">
<li><code>DisplayPDF</code> (<code>False</code>)</li>
<li><code>ImportPDF</code> (<code>True</code>)</li>
</ol>
<p>When <code>NCTeX</code> is invoked using the command line interpreter
version of Mathematica the defaults are:</p>
<ol type="1">
<li><code>DisplayPDF</code> (<code>False</code>)</li>
<li><code>ImportPDF</code> (<code>True</code>)</li>
</ol>
<p>Other useful options and their default options are:</p>
<ol type="1">
<li><code>Verbose</code> (<code>False</code>),</li>
<li><code>BreakEquations</code> (<code>True</code>)</li>
<li><code>TeXProcessor</code> (<code>NCTeXForm</code>)</li>
</ol>
<p>Set <code>BreakEquations -&gt; True</code> to use the LaTeX package
<code>beqn</code> to produce nice displays of long equations. Try the
following example:</p>
<pre><code>expr = Series[Exp[x], {x, 0, 20}]
NCTeX[expr]</code></pre>
<p>Use <code>TexProcessor</code> to select your own <code>TeX</code>
converter. If <code>NCAlgebra</code> is loaded then
<code>NCTeXForm</code> is the default. Otherwise Mathematica’s
<code>TeXForm</code> is used.</p>
<p>If <code>Verbose -&gt; True</code> you can see a detailed display of
what is going on behing the scenes. This is very useful for debugging.
For example, try:</p>
<pre><code>expr = BesselJ[2, x]
NCTeX[exp, Verbose -&gt; True]</code></pre>
<p>to produce an output similar to the following one:</p>
<pre><code>* NCTeX - LaTeX processor for NCAlgebra - Version 0.1
&gt; Creating temporary file &#39;/tmp/mNCTeX.tex&#39;...
&gt; Processing &#39;/tmp/mNCTeX.tex&#39;...
&gt; Running &#39;latex -output-directory=/tmp/  /tmp/mNCTeX 1&gt; &quot;/tmp/mNCRun.out&quot; 2&gt; &quot;/tmp/mNCRun.err&quot;&#39;...
&gt; Running &#39;dvips -o /tmp/mNCTeX.ps -E /tmp/mNCTeX 1&gt; &quot;/tmp/mNCRun.out&quot; 2&gt; &quot;/tmp/mNCRun.err&quot;&#39;...
&gt; Running &#39;epstopdf  /tmp/mNCTeX.ps 1&gt; &quot;/tmp/mNCRun.out&quot; 2&gt; &quot;/tmp/mNCRun.err&quot;&#39;...
&gt; Importing pdf file &#39;/tmp/mNCTeX.pdf&#39;...</code></pre>
<p>Locate the files with extension .err as indicated by the verbose run
of NCTeX to diagnose errors.</p>
<p>The remaining options:</p>
<ol type="1">
<li><code>PDFViewer</code> (<code>"open"</code>),</li>
<li><code>LaTeXCommand</code> (<code>"latex"</code>)</li>
<li><code>PDFLaTeXCommand</code> (<code>Null</code>)</li>
<li><code>DVIPSCommand</code> (<code>"dvips"</code>)</li>
<li><code>PS2PDFCommand</code> (<code>"epstopdf"</code>)</li>
</ol>
<p>let you specify the names and, when appropriate, the path, of the
corresponding programs to be used by <code>NCTeX</code>. Alternatively,
you can also directly implement custom versions of</p>
<pre><code>NCRunDVIPS
NCRunLaTeX
NCRunPDFLaTeX
NCRunPDFViewer
NCRunPS2PDF</code></pre>
<p>Those commands are invoked using <code>NCRun</code>. Look at the
documentation for the package <a href="#NCRun">NCRun</a> for more
details.</p>
<h2 data-number="8.3" id="Using_NCTeXForm"><span
class="header-section-number">8.3</span> Using NCTeXForm</h2>
<p><a href="#PackageNCTeXForm"><code>NCTeXForm</code></a> is a
replacement for Mathematica’s <code>TeXForm</code> which adds
definitions allowing it to handle noncommutative expressions. It works
just as <code>TeXForm</code>. <code>NCTeXForm</code> is automatically
loaded with <code>NCAlgebra</code> and is the default  processor for
<code>NCTeX</code>.</p>
<p>Here is an example:</p>
<pre><code>SetNonCommutative[a, b, c, x, y];
exp = a ** x ** tp[b] - inv[c ** inv[a + b ** c] ** tp[y] + d]
NCTeXForm[exp]</code></pre>
<p>produces</p>
<pre><code>a.x.{b}^T-{\left(d+c.{\left(a+b.c\right)}^{-1}.{y}^T\right)}^{-1}</code></pre>
<p>Note that the LaTeX output contains special code so that the
expression looks neat on the screen. You can see the result using
<code>NCTeX</code> to convert the expression to PDF. Try</p>
<pre><code>SetOptions[NCTeX, TeXProcessor -&gt; NCTeXForm];
NCTeX[exp]</code></pre>
<p>to produce</p>
<p><span class="math inline">\(a.x.{b}^T-{\left(d+c.{\left
(a+b.c\right)}^{-1}.{y}^T\right )}^{-1}\)</span></p>
<p><code>NCTeX</code> represents noncommutative products with a dot
(<code>.</code>) in order to distinguish it from its commutative cousin.
We can see the difference in an expression that has both commutative and
noncommutative products:</p>
<pre><code>exp = 2 a ** b - 3 c ** d
NCTeX[exp]</code></pre>
<p>produces</p>
<p><span class="math inline">\(2 \left(a.b\right) - 3 (c.d)\)</span></p>
<p>NCTeXForm handles lists and matrices as well. Here is a list:</p>
<pre><code>exp = {x, tp[x], x + y, x + tp[y], x + inv[y], x ** x}
NCTeX[exp]</code></pre>
<p>and its output:</p>
<p><span class="math inline">\(\{ x, {x}^T, x+y, x+{y}^T, x+{y}^{-1},
x.x \}\)</span></p>
<p>and here is a matrix example:</p>
<pre><code>exp = {{x, y}, {y, z}}
NCTeX[exp]</code></pre>
<p>and its output:</p>
<p><span class="math inline">\(\begin{bmatrix} x &amp; y \\ y &amp; z
\end{bmatrix}\)</span></p>
<p>Here are some more examples:</p>
<pre><code>exp = {{1 + Sin[x + (y - z)/2 Sqrt[2]], x/y}, {z, n Sqrt[5]}}
NCTeX[exp]</code></pre>
<p>produces</p>
<p><span class="math inline">\(\begin{bmatrix}
1+\operatorname{sin}{\left (x+\frac{1}{\sqrt{2}} \left (y-z\right
)\right )} &amp; x {y}^{-1} \\ z &amp; \sqrt{5} n
\end{bmatrix}\)</span></p>
<pre><code>exp = {inv[x + y], inv[x + inv[y]]}
NCTeX[exp]</code></pre>
<p>produces:</p>
<p><span class="math inline">\(\{ {\left (x+y\right )}^{-1}, {\left
(x+{y}^{-1}\right )}^{-1} \}\)</span></p>
<pre><code>exp = {Sin[x], x y, Sin[x] y, Sin[x + y], Cos[gamma], 
       Sin[alpha] tp[x] ** (y - tp[y]), (x + tp[x]) (y ** z), -tp[y], 1/2, 
       Sqrt[2] x ** y}
NCTeX[exp]</code></pre>
<p>produces:</p>
<p><span class="math inline">\(\{ \operatorname{sin}{x}, x y, y
\operatorname{sin}{x}, \operatorname{sin}{\left (x+y\right )},
\operatorname{cos}{\gamma}, \left({x}^T.\left (y-{y}^T\right )\right )
\operatorname{sin}{\alpha}, y z \left (x+{x}^T\right ), -{y}^T,
\frac{1}{2}, \sqrt{2} \left(x.y\right ) \}\)</span></p>
<pre><code>exp = inv[x + tp[inv[y]]]
NCTeX[exp]</code></pre>
<p>produces:</p>
<p><span class="math inline">\({\left (x+{{y}^T}^{-1}\right
)}^{-1}\)</span></p>
<p><code>NCTeXForm</code> does not know as many functions as
<code>TeXForm</code>. In some cases <code>TeXForm</code> will produce
better results. Compare:</p>
<pre><code>exp = BesselJ[2, x]
NCTeX[exp, TeXProcessor -&gt; NCTeXForm]</code></pre>
<p>output:</p>
<p><span class="math inline">\(\operatorname{BesselJ}\left (2, x\right
)\)</span></p>
<p>with</p>
<pre><code>NCTeX[exp, TeXProcessor -&gt; TeXForm]</code></pre>
<p>output:</p>
<p><span class="math inline">\(J_2(x)\)</span></p>
<p>It should be easy to customize <code>NCTeXForm</code> though. Just
overload <code>NCTeXForm</code>. In this example:</p>
<pre><code>NCTeXForm[BesselJ[x_, y_]] := Format[BesselJ[x, y], TeXForm]</code></pre>
<p>makes</p>
<pre><code>NCTeX[exp, TeXProcessor -&gt; NCTeXForm]</code></pre>
<p>produce</p>
<p><span class="math inline">\(J_2(x)\)</span></p>
<h1 data-number="9" id="ReferenceIntroduction"><span
class="header-section-number">9</span> Reference Manual</h1>
<p>The following chapters and sections describes packages inside
<code>NCAlgebra</code>. Detailed instructions for manual installation
are also provided in the section <a href="#ManualInstallation">Manual
Installation</a>.</p>
<p>Packages are automatically loaded unless otherwise noted.</p>
<h2 data-number="9.1" id="ManualInstallation"><span
class="header-section-number">9.1</span> Manual Installation</h2>
<p>Manual installation is no longer necessary nor advisable. As an
alternative to manual installation, consider installing NCAlgebra via
our paclet distribution, as discussed in section <a
href="#InstallingNCAlgebra">Installing NCAlgebra</a>.</p>
<p>For those who do not use paclets, you can download NCAlgebra in one
of the following ways.</p>
<h3 data-number="9.1.1" id="via-git-clone"><span
class="header-section-number">9.1.1</span> Via
<code>git clone</code></h3>
<p>You can clone the repository using git:</p>
<pre><code>git clone https://github.com/NCAlgebra/NC</code></pre>
<p>This will create a directory <code>NC</code> which contains all files
neeeded to run NCAlgebra in any platform.</p>
<p>Cloning allows you to easily upgrade and switch between the various
available releases. If you want to try the latest <em>experimental</em>
version switch to branch <em>devel</em> using:</p>
<pre><code>git checkout devel</code></pre>
<p>If you’re happy with the latest stable release you do not need to do
anything.</p>
<h3 data-number="9.1.2" id="from-the-github-download-button"><span
class="header-section-number">9.1.2</span> From the github download
button</h3>
<p>After you downloaded a zip file from github use your favorite zip
utility to unpack the file <code>NC-master.zip</code> or
<code>NC-devel.zip</code> on your favorite location.</p>
<p><strong>IMPORTANT:</strong> Rename the top directory
<code>NC</code>!</p>
<h3 data-number="9.1.3" id="from-one-of-our-releases"><span
class="header-section-number">9.1.3</span> From one of our releases</h3>
<p>Releases are stable snapshots that you can find at</p>
<p>https://github.com/NCAlgebra/NC/releases</p>
<p><strong>IMPORTANT:</strong> Rename the top directory
<code>NC</code>!</p>
<p>Earlier releases can be downloaded from:</p>
<p>www.math.ucsd.edu/~ncalg</p>
<p>Releases in github are also tagged so you can easily switch from
version to version using git.</p>
<h3 data-number="9.1.4" id="post-download-installation"><span
class="header-section-number">9.1.4</span> Post-download
installation</h3>
<p>All that is needed for NCAlgebra to run is that its top directory,
the <code>NC</code> directory, be on Mathematica’s search path.</p>
<p>If you are on a unix flavored machine (Solaris, Linux, Mac OSX) then
unpacking or cloning in your home directory (<code>~</code>) is all you
need to do.</p>
<p>Otherwise, you may need to add the installation directory to
Mathematica’s search path.</p>
<p><strong>If you are experienced with Mathematica:</strong></p>
<p>Edit the main <em>Mathematica</em> <code>init.m</code> file (not the
one inside the <code>NC</code> directory) to add the name of the
directory which contains the <code>NC</code> folder to the Mathematica
variable <code>$Path</code>, as in:</p>
<pre><code>AppendTo[$Path,&quot;**YOUR_INSTALLATION_DIRECTORY**&quot;];</code></pre>
<p>You can locate your user <code>init.m</code> file by typing:</p>
<pre><code>FileNameJoin[{$UserBaseDirectory, &quot;Kernel&quot;, &quot;init.m&quot;}]</code></pre>
<p>in Mathematica.</p>
<h2 data-number="9.2" id="PackageNC"><span
class="header-section-number">9.2</span> NC</h2>
<p><strong>NC</strong> is a meta package that enables the functionality
of the <em>NCAlgebra suite</em> of non-commutative algebra packages for
Mathematica.</p>
<blockquote>
<p>If you installed the paclet version of NCAlgebra it is not necessary
to load the context <code>NC</code> before loading other
<code>NCAlgebra</code> packages.</p>
<p>Loading the context <code>NC</code> in the paclet version is however
still supported for backward compatibility. It does nothing more than
posting the message:</p>
<pre><code>NC::Directory: You are using a paclet version of NCAlgebra.</code></pre>
</blockquote>
<p>The package can be loaded using <code>Get</code>, as in</p>
<pre><code>&lt;&lt; NC`</code></pre>
<p>or <code>Needs</code>, as in</p>
<pre><code>Needs[&quot;NC`&quot;]</code></pre>
<p>Once <code>NC</code> is loaded you will see a message like</p>
<pre><code>NC::Directory: You are using the version of NCAlgebra which is found in: &quot;/your_home_directory/NC&quot;.</code></pre>
<p>or</p>
<pre><code>NC::Directory: You are using a paclet version of NCAlgebra.</code></pre>
<p>if you installed from our paclet distribution.</p>
<p>You can then proceed to load any other package from the <em>NCAlgebra
suite</em>.</p>
<p>For example you can load the package <code>NCAlgebra</code> using</p>
<pre><code>&lt;&lt; NCAlgebra`</code></pre>
<p>See section <a href="#PackageNCAlgebra">NCAlgebra</a> and <a
href="#PackageNCOptions">NCOptions</a> for more options and details
available while loading <code>NCAlgebra</code>.</p>
<p>The <code>NC::Directory</code> message can be suppressed by using
standard Mathematica message control functions. For example,</p>
<pre><code>Off[NC`NC::Directory]
&lt;&lt; NC`</code></pre>
<p>or</p>
<pre><code>Quiet[&lt;&lt; NC`, NC`NC::Directory]</code></pre>
<p>will load <code>NC</code> quietly. Note that you have to refer to the
message by its fully qualified name <code>NC`NC::Directory</code>
because the context <code>NC</code> is only available after loading the
package.</p>
<h2 data-number="9.3" id="PackageNCAlgebra"><span
class="header-section-number">9.3</span> NCAlgebra</h2>
<p><strong>NCAlgebra</strong> is the main package of the <em>NCAlgebra
suite</em> of non-commutative algebra packages for Mathematica.</p>
<p>The package can be loaded using <code>Get</code>, as in</p>
<pre><code>&lt;&lt; NCAlgebra`</code></pre>
<p>or <code>Needs</code>, as in</p>
<pre><code>Needs[&quot;NCAlgebra`&quot;]</code></pre>
<p>If the option <code>SmallCapSymbolsNonCommutative</code> is
<code>True</code> then <code>NCAlgebra</code> will set all global single
letter small cap symbols as noncommutative. Set <a
href="#PackageNCOptions">NCOptions</a>. If that is not desired, simply
set <code>SmallCapSymbolsNonCommutative</code> to <code>False</code>
before loading <code>NCAlgebra</code>, as in</p>
<pre><code>&lt;&lt; NCOptions`
SetOptions[NCOptions, SmallCapSymbolsNonCommutative -&gt; False]
&lt;&lt; NCAlgebra`</code></pre>
<p>A message will be issued warning users whether any letters have been
set as noncommutative upon loading. Those messages are documented <a
href="#NCAlgebraMessages">here</a>. Users can use Mathematica’s
<code>Quiet</code> and <code>Off</code> if they do not want these
messages to display. For example,</p>
<pre><code>Off[NCAlgebra`NCAlgebra::SmallCapSymbolsNonCommutative]
&lt;&lt; NCAlgebra`</code></pre>
<p>or</p>
<pre><code>&lt;&lt; NCOptions`
SetOptions[NCOptions, SmallCapSymbolsNonCommutative -&gt; False]
Off[NCAlgebra`NCAlgebra::NoSymbolsNonCommutative]
&lt;&lt; NCAlgebra`</code></pre>
<p>will load <code>NCAlgebra</code> without issuing a symbol assignment
message.</p>
<p>Upon loading <code>NCAlgebra</code> for the first time, a large
banner will be shown. If you do not want this banner to be displayed set
the option <a href="#PackageNCOptions"><code>ShowBanner</code></a> to
<code>False</code> before loading, as in</p>
<pre><code>&lt;&lt; NCOptions`
SetOptions[NCOptions, ShowBanner -&gt; False]
&lt;&lt; NCAlgebra`</code></pre>
<p>For example, the following commands will perform a completly quiet
loading of <code>NC</code> <em>and</em> <code>NCAlgebra</code>:</p>
<pre><code>Quiet[&lt;&lt; NC`, NC`NC::Directory];
&lt;&lt; NCOptions`
SetOptions[NCOptions, ShowBanner -&gt; False];
Quiet[&lt;&lt; NCAlgebra`, NCAlgebra`NCAlgebra::SmallCapSymbolsNonCommutative];</code></pre>
<h3 data-number="9.3.1" id="NCAlgebraMessages"><span
class="header-section-number">9.3.1</span> Messages</h3>
<p>One of the following messages will be displayed after loading.</p>
<ul>
<li><code>NCAlgebra::SmallCapSymbolsNonCommutative</code>, if small cap
single letter symbols have been set as noncomutative;</li>
<li><code>NCAlgebra::NoSymbolsNonCommutative</code>, if no symbols have
been set as noncomutative by <code>NCAlgebra</code>.</li>
</ul>
<h3 data-number="9.3.2" id="PackageNCOptions"><span
class="header-section-number">9.3.2</span> NCOptions</h3>
<p>The following <code>options</code> can be set using
<code>SetOptions</code> before loading other packages:</p>
<ul>
<li><code>SmallCapSymbolsNonCommutative</code> (<code>True</code>): If
<code>True</code>, loading <code>NCAlgebra</code> will set all global
single letter small cap symbols as noncommutative;</li>
<li><code>ShowBanner</code> (<code>True</code>): If <code>True</code>, a
banner, when available, will be shown during the first loading of a
package.</li>
<li><code>UseNotation</code> (<code>False</code>): If <code>True</code>
use Mathematica’s package <code>Notation</code> when setting pretty
output in <a href="#NCSetOutput"><code>NCSetOutput</code></a>.</li>
</ul>
<p>For example,</p>
<pre><code>&lt;&lt; NC`
&lt;&lt; NCOptions`
SetOptions[NCOptions, ShowBanner -&gt; False];
&lt;&lt; NCAlgebra`</code></pre>
<p>suppress the NCAlgebra banner that is printed the first time
NCAlgebra is loaded.</p>
<h1 data-number="10" id="ManipulatingNCExpressions"><span
class="header-section-number">10</span> Packages for manipulating NC
expressions</h1>
<h2 data-number="10.1" id="PackageNonCommutativeMultiply"><span
class="header-section-number">10.1</span> NonCommutativeMultiply</h2>
<p><code>NonCommutativeMultiply</code> is the main package that provides
noncommutative functionality to Mathematica’s native
<code>NonCommutativeMultiply</code> bound to the operator
<code>**</code>.</p>
<p>Members are:</p>
<ul>
<li><a href="#aj">aj</a></li>
<li><a href="#co">co</a></li>
<li><a href="#Id">Id</a></li>
<li><a href="#inv">inv</a></li>
<li><a href="#tp">tp</a></li>
<li><a href="#rt">rt</a></li>
<li><a href="#CommutativeQ">CommutativeQ</a></li>
<li><a href="#NonCommutativeQ">NonCommutativeQ</a></li>
<li><a href="#SetCommutative">SetCommutative</a></li>
<li><a href="#SetCommutativeHold">SetCommutativeHold</a></li>
<li><a href="#SetNonCommutative">SetNonCommutative</a></li>
<li><a href="#SetNonCommutativeHold">SetNonCommutativeHold</a></li>
<li><a href="#SetCommutativeFunction">SetCommutativeFunction</a></li>
<li><a
href="#SetNonCommutativeFunction">SetNonCommutativeFunction</a></li>
<li><a href="#SetCommutingOperators">SetCommutingOperators</a></li>
<li><a href="#UnsetCommutingOperators">UnsetCommutingOperators</a></li>
<li><a href="#CommutingOperatorsQ">CommutingOperatorsQ</a></li>
<li><a
href="#NCNonCommutativeSymbolOrSubscriptQ">NCNonCommutativeSymbolOrSubscriptQ</a></li>
<li><a
href="#NCNonCommutativeSymbolOrSubscriptExtendedQ">NCNonCommutativeSymbolOrSubscriptExtendedQ</a></li>
<li><a href="#NCPowerQ">NCPowerQ</a></li>
<li><a href="#Commutative">Commutative</a></li>
<li><a href="#CommuteEverything">CommuteEverything</a></li>
<li><a href="#BeginCommuteEverything">BeginCommuteEverything</a></li>
<li><a href="#EndCommuteEverything">EndCommuteEverything</a></li>
<li><a
href="#ExpandNonCommutativeMultiply">ExpandNonCommutativeMultiply</a></li>
<li><a href="#NCExpandExponents">NCExpandExponents</a></li>
<li><a href="#NCToList">NCToList</a></li>
</ul>
<p>Aliases are:</p>
<ul>
<li><a href="#SNC">SNC</a> for <a
href="#SetNonCommutative">SetNonCommutative</a></li>
<li><a href="#NCExpand">NCExpand</a> for <a
href="#ExpandNonCommutativeMultiply">ExpandNonCommutativeMultiply</a></li>
<li><a href="#NCE">NCE</a> for <a
href="#ExpandNonCommutativeMultiply">ExpandNonCommutativeMultiply</a></li>
</ul>
<h3 data-number="10.1.1" id="aj"><span
class="header-section-number">10.1.1</span> aj</h3>
<p><code>aj[expr]</code> is the adjoint of expression <code>expr</code>.
It is a conjugate linear involution.</p>
<p>See also: <a href="#tp">tp</a>, <a href="#co">co</a>.</p>
<h3 data-number="10.1.2" id="co"><span
class="header-section-number">10.1.2</span> co</h3>
<p><code>co[expr]</code> is the conjugate of expression
<code>expr</code>. It is a linear involution.</p>
<p>See also: <a href="#aj">aj</a>.</p>
<h3 data-number="10.1.3" id="Id"><span
class="header-section-number">10.1.3</span> Id</h3>
<p><code>Id</code> is noncommutative multiplicative identity. Actually
Id is now set equal <code>1</code>.</p>
<h3 data-number="10.1.4" id="inv"><span
class="header-section-number">10.1.4</span> inv</h3>
<p><code>inv[expr]</code> is the 2-sided inverse of expression
<code>expr</code>.</p>
<p>If <code>Options[inv, Distrubute]</code> is <code>False</code> (the
default) then</p>
<pre><code>inv[a**b]</code></pre>
<p>returns <code>inv[a**a]</code>. Conversely, if
<code>Options[inv, Distrubute]</code> is <code>True</code> then it
returns <code>inv[b]**inv[a]</code>.</p>
<h3 data-number="10.1.5" id="rt"><span
class="header-section-number">10.1.5</span> rt</h3>
<p><code>rt[expr]</code> is the root of expression
<code>expr</code>.</p>
<h3 data-number="10.1.6" id="tp"><span
class="header-section-number">10.1.6</span> tp</h3>
<p><code>tp[expr]</code> is the tranpose of expression
<code>expr</code>. It is a linear involution.</p>
<p>See also: <a href="#tp">aj</a>, <a href="#co">co</a>.</p>
<h3 data-number="10.1.7" id="CommutativeQ"><span
class="header-section-number">10.1.7</span> CommutativeQ</h3>
<p><code>CommutativeQ[expr]</code> is <code>True</code> if expression
<code>expr</code> is commutative (the default), and <code>False</code>
if <code>expr</code> is noncommutative.</p>
<p>See also: <a href="#SetCommutative">SetCommutative</a>, <a
href="#SetNonCommutative">SetNonCommutative</a>.</p>
<h3 data-number="10.1.8" id="NonCommutativeQ"><span
class="header-section-number">10.1.8</span> NonCommutativeQ</h3>
<p><code>NonCommutativeQ[expr]</code> is equal to
<code>Not[CommutativeQ[expr]]</code>.</p>
<p>See also: <a href="#CommutativeQ">CommutativeQ</a>.</p>
<h3 data-number="10.1.9" id="SetCommutative"><span
class="header-section-number">10.1.9</span> SetCommutative</h3>
<p><code>SetCommutative[a,b,c,...]</code> sets all the
<code>Symbols</code> <code>a</code>, <code>b</code>, <code>c</code>, …
to be commutative.</p>
<p>See also: <a href="#SetNonCommutative">SetNonCommutative</a>, <a
href="#CommutativeQ">CommutativeQ</a>, <a
href="#NonCommutativeQ">NonCommutativeQ</a>.</p>
<h3 data-number="10.1.10" id="SetCommutativeHold"><span
class="header-section-number">10.1.10</span> SetCommutativeHold</h3>
<p><code>SetCommutativeHold[a,b,c,...]</code> sets all the
<code>Symbols</code> <code>a</code>, <code>b</code>, <code>c</code>, …
to be commutative.</p>
<p><code>SetCommutativeHold</code> has attribute <code>HoldAll</code>
and can be used to set Symbols which have already been assigned a
value.</p>
<p>See also: <a href="#SetNonCommutativeHold">SetNonCommutativeHold</a>,
<a href="#SetCommutative">SetCommutative</a>, <a
href="#SetNonCommutative">SetNonCommutative</a>, <a
href="#CommutativeQ">CommutativeQ</a>, <a
href="#NonCommutativeQ">NonCommutativeQ</a>.</p>
<h3 data-number="10.1.11" id="SetNonCommutative"><span
class="header-section-number">10.1.11</span> SetNonCommutative</h3>
<p><code>SetNonCommutative[a,b,c,...]</code> sets all the
<code>Symbols</code> <code>a</code>, <code>b</code>, <code>c</code>, …
to be noncommutative.</p>
<p>See also: <a href="#SetCommutative">SetCommutative</a>, <a
href="#CommutativeQ">CommutativeQ</a>, <a
href="#NonCommutativeQ">NonCommutativeQ</a>.</p>
<h3 data-number="10.1.12" id="SetNonCommutativeHold"><span
class="header-section-number">10.1.12</span> SetNonCommutativeHold</h3>
<p><code>SetNonCommutativeHold[a,b,c,...]</code> sets all the
<code>Symbols</code> <code>a</code>, <code>b</code>, <code>c</code>, …
to be noncommutative.</p>
<p><code>SetNonCommutativeHold</code> has attribute <code>HoldAll</code>
and can be used to set Symbols which have already been assigned a
value.</p>
<p>See also: <a href="#SetCommutativeHold">SetCommutativeHold</a>, <a
href="#SetCommutative">SetCommutative</a>, <a
href="#CommutativeQ">CommutativeQ</a>, <a
href="#NonCommutativeQ">NonCommutativeQ</a>.</p>
<h3 data-number="10.1.13" id="SetCommutativeFunction"><span
class="header-section-number">10.1.13</span> SetCommutativeFunction</h3>
<p><code>SetCommutativeFunction[f]</code> sets expressions with
<code>Head</code> <code>f</code>, i.e. functions, to be commutative.</p>
<p>By default, expressions in which the <code>Head</code> or any of its
arguments is noncommutative will be considered noncommutative. For
example,</p>
<pre><code>SetCommutative[trace];
a ** b ** trace[a ** b]</code></pre>
<p>evaluates to <code>a ** b ** trace[a ** b]</code> while</p>
<pre><code>SetCommutativeFunction[trace];
a ** b ** trace[a ** b]</code></pre>
<p>evaluates to <code>trace[a ** b] * a ** b</code>.</p>
<p>See also: <a href="#SetCommutative">SetCommutative</a>, <a
href="#SetNonCommutative">SetNonCommutative</a>, <a
href="#CommutativeQ">CommutativeQ</a>, <a
href="#NonCommutativeQ">NonCommutativeQ</a>, <a href="#tr">tr</a>.</p>
<h3 data-number="10.1.14" id="SetNonCommutativeFunction"><span
class="header-section-number">10.1.14</span>
SetNonCommutativeFunction</h3>
<p><code>SetNonCommutativeFunction[f]</code> sets expressions with
<code>Head</code> <code>f</code>, i.e. functions, to be non commutative.
This is only necessary if it has been previously set commutative by <a
href="#SetCommutativeFunction">SetCommutativeFunction</a>.</p>
<p>See also: <a
href="#SetCommutativeFunction">SetCommutativeFunction</a>, <a
href="#SetCommutative">SetCommutative</a>, <a
href="#SetNonCommutative">SetNonCommutative</a>, <a
href="#CommutativeQ">CommutativeQ</a>, <a
href="#NonCommutativeQ">NonCommutativeQ</a>, <a href="#tr">tr</a>.</p>
<h3 data-number="10.1.15" id="SNC"><span
class="header-section-number">10.1.15</span> SNC</h3>
<p><code>SNC</code> is an alias for <code>SetNonCommutative</code>.</p>
<p>See also: <a href="#SetNonCommutative">SetNonCommutative</a>.</p>
<h3 data-number="10.1.16" id="SetCommutingOperators"><span
class="header-section-number">10.1.16</span> SetCommutingOperators</h3>
<p><code>SetCommutingOperators[a,b]</code> will define a rule that
substitute any noncommutative product <code>b ** a</code> by
<code>a ** b</code>, effectively making the pair <code>a</code> and
<code>b</code> commutative. If you want to create a rule to replace
<code>a ** b</code> by <code>b ** a</code> use
<code>SetCommutingOperators[b,a]</code> instead.</p>
<p>See also: <a
href="#UnsetCommutingOperators">UnsetCommutingOperators</a>, <a
href="#CommutingOperatorsQ">CommutingOperatorsQ</a></p>
<h3 data-number="10.1.17" id="UnsetCommutingOperators"><span
class="header-section-number">10.1.17</span>
UnsetCommutingOperators</h3>
<p><code>UnsetCommutingOperators[a,b]</code> remove any rules previously
created by <code>SetCommutingOperators[a,b]</code> or
<code>SetCommutingOperators[b,a]</code>.</p>
<p>See also: <a href="#SetCommutingOperators">SetCommutingOperators</a>,
<a href="#CommutingOperatorsQ">CommutingOperatorsQ</a></p>
<h3 data-number="10.1.18" id="CommutingOperatorsQ"><span
class="header-section-number">10.1.18</span> CommutingOperatorsQ</h3>
<p><code>CommutingOperatorsQ[a,b]</code> returns <code>True</code> if
<code>a</code> and <code>b</code> are commuting operators.</p>
<p>See also: <a href="#SetCommutingOperators">SetCommutingOperators</a>,
<a href="#UnsetCommutingOperators">UnsetCommutingOperators</a></p>
<h3 data-number="10.1.19" id="NCNonCommutativeSymbolOrSubscriptQ"><span
class="header-section-number">10.1.19</span>
NCNonCommutativeSymbolOrSubscriptQ</h3>
<p><code>NCNonCommutativeSymbolOrSubscriptQ[expr]</code> returns
<em>True</em> if <code>expr</code> is an noncommutative symbol or a
noncommutative symbol subscript.</p>
<p>See also: <a
href="#NCNonCommutativeSymbolOrSubscriptExtendedQ">NCNonCommutativeSymbolOrSubscriptExtendedQ</a>,
<a href="#NCSymbolOrSubscriptQ">NCSymbolOrSubscriptQ</a>, <a
href="#NCSymbolOrSubscriptExtendedQ">NCSymbolOrSubscriptExtendedQ</a>,
<a href="#NCPowerQ">NCPowerQ</a>.</p>
<h3 data-number="10.1.20"
id="NCNonCommutativeSymbolOrSubscriptExtendedQ"><span
class="header-section-number">10.1.20</span>
NCNonCommutativeSymbolOrSubscriptExtendedQ</h3>
<p><code>NCNonCommutativeSymbolOrSubscriptExtendedQ[expr]</code> returns
<em>True</em> if <code>expr</code> is an noncommutative symbol, a
noncommutative symbol subscript, or the transpose (<code>tp</code>) or
adjoint (<code>aj</code>) of a noncommutative symbol or noncommutative
symbol subscript.</p>
<p>See also: <a
href="#NCNonCommutativeSymbolOrSubscriptQ">NCNonCommutativeSymbolOrSubscriptQ</a>,
<a href="#NCSymbolOrSubscriptQ">NCSymbolOrSubscriptQ</a>, <a
href="#NCSymbolOrSubscriptExtendedQ">NCSymbolOrSubscriptExtendedQ</a>,
<a href="#NCPowerQ">NCPowerQ</a>.</p>
<h3 data-number="10.1.21" id="NCPowerQ"><span
class="header-section-number">10.1.21</span> NCPowerQ</h3>
<p><code>NCPowerQ[expr]</code> returns <em>True</em> if
<code>expr</code> is an noncommutative symbol or symbol subscript or a
positive power of a noncommutative symbol or symbol subscript.</p>
<p>See also: <a
href="#NCNonCommutativeSymbolOrSubscriptQ">NCNonCommutativeSymbolOrSubscriptQ</a>,
<a href="#NCSymbolOrSubscriptQ">NCSymbolOrSubscriptQ</a>.</p>
<h3 data-number="10.1.22" id="Commutative"><span
class="header-section-number">10.1.22</span> Commutative</h3>
<p><code>Commutative[symbol]</code> is commutative even if
<code>symbol</code> is noncommutative.</p>
<p>See also: <a href="#CommuteEverything">CommuteEverything</a>, <a
href="#CommutativeQ">CommutativeQ</a>, <a
href="#SetCommutative">SetCommutative</a>, <a
href="#SetNonCommutative">SetNonCommutative</a>.</p>
<h3 data-number="10.1.23" id="CommuteEverything"><span
class="header-section-number">10.1.23</span> CommuteEverything</h3>
<p><code>CommuteEverything[expr]</code> is an alias for <a
href="#BeginCommuteEverything">BeginCommuteEverything</a>.</p>
<p>See also: <a
href="#BeginCommuteEverything">BeginCommuteEverything</a>, <a
href="#Commutative">Commutative</a>.</p>
<h3 data-number="10.1.24" id="BeginCommuteEverything"><span
class="header-section-number">10.1.24</span> BeginCommuteEverything</h3>
<p><code>BeginCommuteEverything[expr]</code> sets all symbols appearing
in <code>expr</code> as commutative so that the resulting expression
contains only commutative products or inverses. It issues messages
warning about which symbols have been affected.</p>
<p><code>EndCommuteEverything[]</code> restores the symbols
noncommutative behaviour.</p>
<p><code>BeginCommuteEverything</code> answers the question <em>what
does it sound like?</em></p>
<p>See also: <a href="#EndCommuteEverything">EndCommuteEverything</a>,
<a href="#Commutative">Commutative</a>.</p>
<h3 data-number="10.1.25" id="EndCommuteEverything"><span
class="header-section-number">10.1.25</span> EndCommuteEverything</h3>
<p><code>EndCommuteEverything[expr]</code> restores noncommutative
behaviour to symbols affected by
<code>BeginCommuteEverything</code>.</p>
<p>See also: <a
href="#BeginCommuteEverything">BeginCommuteEverything</a>, <a
href="#Commutative">Commutative</a>.</p>
<h3 data-number="10.1.26" id="ExpandNonCommutativeMultiply"><span
class="header-section-number">10.1.26</span>
ExpandNonCommutativeMultiply</h3>
<p><code>ExpandNonCommutativeMultiply[expr]</code> expands out
<code>**</code>s in <code>expr</code>.</p>
<p>For example</p>
<pre><code>ExpandNonCommutativeMultiply[a**(b+c)]</code></pre>
<p>returns</p>
<pre><code>a**b + a**c.</code></pre>
<p>See also: <a href="#NCExpand">NCExpand</a>, <a
href="#NCE">NCE</a>.</p>
<h3 data-number="10.1.27" id="NCExpand"><span
class="header-section-number">10.1.27</span> NCExpand</h3>
<p><code>NCExpand</code> is an alias for
<code>ExpandNonCommutativeMultiply</code>.</p>
<p>See also: <a
href="#ExpandNonCommutativeMultiply">ExpandNonCommutativeMultiply</a>,
<a href="#NCE">NCE</a>.</p>
<h3 data-number="10.1.28" id="NCE"><span
class="header-section-number">10.1.28</span> NCE</h3>
<p><code>NCE</code> is an alias for
<code>ExpandNonCommutativeMultiply</code>.</p>
<p>See also: <a
href="#ExpandNonCommutativeMultiply">ExpandNonCommutativeMultiply</a>,
<a href="#NCExpand">NCExpand</a>.</p>
<h3 data-number="10.1.29" id="NCExpandExponents"><span
class="header-section-number">10.1.29</span> NCExpandExponents</h3>
<p><code>NCExpandExponents[expr]</code> expands out powers of the
monomials appearing in <code>expr</code>.</p>
<p>For example</p>
<pre><code>NCExpandExponents[a**(b**c)^2**(c+d)]</code></pre>
<p>returns</p>
<pre><code>a**b**c**b**c**(c+d).</code></pre>
<p><code>NCExpandExponents</code> only expands powers of monomials.
Powers of symbols or other expressions are not expanded using
<code>NCExpandExponents</code>.</p>
<p>See also: <a href="#NCToList">NCToList</a> <a
href="#ExpandNonCommutativeMultiply">ExpandNonCommutativeMultiply</a>,
<a href="#NCExpand">NCExpand</a>, <a href="#NCE">NCE</a>.</p>
<h3 data-number="10.1.30" id="NCToList"><span
class="header-section-number">10.1.30</span> NCToList</h3>
<p><code>NCToList[expr]</code> produces a list with the symbols
appearing in monomial <code>expr</code>. If <code>expr</code> is not a
monomial it remains unevaluated. Powers of symbols are expanded before
the list is produced.</p>
<p>For example</p>
<pre><code>NCToList[a**b**a^2]</code></pre>
<p>returns</p>
<pre><code>{a,b,a,a}</code></pre>
<p>See also: <a href="#NCExpandExponents">NCExpandExponents</a>, <a
href="#ExpandNonCommutativeMultiply">ExpandNonCommutativeMultiply</a>,
<a href="#NCExpand">NCExpand</a>, <a href="#NCE">NCE</a>.</p>
<h2 data-number="10.2" id="PackageNCTr"><span
class="header-section-number">10.2</span> NCTr</h2>
<p><code>NCTr</code> provides the commutative operator <code>tr</code>
that behaves as the standard mathematical trace operator.</p>
<p>Members are:</p>
<ul>
<li><a href="#tr">tr</a></li>
<li><a href="#SortCyclicPermutation">SortCyclicPermutation</a></li>
<li><a
href="#SortedCyclicPermutationQ">SortedCyclicPermutationQ</a></li>
</ul>
<h3 data-number="10.2.1" id="tr"><span
class="header-section-number">10.2.1</span> tr</h3>
<p><code>tr[expr]</code> is an linear operator with the following
properties:</p>
<ul>
<li><code>tr</code> automatically distributes over sums;</li>
<li>when <code>expr</code> is a noncommutative product, then product is
sorted; for example <code>tr[b ** a]</code> evaluates into
<code>tr[a ** b]</code>;</li>
<li><code>tr[aj[expr]]</code> gets normalized as
<code>Conjugate[tr[expr]]</code>.</li>
</ul>
<p>See also: <a href="#SortCyclicPermutation">SortCyclicPermutation</a>,
<a href="#SortedCyclicPermutationQ">SortedCyclicPermutationQ</a>.</p>
<h3 data-number="10.2.2" id="SortCyclicPermutation"><span
class="header-section-number">10.2.2</span> SortCyclicPermutation</h3>
<p><code>SortedCyclicPermutation[list]</code> returns a cyclic
permutation of list sorted in ascending order.</p>
<p>See also: <a
href="#SortedCyclicPermutationQ">SortedCyclicPermutationQ</a>.</p>
<h3 data-number="10.2.3" id="SortedCyclicPermutationQ"><span
class="header-section-number">10.2.3</span>
SortedCyclicPermutationQ</h3>
<p><code>SortCyclicPermutationQ[list]</code> returns <code>True</code>
if <code>list</code> is a sorted cyclic permutation.</p>
<p>See also: <a
href="#SortCyclicPermutation">SortCyclicPermutation</a>.</p>
<h2 data-number="10.3" id="PackageNCCollect"><span
class="header-section-number">10.3</span> NCCollect</h2>
<p>Members are:</p>
<ul>
<li><a href="#NCCollect">NCCollect</a></li>
<li><a href="#NCCollectExponents">NCCollectExponents</a></li>
<li><a href="#NCCollectSelfAdjoint">NCCollectSelfAdjoint</a></li>
<li><a href="#NCCollectSymmetric">NCCollectSymmetric</a></li>
<li><a href="#NCStrongCollect">NCStrongCollect</a></li>
<li><a
href="#NCStrongCollectSelfAdjoint">NCStrongCollectSelfAdjoint</a></li>
<li><a
href="#NCStrongCollectSymmetric">NCStrongCollectSymmetric</a></li>
<li><a href="#NCCompose">NCCompose</a></li>
<li><a href="#NCDecompose">NCDecompose</a></li>
<li><a href="#NCTermsOfDegree">NCTermsOfDegree</a></li>
</ul>
<h3 data-number="10.3.1" id="NCCollect"><span
class="header-section-number">10.3.1</span> NCCollect</h3>
<p><code>NCCollect[expr,vars]</code> collects terms of nc expression
<code>expr</code> according to the elements of <code>vars</code> and
attempts to combine them. It is weaker than NCStrongCollect in that only
same order terms are collected togther. It basically is
<code>NCCompose[NCStrongCollect[NCDecompose]]]</code>.</p>
<p>If <code>expr</code> is a rational nc expression then degree
correspond to the degree of the polynomial obtained using <a
href="#NCRationalToNCPolynomial">NCRationalToNCPolynomial</a>.</p>
<p><code>NCCollect</code> also works with nc expressions instead of
<em>Symbols</em> in vars. In this case nc expressions are replaced by
new variables and <code>NCCollect</code> is called using the resulting
expression and the newly created <em>Symbols</em>.</p>
<p>This command internally converts nc expressions into the special
<code>NCPolynomial</code> format.</p>
<p><code>NCCollect[expr,vars,options]</code> uses options.</p>
<p>The following option is available:</p>
<ul>
<li><code>ByTotalDegree</code> (<code>False</code>): whether to collect
by total or partial degree.</li>
</ul>
<p><strong>Notes:</strong></p>
<p>While <code>NCCollect[expr, vars]</code> always returns
mathematically correct expressions, it may not collect <code>vars</code>
from as many terms as one might think it should.</p>
<p>See also: <a href="#NCStrongCollect">NCStrongCollect</a>, <a
href="#NCCollectSymmetric">NCCollectSymmetric</a>, <a
href="#NCCollectSelfAdjoint">NCCollectSelfAdjoint</a>, <a
href="#NCStrongCollectSymmetric">NCStrongCollectSymmetric</a>, <a
href="#NCStrongCollectSelfAdjoint">NCStrongCollectSelfAdjoint</a>, <a
href="#NCRationalToNCPolynomial">NCRationalToNCPolynomial</a>.</p>
<h3 data-number="10.3.2" id="NCCollectExponents"><span
class="header-section-number">10.3.2</span> NCCollectExponents</h3>
<p><code>NCCollectExponents[expr]</code> collects exponents in
noncommutative monomials.</p>
<p>For example</p>
<pre><code>NCCollectExponents[a**b**a**b**c-a**b**a**b]</code></pre>
<p>returns</p>
<pre><code>(a**b)^2**c-(a**b)^2</code></pre>
<p>See also: <a href="#NCCollect">NCCollect</a>, <a
href="#NCStrongCollect">NCStrongCollect</a>.</p>
<h3 data-number="10.3.3" id="NCCollectSelfAdjoint"><span
class="header-section-number">10.3.3</span> NCCollectSelfAdjoint</h3>
<p><code>NCCollectSelfAdjoint[expr,vars]</code> allows one to collect
terms of nc expression <code>expr</code> on the variables
<code>vars</code> and their adjoints without writing out the
adjoints.</p>
<p>This command internally converts nc expressions into the special
<code>NCPolynomial</code> format.</p>
<p><code>NCCollectSelfAdjoint[expr,vars,options]</code> uses
options.</p>
<p>The following option is available:</p>
<ul>
<li><code>ByTotalDegree</code> (<code>False</code>): whether to collect
by total or partial degree.</li>
</ul>
<p>See also: <a href="#NCCollect">NCCollect</a>, <a
href="#NCStrongCollect">NCStrongCollect</a>, <a
href="#NCCollectSymmetric">NCCollectSymmetric</a>, <a
href="#NCStrongCollectSymmetric">NCStrongCollectSymmetric</a>, <a
href="#NCStrongCollectSelfAdjoint">NCStrongCollectSelfAdjoint</a>.</p>
<h3 data-number="10.3.4" id="NCCollectSymmetric"><span
class="header-section-number">10.3.4</span> NCCollectSymmetric</h3>
<p><code>NCCollectSymmetric[expr,vars]</code> allows one to collect
terms of nc expression <code>expr</code> on the variables
<code>vars</code> and their transposes without writing out the
transposes.</p>
<p>This command internally converts nc expressions into the special
<code>NCPolynomial</code> format.</p>
<p><code>NCCollectSymmetric[expr,vars,options]</code> uses options.</p>
<p>The following option is available:</p>
<ul>
<li><code>ByTotalDegree</code> (<code>False</code>): whether to collect
by total or partial degree.</li>
</ul>
<p>See also: <a href="#NCCollect">NCCollect</a>, <a
href="#NCStrongCollect">NCStrongCollect</a>, <a
href="#NCCollectSelfAdjoint">NCCollectSelfAdjoint</a>, <a
href="#NCStrongCollectSymmetric">NCStrongCollectSymmetric</a>, <a
href="#NCStrongCollectSelfAdjoint">NCStrongCollectSelfAdjoint</a>.</p>
<h3 data-number="10.3.5" id="NCStrongCollect"><span
class="header-section-number">10.3.5</span> NCStrongCollect</h3>
<p><code>NCStrongCollect[expr,vars]</code> collects terms of expression
<code>expr</code> according to the elements of <code>vars</code> and
attempts to combine by association.</p>
<p>In the noncommutative case the Taylor expansion and so the collect
function is not uniquely specified. The function
<code>NCStrongCollect</code> often collects too much and while correct
it may be stronger than you want.</p>
<p>For example, a symbol <code>x</code> will factor out of terms where
it appears both linearly and quadratically thus mixing orders.</p>
<p>This command internally converts nc expressions into the special
<code>NCPolynomial</code> format.</p>
<p>See also: <a href="#NCCollect">NCCollect</a>, <a
href="#NCCollectSymmetric">NCCollectSymmetric</a>, <a
href="#NCCollectSelfAdjoint">NCCollectSelfAdjoint</a>, <a
href="#NCStrongCollectSymmetric">NCStrongCollectSymmetric</a>, <a
href="#NCStrongCollectSelfAdjoint">NCStrongCollectSelfAdjoint</a>.</p>
<h3 data-number="10.3.6" id="NCStrongCollectSelfAdjoint"><span
class="header-section-number">10.3.6</span>
NCStrongCollectSelfAdjoint</h3>
<p><code>NCStrongCollectSymmetric[expr,vars]</code> allows one to
collect terms of nc expression <code>expr</code> on the variables
<code>vars</code> and their transposes without writing out the
transposes.</p>
<p>This command internally converts nc expressions into the special
<code>NCPolynomial</code> format.</p>
<p>See also: <a href="#NCCollect">NCCollect</a>, <a
href="#NCStrongCollect">NCStrongCollect</a>, <a
href="#NCCollectSymmetric">NCCollectSymmetric</a>, <a
href="#NCCollectSelfAdjoint">NCCollectSelfAdjoint</a>, <a
href="#NCStrongCollectSymmetric">NCStrongCollectSymmetric</a>.</p>
<h3 data-number="10.3.7" id="NCStrongCollectSymmetric"><span
class="header-section-number">10.3.7</span>
NCStrongCollectSymmetric</h3>
<p><code>NCStrongCollectSymmetric[expr,vars]</code> allows one to
collect terms of nc expression <code>expr</code> on the variables
<code>vars</code> and their transposes without writing out the
transposes.</p>
<p>This command internally converts nc expressions into the special
<code>NCPolynomial</code> format.</p>
<p>See also: <a href="#NCCollect">NCCollect</a>, <a
href="#NCStrongCollect">NCStrongCollect</a>, <a
href="#NCCollectSymmetric">NCCollectSymmetric</a>, <a
href="#NCCollectSelfAdjoint">NCCollectSelfAdjoint</a>, <a
href="#NCStrongCollectSelfAdjoint">NCStrongCollectSelfAdjoint</a>.</p>
<h3 data-number="10.3.8" id="NCCompose"><span
class="header-section-number">10.3.8</span> NCCompose</h3>
<p><code>NCCompose[dec]</code> will reassemble the terms in
<code>dec</code> which were decomposed by <a
href="#NCDecompose"><code>NCDecompose</code></a>.</p>
<p><code>NCCompose[dec, degree]</code> will reassemble only the terms of
degree <code>degree</code>.</p>
<p>The expression <code>NCCompose[NCDecompose[p,vars]]</code> will
reproduce the polynomial <code>p</code>.</p>
<p>The expression <code>NCCompose[NCDecompose[p,vars], degree]</code>
will reproduce only the terms of degree <code>degree</code>.</p>
<p>This command internally converts nc expressions into the special
<code>NCPolynomial</code> format.</p>
<p>See also: <a href="#NCDecompose">NCDecompose</a>, <a
href="#NCPDecompose">NCPDecompose</a>.</p>
<h3 data-number="10.3.9" id="NCDecompose"><span
class="header-section-number">10.3.9</span> NCDecompose</h3>
<p><code>NCDecompose[p,vars]</code> gives an association of elements of
the nc polynomial <code>p</code> in variables <code>vars</code> in which
elements of the same order are collected together.</p>
<p><code>NCDecompose[p]</code> treats all nc letters in <code>p</code>
as variables.</p>
<p>This command internally converts nc expressions into the special
<code>NCPolynomial</code> format.</p>
<p>Internally <code>NCDecompose</code> uses <a
href="#NCPDecompose"><code>NCPDecompose</code></a>.</p>
<p>See also: <a href="#NCCompose">NCCompose</a>, <a
href="#NCPDecompose">NCPDecompose</a>.</p>
<h3 data-number="10.3.10" id="NCTermsOfDegree"><span
class="header-section-number">10.3.10</span> NCTermsOfDegree</h3>
<p><code>NCTermsOfDegree[expr,vars,degrees]</code> returns an expression
such that each term has degree <code>degrees</code> in variables
<code>vars</code>.</p>
<p>For example,</p>
<pre><code>NCTermsOfDegree[x**y**x - x**x**y + x**w + z**w, {x,y}, {2,1}]</code></pre>
<p>returns <code>x**y**x - x**x**y</code>,</p>
<pre><code>NCTermsOfDegree[x**y**x - x**x**y + x**w + z**w, {x,y}, {1,0}]</code></pre>
<p>returns <code>x**w</code>,</p>
<pre><code>NCTermsOfDegree[x**y**x - x**x**y + x**w + z**w, {x,y}, {0,0}]</code></pre>
<p>returns <code>z**w</code>, and</p>
<pre><code>NCTermsOfDegree[x**y**x - x**x**y + x**w + z**w, {x,y}, {0,1}]</code></pre>
<p>returns <code>0</code>.</p>
<p>This command internally converts nc expressions into the special
<code>NCPolynomial</code> format.</p>
<p>See also: <a href="#NCTermsOfTotalDegree">NCTermsOfTotalDegree</a>,
<a href="#NCDecompose">NCDecompose</a>, <a
href="#NCPDecompose">NCPDecompose</a>.</p>
<h3 data-number="10.3.11" id="NCTermsOfTotalDegree"><span
class="header-section-number">10.3.11</span> NCTermsOfTotalDegree</h3>
<p><code>NCTermsOfTotalDegree[expr,vars,degree]</code> returns an
expression such that each term has total degree <code>degree</code> in
variables <code>vars</code>.</p>
<p>For example,</p>
<pre><code>NCTermsOfTotalDegree[x**y**x - x**x**y + x**w + z**w, {x,y}, 3]</code></pre>
<p>returns <code>x**y**x - x**x**y</code>,</p>
<pre><code>NCTermsOfTotalDegree[x**y**x - x**x**y + x**w + z**w, {x,y}, 1]</code></pre>
<p>returns <code>x**w</code>,</p>
<pre><code>NCTermsOfTotalDegree[x**y**x - x**x**y + x**w + z**w, {x,y}, 0]</code></pre>
<p>returns <code>z**w</code>, and</p>
<pre><code>NCTermsOfTotalDegree[x**y**x - x**x**y + x**w + z**w, {x,y}, 2]</code></pre>
<p>returns <code>0</code>.</p>
<p>This command internally converts nc expressions into the special
<code>NCPolynomial</code> format.</p>
<p>See also: <a href="#NCTermsOfDegree">NCTermsOfDegree</a>, <a
href="#NCDecompose">NCDecompose</a>, <a
href="#NCPDecompose">NCPDecompose</a>.</p>
<h2 data-number="10.4" id="PackageNCReplace"><span
class="header-section-number">10.4</span> NCReplace</h2>
<p><strong>NCReplace</strong> is a package containing several functions
that are useful in making replacements in noncommutative expressions. It
offers replacements to Mathematica’s <code>Replace</code>,
<code>ReplaceAll</code>, <code>ReplaceRepeated</code>, and
<code>ReplaceList</code> functions.</p>
<blockquote>
<p>Commands in this package replace the old <code>Substitute</code> and
<code>Transform</code> family of command which are been deprecated. The
new commands are much more reliable and work faster than the old
commands. From the beginning, substitution was always problematic and
certain patterns would be missed. We reassure that the call expression
that are returned are mathematically correct but some opportunities for
substitution may have been missed.</p>
</blockquote>
<p>Members are:</p>
<ul>
<li><a href="#NCReplace">NCReplace</a></li>
<li><a href="#NCReplaceAll">NCReplaceAll</a></li>
<li><a href="#NCReplaceList">NCReplaceList</a></li>
<li><a href="#NCReplaceRepeated">NCReplaceRepeated</a></li>
<li><a href="#NCExpandReplaceRepeated">NCExpandReplaceRepeated</a></li>
<li><a href="#NCMakeRuleSymmetric">NCMakeRuleSymmetric</a></li>
<li><a href="#NCMakeRuleSelfAdjoint">NCMakeRuleSelfAdjoint</a></li>
<li><a href="#NCReplaceSymmetric">NCReplaceSymmetric</a></li>
<li><a href="#NCReplaceAllSymmetric">NCReplaceAllSymmetric</a></li>
<li><a href="#NCReplaceListSymmetric">NCReplaceListSymmetric</a></li>
<li><a
href="#NCReplaceRepeatedSymmetric">NCReplaceRepeatedSymmetric</a></li>
<li><a
href="#NCExpandReplaceRepeatedSymmetric">NCExpandReplaceRepeatedSymmetric</a></li>
<li><a href="#NCReplaceSelfAdjoint">NCReplaceSelfAdjoint</a></li>
<li><a href="#NCReplaceAllSelfAdjoint">NCReplaceAllSelfAdjoint</a></li>
<li><a
href="#NCReplaceListSelfAdjoint">NCReplaceListSelfAdjoint</a></li>
<li><a
href="#NCReplaceRepeatedSelfAdjoint">NCReplaceRepeatedSelfAdjoint</a></li>
<li><a
href="#NCExpandReplaceRepeatedSelfAdjoint">NCExpandReplaceRepeatedSelfAdjoint</a></li>
<li><a href="#NCMatrixExpand">NCMatrixExpand</a></li>
<li><a href="#NCMatrixReplaceAll">NCMatrixReplaceAll</a></li>
<li><a href="#NCMatrixReplaceRepeated">NCMatrixReplaceRepeated</a></li>
<li><a href="#NCReplacePowerRule">NCReplacePowerRule</a></li>
</ul>
<p>Aliases:</p>
<ul>
<li><a href="#NCR">NCR</a> for <a href="#NCReplace">NCReplace</a></li>
<li><a href="#NCRA">NCRA</a> for <a
href="#NCReplaceAll">NCReplaceAll</a></li>
<li><a href="#NCRL">NCRL</a> for <a
href="#NCReplaceList">NCReplaceList</a></li>
<li><a href="#NCRR">NCRR</a> for <a
href="#NCReplaceRepeated">NCReplaceRepeated</a></li>
<li><a href="#NCRSym">NCRSym</a> for <a
href="#NCReplaceSymmetric">NCReplaceSymmetric</a></li>
<li><a href="#NCRASym">NCRASym</a> for <a
href="#NCReplaceAllSymmetric">NCReplaceAllSymmetric</a></li>
<li><a href="#NCRLSym">NCRLSym</a> for <a
href="#NCReplaceListSymmetric">NCReplaceListSymmetric</a></li>
<li><a href="#NCRRSym">NCRRSym</a> for <a
href="#NCReplaceRepeatedSymmetric">NCReplaceRepeatedSymmetric</a></li>
<li><a href="#NCRSA">NCRSA</a> for <a
href="#NCReplaceSelfAdjoint">NCReplaceSelfAdjoint</a></li>
<li><a href="#NCRASA">NCRASA</a> for <a
href="#NCReplaceAllSelfAdjoint">NCReplaceAllSelfAdjoint</a></li>
<li><a href="#NCRLSA">NCRLSA</a> for <a
href="#NCReplaceListSelfAdjoint">NCReplaceListSelfAdjoint</a></li>
<li><a href="#NCRRSA">NCRRSA</a> for <a
href="#NCReplaceRepeatedSelfAdjoint">NCReplaceRepeatedSelfAdjoint</a></li>
</ul>
<p>Options:</p>
<ul>
<li><code>ApplyPowerRule</code> (<code>True</code>): If
<code>True</code>, <code>NCReplacePowerRule</code> is automatically
applied to all rules in <code>NCReplace</code>,
<code>NCReplaceAll</code>, <code>NCReplaceRepeated</code>, and
<code>NCReplaceList</code>.</li>
</ul>
<h3 data-number="10.4.1" id="NCReplace"><span
class="header-section-number">10.4.1</span> NCReplace</h3>
<p><code>NCReplace[expr,rules]</code> applies a rule or list of rules
<code>rules</code> in an attempt to transform the entire nc expression
<code>expr</code>.</p>
<p><code>NCReplace[expr,rules,levelspec]</code> applies
<code>rules</code> to parts of <code>expr</code> specified by
<code>levelspec</code>.</p>
<p><code>NCReplace[expr,rules,options]</code> and
<code>NCReplace[expr,rules,levelspec]</code> use
<code>options</code>.</p>
<p>See also: <a href="#NCReplaceAll">NCReplaceAll</a>, <a
href="#NCReplaceList">NCReplaceList</a>, <a
href="#NCReplaceRepeated">NCReplaceRepeated</a>.</p>
<h3 data-number="10.4.2" id="NCReplaceAll"><span
class="header-section-number">10.4.2</span> NCReplaceAll</h3>
<p><code>NCReplaceAll[expr,rules]</code> applies a rule or list of rules
<code>rules</code> in an attempt to transform each part of the nc
expression <code>expr</code>.</p>
<p><code>NCReplaceAll[expr,rules,options]</code> uses
<code>options</code>.</p>
<p>See also: <a href="#NCReplace">NCReplace</a>, <a
href="#NCReplaceList">NCReplaceList</a>, <a
href="#NCReplaceRepeated">NCReplaceRepeated</a>.</p>
<h3 data-number="10.4.3" id="NCReplaceList"><span
class="header-section-number">10.4.3</span> NCReplaceList</h3>
<p><code>NCReplace[expr,rules]</code> attempts to transform the entire
nc expression <code>expr</code> by applying a rule or list of rules
<code>rules</code> in all possible ways, and returns a list of the
results obtained.</p>
<p><code>ReplaceList[expr,rules,n]</code> gives a list of at most
<code>n</code> results.</p>
<p><code>NCReplaceList[expr,rules,options]</code> and
<code>NCReplaceList[expr,rules,n,options]</code> use
<code>options</code>.</p>
<p>See also: <a href="#NCReplace">NCReplace</a>, <a
href="#NCReplaceAll">NCReplaceAll</a>, <a
href="#NCReplaceRepeated">NCReplaceRepeated</a>.</p>
<h3 data-number="10.4.4" id="NCReplaceRepeated"><span
class="header-section-number">10.4.4</span> NCReplaceRepeated</h3>
<p><code>NCReplaceRepeated[expr,rules]</code> repeatedly performs
replacements using rule or list of rules <code>rules</code> until
<code>expr</code> no longer changes.</p>
<p><code>NCReplaceRepeated[expr,rules,options]</code> uses
<code>options</code>.</p>
<p>See also: <a href="#NCReplace">NCReplace</a>, <a
href="#NCReplaceAll">NCReplaceAll</a>, <a
href="#NCReplaceList">NCReplaceList</a>, <a
href="#NCExpandReplaceRepeated">NCExpandReplaceRepeated</a>.</p>
<h3 data-number="10.4.5" id="NCExpandReplaceRepeated"><span
class="header-section-number">10.4.5</span> NCExpandReplaceRepeated</h3>
<p><code>NCExpandReplaceRepeated[expr,rules]</code> repeatedly applies
<code>NCReplaceRepeated</code> and <code>NCExpand</code> until the
results does not change.</p>
<p><code>NCExpandReplaceRepeated[expr,rules,options]</code> uses
<code>options</code>.</p>
<p>See also: <a href="#NCReplaceRepeated">NCReplaceRepeated</a>, <a
href="#NCExpandReplaceRepeatedSymmetric">NCExpandReplaceRepeatedSymmetric</a>,
<a
href="#NCExpandReplaceRepeatedSelfAdjoint">NCExpandReplaceRepeatedSelfAdjoint</a>.</p>
<h3 data-number="10.4.6" id="NCR"><span
class="header-section-number">10.4.6</span> NCR</h3>
<p><code>NCR</code> is an alias for <code>NCReplace</code>.</p>
<p>See also: <a href="#NCReplace">NCReplace</a>.</p>
<h3 data-number="10.4.7" id="NCRA"><span
class="header-section-number">10.4.7</span> NCRA</h3>
<p><code>NCRA</code> is an alias for <code>NCReplaceAll</code>.</p>
<p>See also: <a href="#NCReplaceAll">NCReplaceAll</a>.</p>
<h3 data-number="10.4.8" id="NCRR"><span
class="header-section-number">10.4.8</span> NCRR</h3>
<p><code>NCRR</code> is an alias for <code>NCReplaceRepeated</code>.</p>
<p>See also: <a href="#NCReplaceRepeated">NCReplaceRepeated</a>.</p>
<h3 data-number="10.4.9" id="NCRL"><span
class="header-section-number">10.4.9</span> NCRL</h3>
<p><code>NCRL</code> is an alias for <code>NCReplaceList</code>.</p>
<p>See also: <a href="#NCReplaceList">NCReplaceList</a>.</p>
<h3 data-number="10.4.10" id="NCMakeRuleSymmetric"><span
class="header-section-number">10.4.10</span> NCMakeRuleSymmetric</h3>
<p><code>NCMakeRuleSymmetric[rules]</code> add rules to transform the
transpose of the left-hand side of <code>rules</code> into the transpose
of the right-hand side of <code>rules</code>.</p>
<p>See also: <a href="#NCMakeRuleSelfAdjoint">NCMakeRuleSelfAdjoint</a>,
<a href="#NCReplace">NCReplace</a>, <a
href="#NCReplaceAll">NCReplaceAll</a>, <a
href="#NCReplaceList">NCReplaceList</a>, <a
href="#NCReplaceRepeated">NCReplaceRepeated</a>.</p>
<h3 data-number="10.4.11" id="NCMakeRuleSelfAdjoint"><span
class="header-section-number">10.4.11</span> NCMakeRuleSelfAdjoint</h3>
<p><code>NCMakeRuleSelfAdjoint[rules]</code> add rules to transform the
adjoint of the left-hand side of <code>rules</code> into the adjoint of
the right-hand side of <code>rules</code>.</p>
<p>See also: <a href="#NCMakeRuleSymmetric">NCMakeRuleSymmetric</a>, <a
href="#NCReplace">NCReplace</a>, <a
href="#NCReplaceAll">NCReplaceAll</a>, <a
href="#NCReplaceList">NCReplaceList</a>, <a
href="#NCReplaceRepeated">NCReplaceRepeated</a>.</p>
<h3 data-number="10.4.12" id="NCReplaceSymmetric"><span
class="header-section-number">10.4.12</span> NCReplaceSymmetric</h3>
<p><code>NCReplaceSymmetric[expr, rules]</code> applies
<code>NCMakeRuleSymmetric</code> to <code>rules</code> before calling
<code>NCReplace</code>.</p>
<p><code>NCReplaceSymmetric[expr,rules,options]</code> uses
<code>options</code>.</p>
<p>See also: <a href="#NCReplace">NCReplace</a>, <a
href="#NCMakeRuleSymmetric">NCMakeRuleSymmetric</a>.</p>
<h3 data-number="10.4.13" id="NCReplaceAllSymmetric"><span
class="header-section-number">10.4.13</span> NCReplaceAllSymmetric</h3>
<p><code>NCReplaceAllSymmetric[expr, rules]</code> applies
<code>NCMakeRuleSymmetric</code> to <code>rules</code> before calling
<code>NCReplaceAll</code>.</p>
<p><code>NCReplaceAllSymmetric[expr,rules,options]</code> uses
<code>options</code>.</p>
<p>See also: <a href="#NCReplaceAll">NCReplaceAll</a>, <a
href="#NCMakeRuleSymmetric">NCMakeRuleSymmetric</a>.</p>
<h3 data-number="10.4.14" id="NCReplaceRepeatedSymmetric"><span
class="header-section-number">10.4.14</span>
NCReplaceRepeatedSymmetric</h3>
<p><code>NCReplaceRepeatedSymmetric[expr, rules]</code> applies
<code>NCMakeRuleSymmetric</code> to <code>rules</code> before calling
<code>NCReplaceRepeated</code>.</p>
<p><code>NCReplaceRepeatedSymmetric[expr,rules,options]</code> uses
<code>options</code>.</p>
<p>See also: <a href="#NCReplaceRepeated">NCReplaceRepeated</a>, <a
href="#NCMakeRuleSymmetric">NCMakeRuleSymmetric</a>.</p>
<h3 data-number="10.4.15" id="NCExpandReplaceRepeatedSymmetric"><span
class="header-section-number">10.4.15</span>
NCExpandReplaceRepeatedSymmetric</h3>
<p><code>NCExpandReplaceRepeatedSymmetric[expr,rules]</code> repeatedly
applies <code>NCReplaceRepeatedSymmetric</code> and
<code>NCExpand</code> until the results does not change.</p>
<p><code>NCExpandReplaceRepeatedSymmetric[expr,rules,options]</code>
uses <code>options</code>.</p>
<p>See also: <a
href="#NCReplaceRepeatedSymmetric">NCReplaceRepeatedSymmetric</a>, <a
href="#NCExpandReplaceRepeated">NCExpandReplaceRepeated</a>, <a
href="#NCExpandReplaceRepeatedSelfAdjoint">NCExpandReplaceRepeatedSelfAdjoint</a>.</p>
<h3 data-number="10.4.16" id="NCReplaceListSymmetric"><span
class="header-section-number">10.4.16</span> NCReplaceListSymmetric</h3>
<p><code>NCReplaceListSymmetric[expr, rules]</code> applies
<code>NCMakeRuleSymmetric</code> to <code>rules</code> before calling
<code>NCReplaceList</code>.</p>
<p><code>NCReplaceListSymmetric[expr,rules,options]</code> uses
<code>options</code>.</p>
<p>See also: <a href="#NCReplaceList">NCReplaceList</a>, <a
href="#NCMakeRuleSymmetric">NCMakeRuleSymmetric</a>.</p>
<h3 data-number="10.4.17" id="NCRSym"><span
class="header-section-number">10.4.17</span> NCRSym</h3>
<p><code>NCRSym</code> is an alias for
<code>NCReplaceSymmetric</code>.</p>
<p>See also: <a href="#NCReplaceSymmetric">NCReplaceSymmetric</a>.</p>
<h3 data-number="10.4.18" id="NCRASym"><span
class="header-section-number">10.4.18</span> NCRASym</h3>
<p><code>NCRASym</code> is an alias for
<code>NCReplaceAllSymmetric</code>.</p>
<p>See also: <a
href="#NCReplaceAllSymmetric">NCReplaceAllSymmetric</a>.</p>
<h3 data-number="10.4.19" id="NCRRSym"><span
class="header-section-number">10.4.19</span> NCRRSym</h3>
<p><code>NCRRSym</code> is an alias for
<code>NCReplaceRepeatedSymmetric</code>.</p>
<p>See also: <a
href="#NCReplaceRepeatedSymmetric">NCReplaceRepeatedSymmetric</a>.</p>
<h3 data-number="10.4.20" id="NCRLSym"><span
class="header-section-number">10.4.20</span> NCRLSym</h3>
<p><code>NCRLSym</code> is an alias for
<code>NCReplaceListSymmetric</code>.</p>
<p>See also: <a
href="#NCReplaceListSymmetric">NCReplaceListSymmetric</a>.</p>
<h3 data-number="10.4.21" id="NCReplaceSelfAdjoint"><span
class="header-section-number">10.4.21</span> NCReplaceSelfAdjoint</h3>
<p><code>NCReplaceSelfAdjoint[expr, rules]</code> applies
<code>NCMakeRuleSelfAdjoint</code> to <code>rules</code> before calling
<code>NCReplace</code>.</p>
<p><code>NCReplaceSelfAdjoint[expr,rules,options]</code> uses
<code>options</code>.</p>
<p>See also: <a href="#NCReplace">NCReplace</a>, <a
href="#NCMakeRuleSelfAdjoint">NCMakeRuleSelfAdjoint</a>.</p>
<h3 data-number="10.4.22" id="NCReplaceAllSelfAdjoint"><span
class="header-section-number">10.4.22</span>
NCReplaceAllSelfAdjoint</h3>
<p><code>NCReplaceAllSelfAdjoint[expr, rules]</code> applies
<code>NCMakeRuleSelfAdjoint</code> to <code>rules</code> before calling
<code>NCReplaceAll</code>.</p>
<p><code>NCReplaceAllSelfAdjoint[expr,rules,options]</code> uses
<code>options</code>.</p>
<p>See also: <a href="#NCReplaceAll">NCReplaceAll</a>, <a
href="#NCMakeRuleSelfAdjoint">NCMakeRuleSelfAdjoint</a>.</p>
<h3 data-number="10.4.23" id="NCReplaceRepeatedSelfAdjoint"><span
class="header-section-number">10.4.23</span>
NCReplaceRepeatedSelfAdjoint</h3>
<p><code>NCReplaceRepeatedSelfAdjoint[expr, rules]</code> applies
<code>NCMakeRuleSelfAdjoint</code> to <code>rules</code> before calling
<code>NCReplaceRepeated</code>.</p>
<p><code>NCReplaceRepeatedSelfAdjoint[expr,rules,options]</code> uses
<code>options</code>.</p>
<p>See also: <a href="#NCReplaceRepeated">NCReplaceRepeated</a>, <a
href="#NCMakeRuleSelfAdjoint">NCMakeRuleSelfAdjoint</a>.</p>
<h3 data-number="10.4.24" id="NCExpandReplaceRepeatedSelfAdjoint"><span
class="header-section-number">10.4.24</span>
NCExpandReplaceRepeatedSelfAdjoint</h3>
<p><code>NCExpandReplaceRepeatedSelfAdjoint[expr,rules]</code>
repeatedly applies <code>NCReplaceRepeatedSelfAdjoint</code> and
<code>NCExpand</code> until the results does not change.</p>
<p><code>NCExpandedReplaceRepeatedSelfAdjoint[expr,rules,options]</code>
uses <code>options</code>.</p>
<p>See also: <a
href="#NCReplaceRepeatedSelfAdjoint">NCReplaceRepeatedSelfAdjoint</a>,
<a href="#NCExpandReplaceRepeated">NCExpandReplaceRepeated</a>, <a
href="#NCExpandReplaceRepeatedSymmetric">NCExpandReplaceRepeatedSymmetric</a>.</p>
<h3 data-number="10.4.25" id="NCReplaceListSelfAdjoint"><span
class="header-section-number">10.4.25</span>
NCReplaceListSelfAdjoint</h3>
<p><code>NCReplaceListSelfAdjoint[expr, rules]</code> applies
<code>NCMakeRuleSelfAdjoint</code> to <code>rules</code> before calling
<code>NCReplaceList</code>.</p>
<p><code>NCReplaceListSelfAdjoint[expr,rules,options]</code> uses
<code>options</code>.</p>
<p>See also: <a href="#NCReplaceList">NCReplaceList</a>, <a
href="#NCMakeRuleSelfAdjoint">NCMakeRuleSelfAdjoint</a>.</p>
<h3 data-number="10.4.26" id="NCRSA"><span
class="header-section-number">10.4.26</span> NCRSA</h3>
<p><code>NCRSA</code> is an alias for
<code>NCReplaceSymmetric</code>.</p>
<p>See also: <a href="#NCReplaceSymmetric">NCReplaceSymmetric</a>.</p>
<h3 data-number="10.4.27" id="NCRASA"><span
class="header-section-number">10.4.27</span> NCRASA</h3>
<p><code>NCRASA</code> is an alias for
<code>NCReplaceAllSymmetric</code>.</p>
<p>See also: <a
href="#NCReplaceAllSymmetric">NCReplaceAllSymmetric</a>.</p>
<h3 data-number="10.4.28" id="NCRRSA"><span
class="header-section-number">10.4.28</span> NCRRSA</h3>
<p><code>NCRRSA</code> is an alias for
<code>NCReplaceRepeatedSymmetric</code>.</p>
<p>See also: <a
href="#NCReplaceRepeatedSymmetric">NCReplaceRepeatedSymmetric</a>.</p>
<h3 data-number="10.4.29" id="NCRLSA"><span
class="header-section-number">10.4.29</span> NCRLSA</h3>
<p><code>NCRLSA</code> is an alias for
<code>NCReplaceListSymmetric</code>.</p>
<p>See also: <a
href="#NCReplaceListSymmetric">NCReplaceListSymmetric</a>.</p>
<h3 data-number="10.4.30" id="NCMatrixExpand"><span
class="header-section-number">10.4.30</span> NCMatrixExpand</h3>
<p><code>NCMatrixExpand[expr]</code> expands <code>inv</code> and
<code>**</code> of matrices appearing in nc expression
<code>expr</code>. It effectively substitutes <code>inv</code> for
<code>NCInverse</code> and <code>**</code> by <code>NCDot</code>.</p>
<p>See also: <a href="#NCInverse">NCInverse</a>, <a
href="#NCDot">NCDot</a>.</p>
<h3 data-number="10.4.31" id="NCMatrixReplaceAll"><span
class="header-section-number">10.4.31</span> NCMatrixReplaceAll</h3>
<p><code>NCMatrixReplaceAll[expr,rules]</code> applies a rule or list of
rules <code>rules</code> in an attempt to transform each part of the nc
expression <code>expr</code>.</p>
<p><code>NCMatrixReplaceAll</code> works as <code>NCReplaceAll</code>
but takes extra steps to make sure substitutions work with matrices.</p>
<p>See also: <a href="#NCReplaceAll">NCReplaceAll</a>, <a
href="#NCMatrixReplaceRepeated">NCMatrixReplaceRepeated</a>.</p>
<h3 data-number="10.4.32" id="NCMatrixReplaceRepeated"><span
class="header-section-number">10.4.32</span>
NCMatrixReplaceRepeated</h3>
<p><code>NCMatrixReplaceRepeated[expr,rules]</code> repeatedly performs
replacements using rule or list of rules <code>rules</code> until
<code>expr</code> no longer changes.</p>
<p><code>NCMatrixReplaceRepeated</code> works as
<code>NCReplaceRepeated</code> but takes extra steps to make sure
substitutions work with matrices.</p>
<p>See also: <a href="#NCReplaceRepeated">NCReplaceRepeated</a>, <a
href="#NCMatrixReplaceAll">NCMatrixReplaceAll</a>.</p>
<h3 data-number="10.4.33" id="NCReplacePowerRule"><span
class="header-section-number">10.4.33</span> NCReplacePowerRule</h3>
<p><code>NCReplacePowerRule[rule]</code> transforms rules that consist
of a noncommutative monomial so that symbols appearing on the left and
on right of the monomial also match positive powers of that symbol.</p>
<p>See also: <a href="#NCReplace">NCReplace</a>, <a
href="#NCReplaceAll">NCReplaceAll</a>, <a
href="#NCReplaceList">NCReplaceList</a>, <a
href="#NCReplaceRepeated">NCReplaceRepeated</a>.</p>
<h2 data-number="10.5" id="PackageNCSelfAdjoint"><span
class="header-section-number">10.5</span> NCSelfAdjoint</h2>
<p>Members are:</p>
<ul>
<li><a href="#NCSymmetricQ">NCSymmetricQ</a></li>
<li><a href="#NCSymmetricTest">NCSymmetricTest</a></li>
<li><a href="#NCSymmetricPart">NCSymmetricPart</a></li>
<li><a href="#NCSelfAdjointQ">NCSelfAdjointQ</a></li>
<li><a href="#NCSelfAdjointTest">NCSelfAdjointTest</a></li>
</ul>
<h3 data-number="10.5.1" id="NCSymmetricQ"><span
class="header-section-number">10.5.1</span> NCSymmetricQ</h3>
<p><code>NCSymmetricQ[expr]</code> returns <em>True</em> if
<code>expr</code> is symmetric, i.e. if <code>tp[exp] == exp</code>.</p>
<p><code>NCSymmetricQ</code> attempts to detect symmetric variables
using <code>NCSymmetricTest</code>.</p>
<p>See also: <a href="#NCSelfAdjointQ">NCSelfAdjointQ</a>, <a
href="#NCSymmetricTest">NCSymmetricTest</a>.</p>
<h3 data-number="10.5.2" id="NCSymmetricTest"><span
class="header-section-number">10.5.2</span> NCSymmetricTest</h3>
<p><code>NCSymmetricTest[expr]</code> attempts to establish symmetry of
<code>expr</code> by assuming symmetry of its variables.</p>
<p><code>NCSymmetricTest[exp,options]</code> uses
<code>options</code>.</p>
<p><code>NCSymmetricTest</code> returns a list of two elements:</p>
<ul>
<li>the first element is <em>True</em> or <em>False</em> if it succeeded
to prove <code>expr</code> symmetric.</li>
<li>the second element is a list of the variables that were made
symmetric.</li>
</ul>
<p>The following options can be given:</p>
<ul>
<li><code>SymmetricVariables</code>: list of variables that should be
considered symmetric; use <code>All</code> to make all variables
symmetric;</li>
<li><code>ExcludeVariables</code>: list of variables that should not be
considered symmetric; use <code>All</code> to exclude all
variables;</li>
<li><code>Strict</code>: treats as non-symmetric any variable that
appears inside <code>tp</code>.</li>
</ul>
<p>See also: <a href="#NCSymmetricQ">NCSymmetricQ</a>, <a
href="#NCSelfAdjointTest">NCNCSelfAdjointTest</a>.</p>
<h3 data-number="10.5.3" id="NCSymmetricPart"><span
class="header-section-number">10.5.3</span> NCSymmetricPart</h3>
<p><code>NCSymmetricPart[expr]</code> returns the <em>symmetric
part</em> of <code>expr</code>.</p>
<p><code>NCSymmetricPart[exp,options]</code> uses
<code>options</code>.</p>
<p><code>NCSymmetricPart[expr]</code> returns a list of two
elements:</p>
<ul>
<li>the first element is the <em>symmetric part</em> of
<code>expr</code>;</li>
<li>the second element is a list of the variables that were made
symmetric.</li>
</ul>
<p><code>NCSymmetricPart[expr]</code> returns <code>{$Failed, {}}</code>
if <code>expr</code> is not symmetric.</p>
<p>For example:</p>
<pre><code>{answer, symVars} = NCSymmetricPart[a ** x + x ** tp[a] + 1];</code></pre>
<p>returns</p>
<pre><code>answer = 2 a ** x + 1
symVars = {x}</code></pre>
<p>The following options can be given:</p>
<ul>
<li><code>SymmetricVariables</code>: list of variables that should be
considered symmetric; use <code>All</code> to make all variables
symmetric;</li>
<li><code>ExcludeVariables</code>: list of variables that should not be
considered symmetric; use <code>All</code> to exclude all
variables.</li>
<li><code>Strict</code>: treats as non-symmetric any variable that
appears inside <code>tp</code>.</li>
</ul>
<p>See also: <a href="#NCSymmetricTest">NCSymmetricTest</a>.</p>
<h3 data-number="10.5.4" id="NCSelfAdjointQ"><span
class="header-section-number">10.5.4</span> NCSelfAdjointQ</h3>
<p><code>NCSelfAdjointQ[expr]</code> returns true if <code>expr</code>
is self-adjoint, i.e. if <code>aj[exp] == exp</code>.</p>
<p>See also: <a href="#NCSymmetricQ">NCSymmetricQ</a>, <a
href="#NCSelfAdjointTest">NCSelfAdjointTest</a>.</p>
<h3 data-number="10.5.5" id="NCSelfAdjointTest"><span
class="header-section-number">10.5.5</span> NCSelfAdjointTest</h3>
<p><code>NCSelfAdjointTest[expr]</code> attempts to establish whether
<code>expr</code> is self-adjoint by assuming that some of its variables
are self-adjoint or symmetric.
<code>NCSelfAdjointTest[expr,options]</code> uses
<code>options</code>.</p>
<p><code>NCSelfAdjointTest</code> returns a list of three elements:</p>
<ul>
<li>the first element is <em>True</em> or <em>False</em> if it succeded
to prove <code>expr</code> self-adjoint.</li>
<li>the second element is a list of variables that were made
self-adjoint.</li>
<li>the third element is a list of variables that were made
symmetric.</li>
</ul>
<p>The following options can be given:</p>
<ul>
<li><code>SelfAdjointVariables</code>: list of variables that should be
considered self-adjoint; use <code>All</code> to make all variables
self-adjoint;</li>
<li><code>SymmetricVariables</code>: list of variables that should be
considered symmetric; use <code>All</code> to make all variables
symmetric;</li>
<li><code>ExcludeVariables</code>: list of variables that should not be
considered symmetric; use <code>All</code> to exclude all
variables.</li>
<li><code>Strict</code>: treats as non-self-adjoint any variable that
appears inside <code>aj</code>.</li>
</ul>
<p>See also: <a href="#NCSelfAdjointQ">NCSelfAdjointQ</a>.</p>
<h2 data-number="10.6" id="PackageNCSimplifyRational"><span
class="header-section-number">10.6</span> NCSimplifyRational</h2>
<p><strong>NCSimplifyRational</strong> is a package with function that
simplifies noncommutative expressions and certain functions of their
inverses.</p>
<p><code>NCSimplifyRational</code> simplifies rational noncommutative
expressions by repeatedly applying a set of reduction rules to the
expression. <code>NCSimplifyRationalSinglePass</code> does only a single
pass.</p>
<p>Rational expressions of the form</p>
<pre><code>inv[A + terms]</code></pre>
<p>are first normalized to</p>
<p>inv[1 + terms/A]/A</p>
<p>using <code>NCNormalizeInverse</code>. Here <code>A</code> is
commutative.</p>
<p>For each <code>inv</code> found in expression, a custom set of rules
is constructed based on its associated NC Groebner basis.</p>
<p>For example, if</p>
<pre><code>inv[mon1 + ... + K lead]</code></pre>
<p>where <code>lead</code> is the leading monomial with the highest
degree then the following rules are generated:</p>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Original</th>
<th>Transformed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>inv[mon1 + … + K lead] lead</td>
<td>(1 - inv[mon1 + … + K lead] (mon1 + …))/K</td>
</tr>
<tr class="even">
<td>lead inv[mon1 + … + K lead]</td>
<td>(1 - (mon1 + …) inv[mon1 + … + K lead])/K</td>
</tr>
</tbody>
</table>
<p>Finally the following pattern based rules are applied:</p>
<table>
<thead>
<tr class="header">
<th>Original</th>
<th>Transformed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>inv[a] inv[1 + K a b]</td>
<td>inv[a] - K b inv[1 + K a b]</td>
</tr>
<tr class="even">
<td>inv[a] inv[1 + K a]</td>
<td>inv[a] - K inv[1 + K a]</td>
</tr>
<tr class="odd">
<td>inv[1 + K a b] inv[b]</td>
<td>inv[b] - K inv[1 + K a b] a</td>
</tr>
<tr class="even">
<td>inv[1 + K a] inv[a]</td>
<td>inv[a] - K inv[1 + K a]</td>
</tr>
<tr class="odd">
<td>inv[1 + K a b] a</td>
<td>a inv[1 + K b a]</td>
</tr>
<tr class="even">
<td>inv[A inv[a] + B b] inv[a]</td>
<td>(1/A) inv[1 + (B/A) a b]</td>
</tr>
<tr class="odd">
<td>inv[a] inv[A inv[a] + K b]</td>
<td>(1/A) inv[1 + (B/A) b a]</td>
</tr>
<tr class="even">
<td>inv[1 + K a b] a b</td>
<td>(1 - inv[1 + K a b])/K</td>
</tr>
<tr class="odd">
<td>inv[1 + K a] a</td>
<td>(1 - inv[1 + K a])/K</td>
</tr>
<tr class="even">
<td>a b inv[1 + K a b]</td>
<td>(1 - inv[1 + K a b])/K</td>
</tr>
<tr class="odd">
<td>a inv[1 + K a]</td>
<td>(1 - inv[1 + K a])/K</td>
</tr>
</tbody>
</table>
<p><code>NCPreSimplifyRational</code> only applies pattern based rules
from the table above once.</p>
<p>Rules in <code>NCSimplifyRational</code> and
<code>NCPreSimplifyRational</code> are applied repeatedly.</p>
<p>Rules in <code>NCSimplifyRationalSinglePass</code> and
<code>NCPreSimplifyRationalSinglePass</code> are applied only once.</p>
<p>The particular ordering of monomials used by
<code>NCSimplifyRational</code> is the one implied by the
<code>NCPolynomial</code> format. This ordering is a variant of the
deg-lex ordering where the lexical ordering is Mathematica’s natural
ordering.</p>
<p><code>NCSimplifyRational</code> is limited by its rule list and what
rules are best is unknown and might depend on additional assumptions.
For example:</p>
<pre><code>NCSimplifyRational[y ** inv[y + x ** y]]</code></pre>
<p>returns <code>y ** inv[y + x ** y]</code> not
<code>inv[1 + x]</code>, which is what one would expect if
<code>y</code> were to be invertible. Indeed,</p>
<pre><code>NCSimplifyRational[inv[y] ** inv[inv[y] + x ** inv[y]]]</code></pre>
<p>does return <code>inv[1 + x]</code>, since in this case the appearing
of <code>inv[y]</code> trigger rules that implicitely assume
<code>y</code> is invertible.</p>
<p>Members are:</p>
<ul>
<li><a href="#NCNormalizeInverse">NCNormalizeInverse</a></li>
<li><a href="#NCSimplifyRational">NCSimplifyRational</a></li>
<li><a
href="#NCSimplifyRationalSinglePass">NCSimplifyRationalSinglePass</a></li>
<li><a href="#NCPreSimplifyRational">NCPreSimplifyRational</a></li>
<li><a
href="#NCPreSimplifyRationalSinglePass">NCPreSimplifyRationalSinglePass</a></li>
</ul>
<p>Aliases:</p>
<ul>
<li><a href="#NCSR">NCSR</a> for <a
href="#NCSimplifyRational">NCSimplifyRational</a></li>
</ul>
<h3 data-number="10.6.1" id="NCNormalizeInverse"><span
class="header-section-number">10.6.1</span> NCNormalizeInverse</h3>
<p><code>NCNormalizeInverse[expr]</code> transforms all rational NC
expressions of the form <code>inv[K + b]</code> into
<code>inv[1 + (1/K) b]/K</code> if <code>A</code> is commutative.</p>
<p>See also: <a href="#NCSimplifyRational">NCSimplifyRational</a>, <a
href="#NCSimplifyRationalSinglePass">NCSimplifyRationalSinglePass</a>.</p>
<h3 data-number="10.6.2" id="NCSimplifyRational"><span
class="header-section-number">10.6.2</span> NCSimplifyRational</h3>
<p><code>NCSimplifyRational[expr]</code> repeatedly applies
<code>NCSimplifyRationalSinglePass</code> in an attempt to simplify the
rational NC expression <code>expr</code>.</p>
<p>See also: <a href="#NCNormalizeInverse">NCNormalizeInverse</a>, <a
href="#NCSimplifyRationalSinglePass">NCSimplifyRationalSinglePass</a>.</p>
<h3 data-number="10.6.3" id="NCSR"><span
class="header-section-number">10.6.3</span> NCSR</h3>
<p><code>NCSR</code> is an alias for
<code>NCSimplifyRational</code>.</p>
<p>See also: <a href="#NCSimplifyRational">NCSimplifyRational</a>.</p>
<h3 data-number="10.6.4" id="NCSimplifyRationalSinglePass"><span
class="header-section-number">10.6.4</span>
NCSimplifyRationalSinglePass</h3>
<p><code>NCSimplifyRationalSinglePass[expr]</code> applies a series of
custom rules only once in an attempt to simplify the rational NC
expression <code>expr</code>.</p>
<p>See also: <a href="#NCNormalizeInverse">NCNormalizeInverse</a>, <a
href="#NCSimplifyRational">NCSimplifyRational</a>.</p>
<h3 data-number="10.6.5" id="NCPreSimplifyRational"><span
class="header-section-number">10.6.5</span> NCPreSimplifyRational</h3>
<p><code>NCPreSimplifyRational[expr]</code> repeatedly applies
<code>NCPreSimplifyRationalSinglePass</code> in an attempt to simplify
the rational NC expression <code>expr</code>.</p>
<p>See also: <a href="#NCNormalizeInverse">NCNormalizeInverse</a>, <a
href="#NCPreSimplifyRationalSinglePass">NCPreSimplifyRationalSinglePass</a>.</p>
<h3 data-number="10.6.6" id="NCPreSimplifyRationalSinglePass"><span
class="header-section-number">10.6.6</span>
NCPreSimplifyRationalSinglePass</h3>
<p><code>NCPreSimplifyRationalSinglePass[expr]</code> applies a series
of custom rules only once in an attempt to simplify the rational NC
expression <code>expr</code>.</p>
<p>See also: <a href="#NCNormalizeInverse">NCNormalizeInverse</a>, <a
href="#NCPreSimplifyRational">NCPreSimplifyRational</a>.</p>
<h2 data-number="10.7" id="PackageNCDiff"><span
class="header-section-number">10.7</span> NCDiff</h2>
<p><strong>NCDiff</strong> is a package containing several functions
that are used in noncommutative differention of functions and
polynomials.</p>
<p>Members are:</p>
<ul>
<li><a href="#NCDirectionalD">NCDirectionalD</a></li>
<li><a href="#NCGrad">NCGrad</a></li>
<li><a href="#NCHessian">NCHessian</a></li>
<li><a href="#NCIntegrate">NCIntegrate</a></li>
</ul>
<p>Members being deprecated:</p>
<ul>
<li><a href="#DirectionalD">DirectionalD</a></li>
</ul>
<h3 data-number="10.7.1" id="NCDirectionalD"><span
class="header-section-number">10.7.1</span> NCDirectionalD</h3>
<p><code>NCDirectionalD[expr, {var1, h1}, ...]</code> takes the
directional derivative of expression <code>expr</code> with respect to
variables <code>var1</code>, <code>var2</code>, … successively in the
directions <code>h1</code>, <code>h2</code>, ….</p>
<p>For example, if:</p>
<pre><code>expr = a**inv[1+x]**b + x**c**x</code></pre>
<p>then</p>
<pre><code>NCDirectionalD[expr, {x,h}]</code></pre>
<p>returns</p>
<pre><code>h**c**x + x**c**h - a**inv[1+x]**h**inv[1+x]**b</code></pre>
<p>In the case of more than one variables
<code>NCDirectionalD[expr, {x,h}, {y,k}]</code> takes the directional
derivative of <code>expr</code> with respect to <code>x</code> in the
direction <code>h</code> and with respect to <code>y</code> in the
direction <code>k</code>. For example, if:</p>
<pre><code>expr = x**q**x - y**x</code></pre>
<p>then</p>
<pre><code>NCDirectionalD[expr, {x,h}, {y,k}]</code></pre>
<p>returns</p>
<pre><code>h**q**x + x**q*h - y**h - k**x</code></pre>
<p>See also: <a href="#NCGrad">NCGrad</a>, <a
href="#NCHessian">NCHessian</a>.</p>
<h3 data-number="10.7.2" id="NCGrad"><span
class="header-section-number">10.7.2</span> NCGrad</h3>
<p><code>NCGrad[expr, var1, ...]</code> gives the nc gradient of the
expression <code>expr</code> with respect to variables
<code>var1</code>, <code>var2</code>, …. If there is more than one
variable then <code>NCGrad</code> returns the gradient in a list.</p>
<p>The transpose of the gradient of the nc expression <code>expr</code>
is the derivative with respect to the direction <code>h</code> of the
trace of the directional derivative of <code>expr</code> in the
direction <code>h</code>.</p>
<p>For example, if:</p>
<pre><code>expr = x**a**x**b + x**c**x**d</code></pre>
<p>then its directional derivative in the direction <code>h</code>
is</p>
<pre><code>NCDirectionalD[expr, {x,h}]</code></pre>
<p>which returns</p>
<pre><code>h**a**x**b + x**a**h**b + h**c**x**d + x**c**h**d</code></pre>
<p>and</p>
<pre><code>NCGrad[expr, x]</code></pre>
<p>returns the nc gradient</p>
<pre><code>a**x**b + b**x**a + c**x**d + d**x**c</code></pre>
<p>For example, if:</p>
<pre><code>expr = x**a**x**b + x**c**y**d</code></pre>
<p>is a function on variables <code>x</code> and <code>y</code> then</p>
<pre><code>NCGrad[expr, x, y]</code></pre>
<p>returns the nc gradient list</p>
<pre><code>{a**x**b + b**x**a + c**y**d, d**x**c}</code></pre>
<p><strong>IMPORTANT</strong>: The expression returned by NCGrad is the
transpose or the adjoint of the standard gradient. This is done so that
no assumption on the symbols are needed. The calculated expression is
correct even if symbols are self-adjoint or symmetric.</p>
<p>See also: <a href="#NCDirectionalD">NCDirectionalD</a>.</p>
<h3 data-number="10.7.3" id="NCHessian"><span
class="header-section-number">10.7.3</span> NCHessian</h3>
<p><code>NCHessian[expr, {var1, h1}, ...]</code> takes the second
directional derivative of nc expression <code>expr</code> with respect
to variables <code>var1</code>, <code>var2</code>, … successively in the
directions <code>h1</code>, <code>h2</code>, ….</p>
<p>For example, if:</p>
<pre><code>expr = y**inv[x]**y + x**a**x</code></pre>
<p>then</p>
<pre><code>NCHessian[expr, {x,h}, {y,s}]</code></pre>
<p>returns</p>
<pre><code>2 h**a**h + 2 s**inv[x]**s - 2 s**inv[x]**h**inv[x]**y -
2 y**inv[x]**h**inv[x]**s + 2 y**inv[x]**h**inv[x]**h**inv[x]**y</code></pre>
<p>In the case of more than one variables
<code>NCHessian[expr, {x,h}, {y,k}]</code> takes the second directional
derivative of <code>expr</code> with respect to <code>x</code> in the
direction <code>h</code> and with respect to <code>y</code> in the
direction <code>k</code>.</p>
<p>See also: <a href="#NCDirectionalD">NCDiretionalD</a>, <a
href="#NCGrad">NCGrad</a>.</p>
<h3 data-number="10.7.4" id="DirectionalD"><span
class="header-section-number">10.7.4</span> DirectionalD</h3>
<p><code>DirectionalD[expr,var,h]</code> takes the directional
derivative of nc expression <code>expr</code> with respect to the single
variable <code>var</code> in direction <code>h</code>.</p>
<p><strong>DEPRECATION NOTICE</strong>: This syntax is limited to one
variable and is being deprecated in favor of the more general syntax in
<a href="#NCDirectionalD">NCDirectionalD</a>.</p>
<p>See also: <a href="#DirectionalD">NCDirectionalD</a>.</p>
<h3 data-number="10.7.5" id="NCIntegrate"><span
class="header-section-number">10.7.5</span> NCIntegrate</h3>
<p><code>NCIntegrate[expr,{var1,h1},...]</code> attempts to calculate
the nc antiderivative of nc expression <code>expr</code> with respect to
the single variable <code>var</code> in direction <code>h</code>.</p>
<p>For example:</p>
<pre><code>NCIntegrate[x**h+h**x, {x,h}]</code></pre>
<p>returns</p>
<pre><code>x**x</code></pre>
<p>See also: <a href="#DirectionalD">NCDirectionalD</a>.</p>
<h2 data-number="10.8" id="PackageNCConvexity"><span
class="header-section-number">10.8</span> NCConvexity</h2>
<p><strong>NCConvexity</strong> is a package that provides functionality
to determine whether a rational or polynomial noncommutative function is
convex.</p>
<p>Members are:</p>
<ul>
<li><a href="#NCIndependent">NCIndependent</a></li>
<li><a href="#NCConvexityRegion">NCConvexityRegion</a></li>
</ul>
<h3 data-number="10.8.1" id="NCIndependent"><span
class="header-section-number">10.8.1</span> NCIndependent</h3>
<p><code>NCIndependent[list]</code> attempts to determine whether the nc
entries of <code>list</code> are independent.</p>
<p>Entries of <code>NCIndependent</code> can be nc polynomials or nc
rationals.</p>
<p>For example:</p>
<pre><code>NCIndependent[{x,y,z}]</code></pre>
<p>return <em>True</em> while</p>
<pre><code>NCIndependent[{x,0,z}]
NCIndependent[{x,y,x}]
NCIndependent[{x,y,x+y}]
NCIndependent[{x,y,A x + B y}]
NCIndependent[{inv[1+x]**inv[x], inv[x], inv[1+x]}]</code></pre>
<p>all return <em>False</em>.</p>
<p>See also: <a href="#NCConvexityRegion">NCConvexityRegion</a>.</p>
<h3 data-number="10.8.2" id="NCConvexityRegion"><span
class="header-section-number">10.8.2</span> NCConvexityRegion</h3>
<p><code>NCConvexityRegion[expr,vars]</code> is a function which can be
used to determine whether the nc rational <code>expr</code> is convex in
<code>vars</code> or not.</p>
<p>For example:</p>
<pre><code>d = NCConvexityRegion[x**x**x, {x}];</code></pre>
<p>returns</p>
<pre><code>d = {2 x, -2 inv[x]}</code></pre>
<p>from which we conclude that <code>x**x**x</code> is not convex in
<code>x</code> because <span class="math inline">\(x \succ 0\)</span>
and <span class="math inline">\(-{x}^{-1} \succ 0\)</span> cannot
simultaneously hold.</p>
<p><code>NCConvexityRegion</code> works by factoring the
<code>NCHessian</code>, essentially calling:</p>
<pre><code>hes = NCHessian[expr, {x, h}];</code></pre>
<p>then</p>
<pre><code>{lt, mq, rt} = NCMatrixOfQuadratic[hes, {h}]</code></pre>
<p>to decompose the Hessian into a product of a left row vector,
<code>lt</code>, times a middle matrix, <code>mq</code>, times a right
column vector, <code>rt</code>. The middle matrix, <code>mq</code>, is
factored using the <code>NCLDLDecomposition</code>:</p>
<pre><code>{ldl, p, s, rank} = NCLDLDecomposition[mq];
{lf, d, rt} = GetLDUMatrices[ldl, s];</code></pre>
<p>from which the output of NCConvexityRegion is the a list with the
block-diagonal entries of the matrix <code>d</code>.</p>
<p>See also: <a href="#NCHessian">NCHessian</a>, <a
href="#NCMatrixOfQuadratic">NCMatrixOfQuadratic</a>, <a
href="#NCLDLDecomposition">NCLDLDecomposition</a>.</p>
<h1 data-number="11"
id="packages-for-manipulating-nc-block-matrices"><span
class="header-section-number">11</span> Packages for manipulating NC
block matrices</h1>
<h2 data-number="11.1" id="PackageNCDot"><span
class="header-section-number">11.1</span> NCDot</h2>
<p>Members are:</p>
<ul>
<li><a href="#tpMat">tpMat</a></li>
<li><a href="#ajMat">ajMat</a></li>
<li><a href="#coMat">coMat</a></li>
<li><a href="#NCDot">NCDot</a></li>
<li><a href="#NCInverse">NCInverse</a></li>
</ul>
<h3 data-number="11.1.1" id="tpMat"><span
class="header-section-number">11.1.1</span> tpMat</h3>
<p><code>tpMat[mat]</code> gives the transpose of matrix
<code>mat</code> using <code>tp</code>.</p>
<p>See also: <a href="#tpMat">ajMat</a>, <a href="#coMat">coMat</a>, <a
href="#NCDot">NCDot</a>.</p>
<h3 data-number="11.1.2" id="ajMat"><span
class="header-section-number">11.1.2</span> ajMat</h3>
<p><code>ajMat[mat]</code> gives the adjoint transpose of matrix
<code>mat</code> using <code>aj</code> instead of
<code>ConjugateTranspose</code>.</p>
<p>See also: <a href="#tpMat">tpMat</a>, <a href="#coMat">coMat</a>, <a
href="#NCDot">NCDot</a>.</p>
<h3 data-number="11.1.3" id="coMat"><span
class="header-section-number">11.1.3</span> coMat</h3>
<p><code>coMat[mat]</code> gives the conjugate of matrix
<code>mat</code> using <code>co</code> instead of
<code>Conjugate</code>.</p>
<p>See also: <a href="#tpMat">tpMat</a>, <a href="#coMat">ajMat</a>, <a
href="#NCDot">NCDot</a>.</p>
<h3 data-number="11.1.4" id="NCDot"><span
class="header-section-number">11.1.4</span> NCDot</h3>
<p><code>NCDot[mat1, mat2, ...]</code> gives the matrix multiplication
of <code>mat1</code>, <code>mat2</code>, … using
<code>NonCommutativeMultiply</code> rather than <code>Times</code>.</p>
<p><strong>Notes:</strong></p>
<p>The experienced matrix analyst should always remember that the
Mathematica convention for handling vectors is tricky.</p>
<ul>
<li><code>{{1,2,4}}</code> is a 1x3 <em>matrix</em> or a <em>row
vector</em>;</li>
<li><code>{{1},{2},{4}}</code> is a 3x1 <em>matrix</em> or a <em>column
vector</em>;</li>
<li><code>{1,2,4}</code> is a <em>vector</em> but <strong>not</strong> a
<em>matrix</em>. Indeed whether it is a row or column vector depends on
the context. We advise not to use <em>vectors</em>.</li>
</ul>
<p>See also: <a href="#tpMat">tpMat</a>, <a href="#coMat">ajMat</a>, <a
href="#coMat">coMat</a>.</p>
<h3 data-number="11.1.5" id="NCInverse"><span
class="header-section-number">11.1.5</span> NCInverse</h3>
<p><code>NCInverse[mat]</code> gives the nc inverse of the square matrix
<code>mat</code>. <code>NCInverse</code> uses partial pivoting to find a
nonzero pivot.</p>
<p><code>NCInverse</code> is primarily used symbolically. Usually the
elements of the inverse matrix are huge expressions. We recommend using
<code>NCSimplifyRational</code> to improve the results.</p>
<p>See also: <a href="#tpMat">tpMat</a>, <a href="#coMat">ajMat</a>, <a
href="#coMat">coMat</a>.</p>
<h2 data-number="11.2" id="PackageNCMatrixDecompositions"><span
class="header-section-number">11.2</span> NCMatrixDecompositions</h2>
<p><code>NCMatrixDecompositions</code> provide noncommutative versions
of the linear algebra algorithms in the package <a
href="#PackageMatrixDecompositions">MatrixDecompositions</a>.</p>
<p>See the documentation for the package <a
href="#PackageMatrixDecompositions">MatrixDecompositions</a> for details
on the algorithms and options.</p>
<p>Members are:</p>
<ul>
<li>Decompositions
<ul>
<li><a
href="#NCLUDecompositionWithPartialPivoting">NCLUDecompositionWithPartialPivoting</a></li>
<li><a
href="#NCLUDecompositionWithCompletePivoting">NCLUDecompositionWithCompletePivoting</a></li>
<li><a href="#NCLDLDecomposition">NCLDLDecomposition</a></li>
</ul></li>
<li>Solvers
<ul>
<li><a href="#NCLowerTriangularSolve">NCLowerTriangularSolve</a></li>
<li><a href="#NCUpperTriangularSolve">NCUpperTriangularSolve</a></li>
<li><a href="#NCLUInverse">NCLUInverse</a></li>
</ul></li>
<li>Utilities
<ul>
<li><a href="#NCLUCompletePivoting">NCLUCompletePivoting</a></li>
<li><a href="#NCLUPartialPivoting">NCLUPartialPivoting</a></li>
<li><a href="#NCLeftDivide">NCLeftDivide</a></li>
<li><a href="#NCRightDivide">NCRightDivide</a></li>
</ul></li>
</ul>
<h3 data-number="11.2.1" id="NCLUDecompositionWithPartialPivoting"><span
class="header-section-number">11.2.1</span>
NCLUDecompositionWithPartialPivoting</h3>
<p><code>NCLUDecompositionWithPartialPivoting</code> is a noncommutative
version of <a
href="#NCLUDecompositionWithPartialPivoting">NCLUDecompositionWithPartialPivoting</a>.</p>
<p>The following <code>options</code> can be given:</p>
<ul>
<li><code>ZeroTest</code> (<code>PossibleZeroQ</code>): function used to
decide if a pivot is zero;</li>
<li><code>RightDivide</code> (<a
href="#NCRightDivide">NCRightDivide</a>): function used to divide a
vector by an entry;</li>
<li><code>Dot</code> (<a href="#NCDot">NCDot</a>): function used to
multiply vectors and matrices;</li>
<li><code>Pivoting</code> (<a
href="#NCLUPartialPivoting">NCLUPartialPivoting</a>): function used to
sort rows for pivoting;</li>
<li><code>SuppressPivoting</code> (<code>False</code>): whether to
perform pivoting or not.</li>
</ul>
<p>See also: <a
href="#LUDecompositionWithPartialPivoting">LUDecompositionWithPartialPivoting</a>.</p>
<h3 data-number="11.2.2"
id="NCLUDecompositionWithCompletePivoting"><span
class="header-section-number">11.2.2</span>
NCLUDecompositionWithCompletePivoting</h3>
<p><code>NCLUDecompositionWithCompletePivoting</code> is a
noncommutative version of <a
href="#NCLUDecompositionWithCompletePivoting">NCLUDecompositionWithCompletePivoting</a>.</p>
<p>The following <code>options</code> can be given:</p>
<ul>
<li><code>ZeroTest</code> (<code>PossibleZeroQ</code>): function used to
decide if a pivot is zero;</li>
<li><code>RightDivide</code> (<a
href="#NCRightDivide">NCRightDivide</a>): function used to divide a
vector by an entry;</li>
<li><code>Dot</code> (<a href="#NCDot">NCDot</a>): function used to
multiply vectors and matrices;</li>
<li><code>Pivoting</code> (<a
href="#NCLUCompletePivoting">NCLUCompletePivoting</a>): function used to
sort rows for pivoting;</li>
<li><code>SuppressPivoting</code> (<code>False</code>): whether to
perform pivoting or not.</li>
</ul>
<p>See also: <a
href="#LUDecompositionWithCompletePivoting">LUDecompositionWithCompletePivoting</a>.</p>
<h3 data-number="11.2.3" id="NCLDLDecomposition"><span
class="header-section-number">11.2.3</span> NCLDLDecomposition</h3>
<p><code>NCLDLDecomposition</code> is a noncommutative version of <a
href="#LDLDecomposition">LDLDecomposition</a>.</p>
<p>The following <code>options</code> can be given:</p>
<ul>
<li><code>ZeroTest</code> (<code>PossibleZeroQ</code>): function used to
decide if a pivot is zero;</li>
<li><code>RightDivide</code> (<a
href="#NCRightDivide">NCRightDivide</a>): function used to divide a
vector by an entry on the right;</li>
<li><code>LeftDivide</code> (<a href="#NCLeftDivide">NCLeftDivide</a>):
function used to divide a vector by an entry on the left;</li>
<li><code>Dot</code> (<code>NCDot</code>): function used to multiply
vectors and matrices;</li>
<li><code>CompletePivoting</code> (<a
href="#NCLUCompletePivoting">NCLUCompletePivoting</a>): function used to
sort rows for complete pivoting;</li>
<li><code>PartialPivoting</code> (<a
href="#NCLUPartialPivoting">NCLUPartialPivoting</a>): function used to
sort matrices for complete pivoting;</li>
<li><code>Inverse</code> (<a href="#NCLUInverse">NCLUInverse</a>):
function used to invert 2x2 diagonal blocks;</li>
<li><code>SelfAdjointMatrixQ</code> (<a
href="#NCSelfAdjointQ">NCSelfAdjointQ</a>): function to test if matrix
is self-adjoint;</li>
<li><code>SuppressPivoting</code> (<code>False</code>): whether to
perform pivoting or not.</li>
</ul>
<p>See also: <a
href="#LUDecompositionWithCompletePivoting">LUDecompositionWithCompletePivoting</a>.</p>
<h3 data-number="11.2.4" id="NCUpperTriangularSolve"><span
class="header-section-number">11.2.4</span> NCUpperTriangularSolve</h3>
<p><code>NCUpperTriangularSolve</code> is a noncommutative version of <a
href="#UpperTriangularSolve">UpperTriangularSolve</a>.</p>
<p>See also: <a
href="#UpperTriangularSolve">UpperTriangularSolve</a>.</p>
<h3 data-number="11.2.5" id="NCLowerTriangularSolve"><span
class="header-section-number">11.2.5</span> NCLowerTriangularSolve</h3>
<p><code>NCLowerTriangularSolve</code> is a noncommutative version of <a
href="#LowerTriangularSolve">LowerTriangularSolve</a>.</p>
<p>See also: <a
href="#LowerTriangularSolve">LowerTriangularSolve</a>.</p>
<h3 data-number="11.2.6" id="NCLUInverse"><span
class="header-section-number">11.2.6</span> NCLUInverse</h3>
<p><code>NCLUInverse</code> is a noncommutative version of <a
href="#LUInverse">LUInverse</a>.</p>
<p>See also: <a href="#LUInverse">LUInverse</a>.</p>
<h3 data-number="11.2.7" id="NCLUPartialPivoting"><span
class="header-section-number">11.2.7</span> NCLUPartialPivoting</h3>
<p><code>NCLUPartialPivoting</code> is a noncommutative version of <a
href="#LUPartialPivoting">LUPartialPivoting</a>.</p>
<p>See also: <a href="#LUPartialPivoting">LUPartialPivoting</a>.</p>
<h3 data-number="11.2.8" id="NCLUCompletePivoting"><span
class="header-section-number">11.2.8</span> NCLUCompletePivoting</h3>
<p><code>NCLUCompletePivoting</code> is a noncommutative version of <a
href="#LUCompletePivoting">LUCompletePivoting</a>.</p>
<p>See also: <a href="#LUCompletePivoting">LUCompletePivoting</a>.</p>
<h3 data-number="11.2.9" id="NCLeftDivide"><span
class="header-section-number">11.2.9</span> NCLeftDivide</h3>
<p><code>NCLeftDivide[x,y]</code> divides each entry of the list
<code>y</code> by <code>x</code> on the left.</p>
<p>For example:</p>
<pre><code>NCLeftDivide[x, {a,b,c}]</code></pre>
<p>returns</p>
<pre><code>{inv[x]**a, inv[x]**b, inv[x]**c}</code></pre>
<p>See also: <a href="#NCRightDivide">NCRightDivide</a>.</p>
<h3 data-number="11.2.10" id="NCRightDivide"><span
class="header-section-number">11.2.10</span> NCRightDivide</h3>
<p><code>NCRightDivide[x,y]</code> divides each entry of the list
<code>x</code> by <code>y</code> on the right.</p>
<p>For example:</p>
<pre><code>NCRightDivide[{a,b,c}, y]</code></pre>
<p>returns</p>
<pre><code>{a**inv[y], b**inv[y], c**inv[y]}</code></pre>
<p>See also: <a href="#NCLeftDivide">NCLeftDivide</a>.</p>
<h2 data-number="11.3" id="PackageMatrixDecompositions"><span
class="header-section-number">11.3</span> MatrixDecompositions: linear
algebra templates</h2>
<p><code>MatrixDecompositions</code> is a package that implements
various linear algebra algorithms, such as <em>LU Decomposition</em>
with <em>partial</em> and <em>complete pivoting</em>, and <em>LDL
Decomposition</em>. The algorithms have been written with correctness
and ease of customization rather than efficiency as the main goals. They
were originally developed to serve as the core of the noncommutative
linear algebra algorithms for <a
href="http://math.ucsd.edu/~ncalg">NCAlgebra</a>.</p>
<p>See the package <a
href="#PackageNCMatrixDecompositions">NCMatrixDecompositions</a> for
noncommutative versions of these algorithms.</p>
<p>Members are:</p>
<ul>
<li>Decompositions
<ul>
<li><a
href="#LUDecompositionWithPartialPivoting">LUDecompositionWithPartialPivoting</a></li>
<li><a
href="#LUDecompositionWithCompletePivoting">LUDecompositionWithCompletePivoting</a></li>
<li><a href="#LDLDecomposition">LDLDecomposition</a></li>
<li><a href="#LURowReduce">LURowReduce</a></li>
<li><a href="#LURowReduceIncremental">LURowReduceIncremental</a></li>
</ul></li>
<li>Solvers
<ul>
<li><a href="#LowerTriangularSolve">LowerTriangularSolve</a></li>
<li><a href="#UpperTriangularSolve">UpperTriangularSolve</a></li>
<li><a href="#LUInverse">LUInverse</a></li>
</ul></li>
<li>Utilities
<ul>
<li><a href="#GetLUMatrices">GetLUMatrices</a></li>
<li><a href="#GetFullLUMatrices">GetFullLUMatrices</a></li>
<li><a href="#GetLDUMatrices">GetLDUMatrices</a></li>
<li><a href="#GetFullLDUMatrices">GetFullLDUMatrices</a></li>
<li><a href="#GetDiagonal">GetDiagonal</a></li>
<li><a href="#LUPartialPivoting">LUPartialPivoting</a></li>
<li><a href="#LUCompletePivoting">LUCompletePivoting</a></li>
</ul></li>
</ul>
<h3 data-number="11.3.1" id="LUDecompositionWithPartialPivoting"><span
class="header-section-number">11.3.1</span>
LUDecompositionWithPartialPivoting</h3>
<p><code>LUDecompositionWithPartialPivoting[m]</code> generates a
representation of the LU decomposition of the rectangular matrix
<code>m</code>.</p>
<p><code>LUDecompositionWithPartialPivoting[m, options]</code> uses
<code>options</code>.</p>
<p><code>LUDecompositionWithPartialPivoting</code> returns a list of two
elements:</p>
<ul>
<li>the first element is a combination of upper- and lower-triangular
matrices;</li>
<li>the second element is a vector specifying rows used for
pivoting.</li>
</ul>
<p><code>LUDecompositionWithPartialPivoting</code> is similar in
functionality with the built-in <code>LUDecomposition</code>. It
implements a <em>partial pivoting</em> strategy in which the sorting can
be configured using the options listed below. It also applies to general
rectangular matrices as well as square matrices.</p>
<p>The triangular factors are recovered using <a
href="#GetLUMatrices">GetLUMatrices</a> or <a
href="#GetFullLUMatrices">GetFullLUMatrices</a>.</p>
<p>The following <code>options</code> can be given:</p>
<ul>
<li><code>ZeroTest</code> (<code>PossibleZeroQ</code>): function used to
decide if a pivot is zero;</li>
<li><code>RightDivide</code> (<code>Divide</code>): function used to
divide a vector by an entry;</li>
<li><code>Dot</code> (<code>Dot</code>): function used to multiply
vectors and matrices;</li>
<li><code>Pivoting</code> (<a
href="#LUPartialPivoting">LUPartialPivoting</a>): function used to sort
rows for pivoting;</li>
<li><code>SuppressPivoting</code> (<code>False</code>): whether to
perform pivoting or not.</li>
</ul>
<p>See also: <a
href="#LUDecompositionWithPartialPivoting">LUDecompositionWithPartialPivoting</a>,
<a
href="#LUDecompositionWithCompletePivoting">LUDecompositionWithCompletePivoting</a>,
<a href="#GetLUMatrices">GetLUMatrices</a>, <a
href="#GetFullLUMatrices">GetFullLUMatrices</a>, <a
href="#LUPartialPivoting">LUPartialPivoting</a>.</p>
<h3 data-number="11.3.2" id="LUDecompositionWithCompletePivoting"><span
class="header-section-number">11.3.2</span>
LUDecompositionWithCompletePivoting</h3>
<p><code>LUDecompositionWithCompletePivoting[m]</code> generates a
representation of the LU decomposition of the rectangular matrix
<code>m</code>.</p>
<p><code>LUDecompositionWithCompletePivoting[m, options]</code> uses
<code>options</code>.</p>
<p><code>LUDecompositionWithCompletePivoting</code> returns a list of
four elements:</p>
<ul>
<li>the first element is a combination of upper- and lower-triangular
matrices;</li>
<li>the second element is a vector specifying rows used for
pivoting;</li>
<li>the third element is a vector specifying columns used for
pivoting;</li>
<li>the fourth element is the rank of the matrix.</li>
</ul>
<p><code>LUDecompositionWithCompletePivoting</code> implements a
<em>complete pivoting</em> strategy in which the sorting can be
configured using the options listed below. It also applies to general
rectangular matrices as well as square matrices.</p>
<p>The triangular factors are recovered using <a
href="#GetLUMatrices">GetLUMatrices</a> or <a
href="#GetFullLUMatrices">GetFullLUMatrices</a>.</p>
<p>The following <code>options</code> can be given:</p>
<ul>
<li><code>ZeroTest</code> (<code>PossibleZeroQ</code>): function used to
decide if a pivot is zero;</li>
<li><code>Divide</code> (<code>Divide</code>): function used to divide a
vector by an entry;</li>
<li><code>Dot</code> (<code>Dot</code>): function used to multiply
vectors and matrices;</li>
<li><code>Pivoting</code> (<a
href="#LUCompletePivoting">LUCompletePivoting</a>): function used to
sort rows for pivoting;</li>
</ul>
<p>See also: LUDecomposition, <a
href="#GetLUMatrices">GetLUMatrices</a>, <a
href="#GetFullLUMatrices">GetFullLUMatrices</a>, <a
href="#LUCompletePivoting">LUCompletePivoting</a>, <a
href="#LUDecompositionWithPartialPivoting">LUDecompositionWithPartialPivoting</a>.</p>
<h3 data-number="11.3.3" id="LDLDecomposition"><span
class="header-section-number">11.3.3</span> LDLDecomposition</h3>
<p><code>LDLDecomposition[m]</code> generates a representation of the
LDL decomposition of the symmetric or self-adjoint matrix
<code>m</code>.</p>
<p><code>LDLDecomposition[m, options]</code> uses
<code>options</code>.</p>
<p><code>LDLDecomposition</code> returns a list of four elements:</p>
<ul>
<li>the first element is a combination of upper- and lower-triangular
matrices;</li>
<li>the second element is a vector specifying rows and columns used for
pivoting;</li>
<li>the third element is a vector specifying the size of the diagonal
blocks (entries can be either 1 or 2);</li>
<li>the fourth element is the rank of the matrix.</li>
</ul>
<p><code>LUDecompositionWithCompletePivoting</code> implements a
<em>Bunch-Parlett pivoting</em> strategy in which the sorting can be
configured using the options listed below. It applies only to square
symmetric or self-adjoint matrices.</p>
<p>The triangular factors are recovered using <a
href="#GetLDUMatrices">GetLDUMatrices</a> or <a
href="#GetFullLDUMatrices">GetFullLDUMatrices</a>.</p>
<p>The following <code>options</code> can be given:</p>
<ul>
<li><code>ZeroTest</code> (<code>PossibleZeroQ</code>): function used to
decide if a pivot is zero;</li>
<li><code>RightDivide</code> (<code>Divide</code>): function used to
divide a vector by an entry on the right;</li>
<li><code>LeftDivide</code> (<code>Divide</code>): function used to
divide a vector by an entry on the left;</li>
<li><code>Dot</code> (<code>Dot</code>): function used to multiply
vectors and matrices;</li>
<li><code>CompletePivoting</code> (<a
href="#LUCompletePivoting">LUCompletePivoting</a>): function used to
sort rows for complete pivoting;</li>
<li><code>PartialPivoting</code> (<a
href="#LUPartialPivoting">LUPartialPivoting</a>): function used to sort
matrices for complete pivoting;</li>
<li><code>Inverse</code> (<code>Inverse</code>): function used to invert
2x2 diagonal blocks;</li>
<li><code>SelfAdjointMatrixQ</code> (HermitianQ): function to test if
matrix is self-adjoint;</li>
<li><code>SuppressPivoting</code> (<code>False</code>): whether to
perform pivoting or not.</li>
</ul>
<p>See also: <a
href="#LUDecompositionWithPartialPivoting">LUDecompositionWithPartialPivoting</a>,
<a
href="#LUDecompositionWithCompletePivoting">LUDecompositionWithCompletePivoting</a>,
<a href="#GetLUMatrices">GetLUMatrices</a>, <a
href="#GetFullLDUMatrices">GetFullLDUMatrices</a>, <a
href="#LUCompletePivoting">LUCompletePivoting</a>, <a
href="#LUPartialPivoting">LUPartialPivoting</a>.</p>
<h3 data-number="11.3.4" id="UpperTriangularSolve"><span
class="header-section-number">11.3.4</span> UpperTriangularSolve</h3>
<p><code>UpperTriangularSolve[u, b]</code> solves the upper-triangular
system of equations <span class="math inline">\(u x = b\)</span> using
back-substitution.</p>
<p>For example:</p>
<pre><code>x = UpperTriangularSolve[u, b];</code></pre>
<p>returns the solution <code>x</code>.</p>
<p>See also: <a
href="#LUDecompositionWithPartialPivoting">LUDecompositionWithPartialPivoting</a>,
<a
href="#LUDecompositionWithCompletePivoting">LUDecompositionWithCompletePivoting</a>,
<a href="#LDLDecomposition">LDLDecomposition</a>.</p>
<h3 data-number="11.3.5" id="LowerTriangularSolve"><span
class="header-section-number">11.3.5</span> LowerTriangularSolve</h3>
<p><code>LowerTriangularSolve[l, b]</code> solves the lower-triangular
system of equations <span class="math inline">\(l x = b\)</span> using
forward-substitution.</p>
<p>For example:</p>
<pre><code>x = LowerTriangularSolve[l, b];</code></pre>
<p>returns the solution <code>x</code>.</p>
<p>See also: <a
href="#LUDecompositionWithPartialPivoting">LUDecompositionWithPartialPivoting</a>,
<a
href="#LUDecompositionWithCompletePivoting">LUDecompositionWithCompletePivoting</a>,
<a href="#LDLDecomposition">LDLDecomposition</a>.</p>
<h3 data-number="11.3.6" id="LUInverse"><span
class="header-section-number">11.3.6</span> LUInverse</h3>
<p><code>LUInverse[a]</code> calculates the inverse of matrix
<code>a</code>.</p>
<p><code>LUInverse</code> uses the <a
href="#LUDecompositionWithPartialPivoting">LUDecompositionWithPartialPivoting</a>
and the triangular solvers <a
href="#LowerTriangularSolve">LowerTriangularSolve</a> and <a
href="#UpperTriangularSolve">UpperTriangularSolve</a>.</p>
<p>See also: <a
href="#LUDecompositionWithPartialPivoting">LUDecompositionWithPartialPivoting</a>.</p>
<h3 data-number="11.3.7" id="GetLUMatrices"><span
class="header-section-number">11.3.7</span> GetLUMatrices</h3>
<p><code>GetLUMatrices[lu]</code> extracts lower- and upper-triangular
blocks produced by <code>LDUDecompositionWithPartialPivoting</code> and
<code>LDUDecompositionWithCompletePivoting</code>.</p>
<p><code>GetLUMatrices[lu, p, q, rank]</code> extracts compact lower-
and upper-triangular blocks produced by
<code>LDUDecompositionWithPartialPivoting</code> and
<code>LDUDecompositionWithCompletePivoting</code> taking into account
permutations and the matrix rank.</p>
<p>For example:</p>
<pre><code>{lu, p} = LUDecompositionWithPartialPivoting[mat];
{l, u} = GetLUMatrices[lu];</code></pre>
<p>and</p>
<pre><code>{lu, p, q, rank} = LUDecompositionWithCompletePivoting[mat];
{l, u} = GetLUMatrices[lu, p, q, rank];</code></pre>
<p>returns the lower-triangular factor <code>l</code> and
upper-triangular factor <code>u</code> as <code>SparseArray</code>s.</p>
<p>See also: <a
href="#LUDecompositionWithPartialPivoting">LUDecompositionWithPartialPivoting</a>,
<a
href="#LUDecompositionWithCompletePivoting">LUDecompositionWithCompletePivoting</a>,
<a href="#GetFullLUMatrices">GetFullLUMatrices</a>.</p>
<h3 data-number="11.3.8" id="GetFullLUMatrices"><span
class="header-section-number">11.3.8</span> GetFullLUMatrices</h3>
<p><code>GetFullLUMatrices[m]</code> extracts lower- and
upper-triangular blocks produced by
<code>LDUDecompositionWithPartialPivoting</code> and
<code>LDUDecompositionWithCompletePivoting</code>.</p>
<p><code>GetFullLUMatrices[lu, p, q, rank]</code> extracts compact
lower- and upper-triangular blocks produced by
<code>LDUDecompositionWithPartialPivoting</code> and
<code>LDUDecompositionWithCompletePivoting</code> taking into account
permutations and the matrix rank.</p>
<p><code>GetFullLUMatrices</code> is equivalent to
<code>Normal @@ GetLUMatrices</code></p>
<p>See also: <a href="#GetLUMatrices">GetLUMatrices</a>, <a
href="#LUDecompositionWithPartialPivoting">LUDecompositionWithPartialPivoting</a>,
<a
href="#LUDecompositionWithCompletePivoting">LUDecompositionWithCompletePivoting</a>.</p>
<h3 data-number="11.3.9" id="GetLDUMatrices"><span
class="header-section-number">11.3.9</span> GetLDUMatrices</h3>
<p><code>GetLDUMatrices[ldu, s]</code> extracts lower-, upper-triangular
and diagonal blocks produced by <code>LDLDecomposition</code>.</p>
<p><code>GetLDUMatrices[ldu, p, s, rank]</code> extracts compact lower-
and upper-triangular blocks produced by <code>LDLDecomposition</code>
taking into account permutations and the matrix rank.</p>
<p>For example:</p>
<pre><code>{ldl, p, s, rank} = LDLDecomposition[mat];
{l,d,u} = GetLDUMatrices[ldl,s];</code></pre>
<p>and</p>
<pre><code>{l, d, u} = GetLDUMatrices[ldl, p, s, rank];</code></pre>
<p>returns the lower-triangular factor <code>l</code>, the
upper-triangular factor <code>u</code>, and the block-diagonal factor
<code>d</code> as <code>SparseArray</code>s.</p>
<p>See also: <a href="#LDLDecomposition">LDLDecomposition</a>, <a
href="#GetFullLDUMatrices">GetFullLDUMatrices</a>.</p>
<h3 data-number="11.3.10" id="GetFullLDUMatrices"><span
class="header-section-number">11.3.10</span> GetFullLDUMatrices</h3>
<p><code>GetLDUMatrices[ldl, s]</code> extracts lower-, upper-triangular
and diagonal blocks produced by <code>LDLDecomposition</code>.</p>
<p><code>GetLDUMatrices[ldu, p, s, rank]</code> extracts compact lower-
and upper-triangular blocks produced by <code>LDLDecomposition</code>
taking into account permutations and the matrix rank.</p>
<p><code>GetFullLDUMatrices</code> is equivalent to
<code>Normal @@ GetLDUMatrices</code></p>
<p>See also: <a href="#LDLDecomposition">LDLDecomposition</a>, <a
href="#GetLDUMatrices">GetLDUMatrices</a>.</p>
<h3 data-number="11.3.11" id="GetDiagonal"><span
class="header-section-number">11.3.11</span> GetDiagonal</h3>
<p><code>GetDiagonal[m]</code> extracts the diagonal entries of matrix
<code>m</code>.</p>
<p><code>GetDiagonal[m, s]</code> extracts the block-diagonal entries of
matrix <code>m</code> with block size <code>s</code>.</p>
<p>For example:</p>
<pre><code>d = GetDiagonal[{{1,-1,0},{-1,2,0},{0,0,3}}];</code></pre>
<p>returns</p>
<pre><code>d = {1,2,3}</code></pre>
<p>and</p>
<pre><code>d = GetDiagonal[{{1,-1,0},{-1,2,0},{0,0,3}}, {2,1}];</code></pre>
<p>returns</p>
<pre><code>d = {{{1,-1},{-1,2}},3}</code></pre>
<p>See also: <a href="#LDLDecomposition">LDLDecomposition</a>.</p>
<h3 data-number="11.3.12" id="LUPartialPivoting"><span
class="header-section-number">11.3.12</span> LUPartialPivoting</h3>
<p><code>LUPartialPivoting[v]</code> returns the index of the element
with largest absolute value in the vector <code>v</code>. If
<code>v</code> is a matrix, it returns the index of the element with
largest absolute value in the first column.</p>
<p><code>LUPartialPivoting[v, f]</code> sorts with respect to the
function <code>f</code> instead of the absolute value.</p>
<p>See also: <a
href="#LUDecompositionWithPartialPivoting">LUDecompositionWithPartialPivoting</a>,
<a href="#LUCompletePivoting">LUCompletePivoting</a>.</p>
<h3 data-number="11.3.13" id="LUCompletePivoting"><span
class="header-section-number">11.3.13</span> LUCompletePivoting</h3>
<p><code>LUCompletePivoting[m]</code> returns the row and column index
of the element with largest absolute value in the matrix
<code>m</code>.</p>
<p><code>LUCompletePivoting[v, f]</code> sorts with respect to the
function <code>f</code> instead of the absolute value.</p>
<p>See also: <a
href="#LUDecompositionWithCompletePivoting">LUDecompositionWithCompletePivoting</a>,
<a href="#LUPartialPivoting">LUPartialPivoting</a>.</p>
<h3 data-number="11.3.14" id="LURowReduce"><span
class="header-section-number">11.3.14</span> LURowReduce</h3>
<h3 data-number="11.3.15" id="LURowReduceIncremental"><span
class="header-section-number">11.3.15</span> LURowReduceIncremental</h3>
<h1 data-number="12"
id="packages-for-pretty-output-testing-and-utilities"><span
class="header-section-number">12</span> Packages for pretty output,
testing, and utilities</h1>
<h2 data-number="12.1" id="PackageNCOutput"><span
class="header-section-number">12.1</span> NCOutput</h2>
<p><strong>NCOutput</strong> is a package that can be used to beautify
the display of noncommutative expressions. NCOutput does not alter the
internal representation of nc expressions, just the way they are
displayed on the screen.</p>
<p>Members are:</p>
<ul>
<li><a href="#NCSetOutput">NCSetOutput</a></li>
</ul>
<h3 data-number="12.1.1" id="NCSetOutput"><span
class="header-section-number">12.1.1</span> NCSetOutput</h3>
<p><code>NCSetOutput[options]</code> controls the display of expressions
in a special format without affecting the internal representation of the
expression.</p>
<p>The following <code>options</code> can be given:</p>
<ul>
<li><code>NonCommutativeMultiply</code> (<code>False</code>): If
<code>True</code> <code>x**y</code> is displayed as ‘<span
class="math inline">\(\mathrm{x} \bullet \mathrm{y}\)</span>’;</li>
<li><code>tp</code> (<code>True</code>): If <code>True</code>
<code>tp[x]</code> is displayed as ‘<span
class="math inline">\(\mathrm{x}^\mathrm{T}\)</span>’;</li>
<li><code>inv</code> (<code>True</code>): If <code>True</code>
<code>inv[x]</code> is displayed as ‘<span
class="math inline">\(\mathrm{x}^{-1}\)</span>’;</li>
<li><code>aj</code> (<code>True</code>): If <code>True</code>
<code>aj[x]</code> is displayed as ‘<span
class="math inline">\(\mathrm{x}^*\)</span>’;</li>
<li><code>co</code> (<code>True</code>): If <code>True</code>
<code>co[x]</code> is displayed as ‘<span
class="math inline">\(\bar{\mathrm{x}}\)</span>’;</li>
<li><code>rt</code> (<code>True</code>): If <code>True</code>
<code>rt[x]</code> is displayed as ‘<span
class="math inline">\(\mathrm{x}^{1/2}\)</span>’.</li>
<li><code>All</code>: Set all available options to <code>True</code> or
<code>False</code>.</li>
</ul>
<p>See also: <a href="#NCTeX">NCTex</a>, <a
href="#NCTeXForm">NCTexForm</a>.</p>
<h2 data-number="12.2" id="PackageNCTeX"><span
class="header-section-number">12.2</span> NCTeX</h2>
<p>Members are:</p>
<ul>
<li><a href="#NCTeX">NCTeX</a></li>
<li><a href="#NCRunDVIPS">NCRunDVIPS</a></li>
<li><a href="#NCRunLaTeX">NCRunLaTeX</a></li>
<li><a href="#NCRunPDFLaTeX">NCRunPDFLaTeX</a></li>
<li><a href="#NCRunPDFViewer">NCRunPDFViewer</a></li>
<li><a href="#NCRunPS2PDF">NCRunPS2PDF</a></li>
</ul>
<h3 data-number="12.2.1" id="NCTeX"><span
class="header-section-number">12.2.1</span> NCTeX</h3>
<p><code>NCTeX[expr]</code> typesets the LaTeX version of
<code>expr</code> produced with TeXForm or NCTeXForm using LaTeX.</p>
<h3 data-number="12.2.2" id="NCRunDVIPS"><span
class="header-section-number">12.2.2</span> NCRunDVIPS</h3>
<p><code>NCRunDVIPS[file]</code> run dvips on <code>file</code>.
Produces a ps output.</p>
<h3 data-number="12.2.3" id="NCRunLaTeX"><span
class="header-section-number">12.2.3</span> NCRunLaTeX</h3>
<p><code>NCRunLaTeX[file]</code> typesets the LaTeX <code>file</code>
with latex. Produces a dvi output.</p>
<h3 data-number="12.2.4" id="NCRunPDFLaTeX"><span
class="header-section-number">12.2.4</span> NCRunPDFLaTeX</h3>
<p><code>NCRunLaTeX[file]</code> typesets the LaTeX <code>file</code>
with pdflatex. Produces a pdf output.</p>
<h3 data-number="12.2.5" id="NCRunPDFViewer"><span
class="header-section-number">12.2.5</span> NCRunPDFViewer</h3>
<p><code>NCRunPDFViewer[file]</code> display pdf <code>file</code>.</p>
<h3 data-number="12.2.6" id="NCRunPS2PDF"><span
class="header-section-number">12.2.6</span> NCRunPS2PDF</h3>
<p><code>NCRunPS2PDF[file]</code> run pd2pdf on <code>file</code>.
Produces a pdf output.</p>
<h2 data-number="12.3" id="PackageNCTeXForm"><span
class="header-section-number">12.3</span> NCTeXForm</h2>
<p>Members are:</p>
<ul>
<li><a href="#NCTeXForm">NCTeXForm</a></li>
<li><a href="#NCTeXFormSetStarStar">NCTeXFormSetStarStar</a></li>
</ul>
<h3 data-number="12.3.1" id="NCTeXForm"><span
class="header-section-number">12.3.1</span> NCTeXForm</h3>
<p><code>NCTeXForm[expr]</code> prints a LaTeX version of
<code>expr</code>.</p>
<p>The format is compatible with AMS-LaTeX.</p>
<p>Should work better than the Mathematica <code>TeXForm</code> :)</p>
<h3 data-number="12.3.2" id="NCTeXFormSetStarStar"><span
class="header-section-number">12.3.2</span> NCTeXFormSetStarStar</h3>
<p><code>NCTeXFormSetStarStar[string]</code> replaces the standard ’**’
for <code>string</code> in noncommutative multiplications.</p>
<p>For example:</p>
<pre><code>NCTeXFormSetStarStar[&quot;.&quot;]</code></pre>
<p>uses a dot (<code>.</code>) to replace
<code>NonCommutativeMultiply</code>(<code>**</code>).</p>
<p>See also: <a href="#NCTeXFormSetStar">NCTeXFormSetStar</a>.</p>
<h3 data-number="12.3.3" id="NCTeXFormSetStar"><span
class="header-section-number">12.3.3</span> NCTeXFormSetStar</h3>
<p><code>NCTeXFormSetStar[string]</code> replaces the standard ’*’ for
<code>string</code> in noncommutative multiplications.</p>
<p>For example:</p>
<pre><code>NCTeXFormSetStar[&quot; &quot;]</code></pre>
<p>uses a space (<code></code>) to replace
<code>Times</code>(<code>*</code>).</p>
<p><a href="#NCTeXFormSetStarStar">NCTeXFormSetStarStar</a>.</p>
<h2 data-number="12.4" id="PackageNCRun"><span
class="header-section-number">12.4</span> NCRun</h2>
<p>Members are:</p>
<ul>
<li><a href="#NCRun">NCRun</a></li>
</ul>
<h3 data-number="12.4.1" id="NCRun"><span
class="header-section-number">12.4.1</span> NCRun</h3>
<p><code>NCRun[command]</code> is a replacement for the built-in
<code>Run</code> command that gives a bit more control over the
execution process.</p>
<p><code>NCRun[command, options]</code> uses <code>options</code>.</p>
<p>The following <code>options</code> can be given:</p>
<ul>
<li><code>Verbose</code> (<code>True</code>): print information on
command being run;</li>
<li><code>CommandPrefix</code> (<code>""</code>): prefix to
<code>command</code>;</li>
</ul>
<p>See also: <code>Run</code>.</p>
<h2 data-number="12.5" id="PackageNCTest"><span
class="header-section-number">12.5</span> NCTest</h2>
<p>These are commands for automatically testing if our algorithms
produce the correct answer. Problems and answers are stored under the
directory <code>NC/TESTING</code>.</p>
<p>Members are:</p>
<ul>
<li><a href="#NCTest">NCTest</a></li>
<li><a href="#NCTestCheck">NCTestCheck</a></li>
<li><a href="#NCTestRun">NCTestRun</a></li>
<li><a href="#NCTestSummarize">NCTestSummarize</a></li>
</ul>
<h3 data-number="12.5.1" id="NCTest"><span
class="header-section-number">12.5.1</span> NCTest</h3>
<p><code>NCTest[expr,answer]</code> asserts whether <code>expr</code> is
equal to <code>answer</code>. The result of the test is collected when
<code>NCTest</code> is run from <code>NCTestRun</code>.</p>
<p>See also: <a href="#NCTestCheck">NCTestCheck</a>, <a
href="#NCTestRun">NCTestRun</a>, <a
href="#NCTestSummarize">NCTestSummarize</a>.</p>
<h3 data-number="12.5.2" id="NCTestCheck"><span
class="header-section-number">12.5.2</span> NCTestCheck</h3>
<p><code>NCTestCheck[expr,messages]</code> evaluates <code>expr</code>
and asserts that the messages in <code>messages</code> have been issued.
The result of the test is collected when <code>NCTest</code> is run from
<code>NCTestRun</code>.</p>
<p><code>NCTestCheck[expr,answer,messages]</code> also asserts whether
<code>expr</code> is equal to <code>answer</code>.</p>
<p><code>NCTestCheck[expr,answer,messages,quiet]</code> quiets messages
in <code>quiet</code>.</p>
<p>See also: <a href="#NCTest">NCTest</a>, <a
href="#NCTestRun">NCTestRun</a>, <a
href="#NCTestSummarize">NCTestSummarize</a>.</p>
<h3 data-number="12.5.3" id="NCTestRun"><span
class="header-section-number">12.5.3</span> NCTestRun</h3>
<p><code>NCTest[list]</code> runs the test files listed in
<code>list</code> after appending the ‘.NCTest’ suffix and return the
results.</p>
<p>For example:</p>
<pre><code>results = NCTestRun[{&quot;NCCollect&quot;, &quot;NCSylvester&quot;}]</code></pre>
<p>will run the test files “NCCollect.NCTest” and “NCSylvester.NCTest”
and return the results in <code>results</code>.</p>
<p>See also: <a href="#NCTest">NCTest</a>, <a
href="#NCTestCheck">NCTestCheck</a>, <a
href="#NCTestSummarize">NCTestSummarize</a>.</p>
<h3 data-number="12.5.4" id="NCTestSummarize"><span
class="header-section-number">12.5.4</span> NCTestSummarize</h3>
<p><code>NCTestSummarize[results]</code> will print a summary of the
results in <code>results</code> as produced by
<code>NCTestRun</code>.</p>
<p>See also: <a href="#NCTestRun">NCTestRun</a>.</p>
<h2 data-number="12.6" id="PackageNCDebug"><span
class="header-section-number">12.6</span> NCDebug</h2>
<p>Members are:</p>
<ul>
<li><a href="#NCDebug">NCDebug</a></li>
</ul>
<h3 data-number="12.6.1" id="NCDebug"><span
class="header-section-number">12.6.1</span> NCDebug</h3>
<p><code>NCDebug[level, message]</code> prints the objects
<code>message</code> if level is higher than the current
<code>DebugLevel</code> option.</p>
<p>Use <code>SetOptions[NCDebug, DebugLevel -&gt; level]</code> to set
up the current debug level.</p>
<p>Available options are:</p>
<ul>
<li><code>DebugLevel</code> (0): current debug level;</li>
<li><code>DebugLogFile</code> (<code>$Ouput</code>): current file to
which messages are printed.</li>
</ul>
<h2 data-number="12.7" id="PackageNCUtil"><span
class="header-section-number">12.7</span> NCUtil</h2>
<p><strong>NCUtil</strong> is a package with a collection of utilities
used throughout NCAlgebra.</p>
<p>Members are:</p>
<ul>
<li><a href="#NCGrabSymbols">NCGrabSymbols</a></li>
<li><a href="#NCGrabNCSymbols">NCGrabNCSymbols</a></li>
<li><a href="#NCGrabFunctions">NCGrabFunctions</a></li>
<li><a href="#NCGrabIndeterminants">NCGrabIndeterminants</a></li>
<li><a href="#NCVariables">NCVariables</a></li>
<li><a href="#NCConsolidateList">NCConsolidateList</a></li>
<li><a href="#NCConsistentQ">NCConsistentQ</a></li>
<li><a href="#NCSymbolOrSubscriptQ">NCSymbolOrSubscriptQ</a></li>
<li><a
href="#NCSymbolOrSubscriptExtendedQ">NCSymbolOrSubscriptExtendedQ</a></li>
<li><a href="#NCLeafCount">NCLeafCount</a></li>
<li><a href="#NCReplaceData">NCReplaceData</a></li>
<li><a href="#NCToExpression">NCToExpression</a></li>
<li><a href="#NotMatrixQ">NotMatrixQ</a></li>
</ul>
<h3 data-number="12.7.1" id="NCGrabSymbols"><span
class="header-section-number">12.7.1</span> NCGrabSymbols</h3>
<p><code>NCGrabSymbols[expr]</code> returns a list with all
<em>Symbols</em> appearing in <code>expr</code>.</p>
<p><code>NCGrabSymbols[expr,f]</code> returns a list with all
<em>Symbols</em> appearing in <code>expr</code> as the single argument
of function <code>f</code>.</p>
<p>For example:</p>
<pre><code>NCGrabSymbols[inv[x] + y**inv[1+inv[1+x**y]]]</code></pre>
<p>returns <code>{x,y}</code> and</p>
<pre><code>NCGrabSymbols[inv[x] + y**inv[1+inv[1+x**y]], inv]</code></pre>
<p>returns <code>{inv[x]}</code>.</p>
<p>See also: <a href="#NCGrabFunctions">NCGrabFunctions</a>, <a
href="#NCGrabNCSymbols">NCGrabNCSymbols</a>.</p>
<h3 data-number="12.7.2" id="NCGrabNCSymbols"><span
class="header-section-number">12.7.2</span> NCGrabNCSymbols</h3>
<p><code>NCGrabSymbols[expr]</code> returns a list with all NC
<em>Symbols</em> appearing in <code>expr</code>.</p>
<p><code>NCGrabSymbols[expr,f]</code> returns a list with all NC
<em>Symbols</em> appearing in <code>expr</code> as the single argument
of function <code>f</code>.</p>
<p>See also: <a href="#NCGrabSymbols">NCGrabSymbols</a>, <a
href="#NCGrabFunctions">NCGrabFunctions</a>.</p>
<h3 data-number="12.7.3" id="NCGrabFunctions"><span
class="header-section-number">12.7.3</span> NCGrabFunctions</h3>
<p><code>NCGrabFunctions[expr]</code> returns a list with all fragments
of <code>expr</code> containing functions.</p>
<p><code>NCGrabFunctions[expr,f]</code> returns a list with all
fragments of <code>expr</code> containing the function
<code>f</code>.</p>
<p>For example:</p>
<pre><code>NCGrabFunctions[inv[x] + tp[y]**inv[1+inv[1+tp[x]**y]], inv]</code></pre>
<p>returns</p>
<pre><code>{inv[1+inv[1+tp[x]**y]], inv[1+tp[x]**y], inv[x]}</code></pre>
<p>and</p>
<pre><code>NCGrabFunctions[inv[x] + tp[y]**inv[1+inv[1+tp[x]**y]]]</code></pre>
<p>returns</p>
<pre><code>{inv[1+inv[1+tp[x]**y]], inv[1+tp[x]**y], inv[x], tp[x], tp[y]}</code></pre>
<p>See also: <a href="#NCGrabSymbols">NCGrabSymbols</a>.</p>
<h3 data-number="12.7.4" id="NCGrabIndeterminants"><span
class="header-section-number">12.7.4</span> NCGrabIndeterminants</h3>
<p><code>NCGrabIndeterminants[expr]</code> returns a list with first
level symbols and nc expressions involved in sums and nc products in
<code>expr</code>.</p>
<p>For example:</p>
<pre><code>NCGrabIndeterminants[y - inv[x] + tp[y]**inv[1+inv[1+tp[x]**y]]]</code></pre>
<p>returns</p>
<pre><code>{y, inv[x], inv[1 + inv[1 + tp[x] ** y]], tp[y]}</code></pre>
<p>See also: <a href="#NCGrabFunctions">NCGrabFunctions</a>, <a
href="#NCGrabSymbols">NCGrabSymbols</a>.</p>
<h3 data-number="12.7.5" id="NCVariables"><span
class="header-section-number">12.7.5</span> NCVariables</h3>
<p><code>NCVariables[expr]</code> gives a list of all independent nc
variables in the expression <code>expr</code>.</p>
<p>For example:</p>
<pre><code>NCVariables[B + A y ** x ** y - 2 x]</code></pre>
<p>returns</p>
<pre><code>{x,y}</code></pre>
<p>See also: <a href="#NCGrabSymbols">NCGrabSymbols</a>.</p>
<h3 data-number="12.7.6" id="NCConsolidateList"><span
class="header-section-number">12.7.6</span> NCConsolidateList</h3>
<p><code>NCConsolidateList[list]</code> produces two lists:</p>
<ul>
<li>The first list contains a version of <code>list</code> where
repeated entries have been suppressed;</li>
<li>The second list contains the indices of the elements in the first
list that recover the original <code>list</code>.</li>
</ul>
<p>For example:</p>
<pre><code>{list,index} = NCConsolidateList[{z,t,s,f,d,f,z}];</code></pre>
<p>results in:</p>
<pre><code>list = {z,t,s,f,d};
index = {1,2,3,4,5,4,1};</code></pre>
<p>See also: <code>Union</code></p>
<h3 data-number="12.7.7" id="NCConsistentQ"><span
class="header-section-number">12.7.7</span> NCConsistentQ</h3>
<p><code>NCConsistentQ[expr]</code> returns <em>True</em> is
<code>expr</code> contains no commutative products or inverses involving
noncommutative variables.</p>
<h3 data-number="12.7.8" id="NCSymbolOrSubscriptQ"><span
class="header-section-number">12.7.8</span> NCSymbolOrSubscriptQ</h3>
<p><code>NCSymbolOrSubscriptQ[expr]</code> returns <em>True</em> if
<code>expr</code> is a symbol or a symbol subscript.</p>
<p>See also: <a
href="#NCSymbolOrSubscriptExtendedQ">NCSymbolOrSubscriptExtendedQ</a>,
<a
href="#NCNonCommutativeSymbolOrSubscriptQ">NCNonCommutativeSymbolOrSubscriptQ</a>,
<a
href="#NCNonCommutativeSymbolOrSubscriptExtendedQ">NCNonCommutativeSymbolOrSubscriptExtendedQ</a>,
<a href="#NCPowerQ">NCPowerQ</a>.</p>
<h3 data-number="12.7.9" id="NCSymbolOrSubscriptExtendedQ"><span
class="header-section-number">12.7.9</span>
NCSymbolOrSubscriptExtendedQ</h3>
<p><code>NCSymbolOrSubscriptExtendedQ[expr]</code> returns <em>True</em>
if <code>expr</code> is a symbol, a symbol subscript, or the transpose
(<code>tp</code>) or adjoint (<code>aj</code>) of a symbol or symbol
subscript.</p>
<p>See also: <a href="#NCSymbolOrSubscriptQ">NCSymbolOrSubscriptQ</a>,
<a
href="#NCNonCommutativeSymbolOrSubscriptQ">NCNonCommutativeSymbolOrSubscriptQ</a>,
<a
href="#NCNonCommutativeSymbolOrSubscriptExtendedQ">NCNonCommutativeSymbolOrSubscriptExtendedQ</a>,
<a href="#NCPowerQ">NCPowerQ</a>.</p>
<h3 data-number="12.7.10" id="NCLeafCount"><span
class="header-section-number">12.7.10</span> NCLeafCount</h3>
<p><code>NCLeafCount[expr]</code> returns an number associated with the
complexity of an expression:</p>
<ul>
<li>If <code>PossibleZeroQ[expr] == True</code> then
<code>NCLeafCount[expr]</code> is <code>-Infinity</code>;</li>
<li>If <code>NumberQ[expr]] == True</code> then
<code>NCLeafCount[expr]</code> is <code>Abs[expr]</code>;</li>
<li>Otherwise <code>NCLeafCount[expr]</code> is
<code>-LeafCount[expr]</code>;</li>
</ul>
<p><code>NCLeafCount</code> is <code>Listable</code>.</p>
<p>See also: <code>LeafCount</code>.</p>
<h3 data-number="12.7.11" id="NCReplaceData"><span
class="header-section-number">12.7.11</span> NCReplaceData</h3>
<p><code>NCReplaceData[expr, rules]</code> applies <code>rules</code> to
<code>expr</code> and convert resulting expression to standard
Mathematica, for example replacing <code>**</code> by
<code>.</code>.</p>
<p><code>NCReplaceData</code> does not attempt to resize entries in
expressions involving matrices. Use <code>NCToExpression</code> for
that.</p>
<p>See also: <a href="#NCToExpression">NCToExpression</a>.</p>
<h3 data-number="12.7.12" id="NCToExpression"><span
class="header-section-number">12.7.12</span> NCToExpression</h3>
<p><code>NCToExpression[expr, rules]</code> applies <code>rules</code>
to <code>expr</code> and convert resulting expression to standard
Mathematica.</p>
<p><code>NCToExpression</code> attempts to resize entries in expressions
involving matrices.</p>
<p>See also: <a href="#NCReplaceData">NCReplaceData</a>.</p>
<h3 data-number="12.7.13" id="NotMatrixQ"><span
class="header-section-number">12.7.13</span> NotMatrixQ</h3>
<p><code>NotMatrixQ[expr]</code> is equivalent to
<code>Not[MatrixQ[expr]]</code>.</p>
<p>See also: <code>MatrixQ</code>.</p>
<h1 data-number="13" id="data-structures-for-fast-calculations"><span
class="header-section-number">13</span> Data structures for fast
calculations</h1>
<p>This chapter describes packages that handle special data structures
that enable fast calculations in Mathematica.</p>
<h2 data-number="13.1" id="PackageNCPoly"><span
class="header-section-number">13.1</span> NCPoly</h2>
<h3 data-number="13.1.1"
id="efficient-storage-of-nc-polynomials-with-rational-coefficients"><span
class="header-section-number">13.1.1</span> Efficient storage of NC
polynomials with rational coefficients</h3>
<p>Members are:</p>
<ul>
<li>Constructors
<ul>
<li><a href="#NCPoly">NCPoly</a></li>
<li><a href="#NCPolyMonomial">NCPolyMonomial</a></li>
<li><a href="#NCPolyConstant">NCPolyConstant</a></li>
<li><a href="#NCPolyConvert">NCPolyConvert</a></li>
<li><a
href="#NCPolyFromCoefficientArray">NCPolyFromCoefficientArray</a></li>
<li><a href="#NCPolyFromGramMatrix">NCPolyFromGramMatrix</a></li>
<li><a
href="#NCPolyFromGramMatrixFactors">NCPolyFromGramMatrixFactors</a></li>
</ul></li>
<li>Access and utilities
<ul>
<li><a href="#NCPolyMonomialQ">NCPolyMonomialQ</a></li>
<li><a href="#NCPolyDegree">NCPolyDegree</a></li>
<li><a href="#NCPolyPartialDegree">NCPolyPartialDegree</a></li>
<li><a href="#NCPolyMonomialDegree">NCPolyMonomialDegree</a></li>
<li><a href="#NCPolyNumberOfVariables">NCPolyNumberOfVariables</a></li>
<li><a href="#NCPolyNumberOfTerms">NCPolyNumberOfTerms</a></li>
<li><a href="#NCPolyCoefficient">NCPolyCoefficient</a></li>
<li><a href="#NCPolyCoefficientArray">NCPolyCoefficientArray</a></li>
<li><a href="#NCPolyGramMatrix">NCPolyGramMatrix</a></li>
<li><a href="#NCPolyGetCoefficients">NCPolyGetCoefficients</a></li>
<li><a href="#NCPolyGetDigits">NCPolyGetDigits</a></li>
<li><a href="#NCPolyGetIntegers">NCPolyGetIntegers</a></li>
<li><a href="#NCPolyLeadingMonomial">NCPolyLeadingMonomial</a></li>
<li><a href="#NCPolyLeadingTerm">NCPolyLeadingTerm</a></li>
<li><a href="#NCPolyOrderType">NCPolyOrderType</a></li>
<li><a href="#NCPolyToRule">NCPolyToRule</a></li>
<li><a href="#NCPolyTermsOfDegree">NCPolyTermsOfDegree</a></li>
<li><a
href="#NCPolyTermsOfTotalDegree">NCPolyTermsOfTotalDegree</a></li>
<li><a href="#NCPolyQuadraticTerms">NCPolyQuadraticTerms</a></li>
<li><a href="#NCPolyQuadraticChipset">NCPolyQuadraticChipset</a></li>
<li><a href="#NCPolyReverseMonomials">NCPolyReverseMonomials</a></li>
<li><a href="#NCPolyGetOptions">NCPolyGetOptions</a></li>
</ul></li>
<li>Formatting
<ul>
<li><a href="#NCPolyDisplay">NCPolyDisplay</a></li>
<li><a href="#NCPolyDisplayOrder">NCPolyDisplayOrder</a></li>
</ul></li>
<li>Arithmetic
<ul>
<li><a href="#NCPolyDivideDigits">NCPolyDivideDigits</a></li>
<li><a href="#NCPolyDivideLeading">NCPolyDivideLeading</a></li>
<li><a href="#NCPolyReduceRepeated">NCPolyReduceRepeated</a></li>
<li><a href="#NCPolyNormalize">NCPolyNormalize</a></li>
<li><a href="#NCPolyProduct">NCPolyProduct</a></li>
<li><a href="#NCPolyQuotientExpand">NCPolyQuotientExpand</a></li>
<li><a href="#NCPolyReduce">NCPolyReduce</a></li>
<li><a href="#NCPolySum">NCPolySum</a></li>
</ul></li>
<li>State space realization
<ul>
<li><a href="#NCPolyHankelMatrix">NCPolyHankelMatrix</a></li>
<li><a href="#NCPolyRealization">NCPolyRealization</a>
(#NCPolyRealization)</li>
</ul></li>
<li>Auxiliary functions
<ul>
<li><a href="#NCPolyVarsToIntegers">NCPolyVarsToIntegers</a></li>
<li><a href="#NCFromDigits">NCFromDigits</a></li>
<li><a href="#NCIntegerDigits">NCIntegerDigits</a></li>
<li><a href="#NCIntegerReverse">NCIntegerReverse</a></li>
<li><a href="#NCDigitsToIndex">NCDigitsToIndex</a></li>
<li><a href="#NCPadAndMatch">NCPadAndMatch</a></li>
</ul></li>
</ul>
<h3 data-number="13.1.2" id="ways-to-represent-nc-polynomials"><span
class="header-section-number">13.1.2</span> Ways to represent NC
polynomials</h3>
<h4 data-number="13.1.2.1" id="NCPoly"><span
class="header-section-number">13.1.2.1</span> NCPoly</h4>
<p><code>NCPoly[coeff, monomials, vars]</code> constructs a
noncommutative polynomial object in variables <code>vars</code> where
the monomials have coefficient <code>coeff</code>.</p>
<p>Monomials are specified in terms of the symbols in the list
<code>vars</code> as in <a
href="#NCPolyMonomial">NCPolyMonomial</a>.</p>
<p>For example:</p>
<pre><code>vars = {x,y,z};
poly = NCPoly[{-1, 2}, {{x,y,x}, {z}}, vars];</code></pre>
<p>constructs an object associated with the noncommutative polynomial
<span class="math inline">\(2 z - x y x\)</span> in variables
<code>x</code>, <code>y</code> and <code>z</code>.</p>
<p>The internal representation varies with the implementation but it is
so that the terms are sorted according to a degree-lexicographic order
in <code>vars</code>. In the above example,
<code>x &lt; y &lt; z</code>.</p>
<p>The construction:</p>
<pre><code>vars = {{x},{y,z}};
poly = NCPoly[{-1, 2}, {{x,y,x}, {z}}, vars];</code></pre>
<p>represents the same polyomial in a graded degree-lexicographic order
in <code>vars</code>, in this example,
<code>x &lt;&lt; y &lt; z</code>.</p>
<p>See also: <a href="#NCPolyMonomial">NCPolyMonomial</a>, <a
href="#NCIntegerDigits">NCIntegerDigits</a>, <a
href="#NCFromDigits">NCFromDigits</a>.</p>
<h4 data-number="13.1.2.2" id="NCPolyMonomial"><span
class="header-section-number">13.1.2.2</span> NCPolyMonomial</h4>
<p><code>NCPolyMonomial[monomial, vars]</code> constructs a
noncommutative monomial object in variables <code>vars</code>.</p>
<p>Monic monomials are specified in terms of the symbols in the list
<code>vars</code>, for example:</p>
<pre><code>vars = {x,y,z};
mon = NCPolyMonomial[{x,y,x},vars];</code></pre>
<p>returns an <code>NCPoly</code> object encoding the monomial <span
class="math inline">\(xyx\)</span> in noncommutative variables
<code>x</code>,<code>y</code>, and <code>z</code>. The actual
representation of <code>mon</code> varies with the implementation.</p>
<p>Monomials can also be specified implicitly using indices, for
example:</p>
<pre><code>mon = NCPolyMonomial[{0,1,0}, 3];</code></pre>
<p>also returns an <code>NCPoly</code> object encoding the monomial
<span class="math inline">\(xyx\)</span> in noncommutative variables
<code>x</code>,<code>y</code>, and <code>z</code>.</p>
<p>If graded ordering is supported then</p>
<pre><code>vars = {{x},{y,z}};
mon = NCPolyMonomial[{x,y,x},vars];</code></pre>
<p>or</p>
<pre><code>mon = NCPolyMonomial[{0,1,0}, {1,2}];</code></pre>
<p>construct the same monomial <span class="math inline">\(xyx\)</span>
in noncommutative variables <code>x</code>,<code>y</code>, and
<code>z</code> this time using a graded order in which
<code>x &lt;&lt; y &lt; z</code>.</p>
<p>There is also an alternative syntax for <code>NCPolyMonomial</code>
that allows users to input the monomial along with a coefficient using
rules and the output of <a href="#NCFromDigits">NCFromDigits</a>. For
example:</p>
<pre><code>mon = NCPolyMonomial[{3, 3} -&gt; -2, 3];</code></pre>
<p>or</p>
<pre><code>mon = NCPolyMonomial[NCFromDigits[{0,1,0}, 3] -&gt; -2, 3];</code></pre>
<p>represent the monomial <span class="math inline">\(-2 xyx\)</span>
that has coefficient <code>-2</code>.</p>
<p>See also: <a href="#NCPoly">NCPoly</a>, <a
href="#NCIntegerDigits">NCIntegerDigits</a>, <a
href="#NCFromDigits">NCFromDigits</a>.</p>
<h4 data-number="13.1.2.3" id="NCPolyConstant"><span
class="header-section-number">13.1.2.3</span> NCPolyConstant</h4>
<p><code>NCPolyConstant[value, vars]</code> constructs a noncommutative
monomial object in variables <code>vars</code> representing the constant
<code>value</code>.</p>
<p>For example:</p>
<pre><code>NCPolyConstant[3, {x, y, z}]</code></pre>
<p>constructs an object associated with the constant <code>3</code> in
variables <code>x</code>, <code>y</code> and <code>z</code>.</p>
<p>See also: <a href="#NCPoly">NCPoly</a>, <a
href="#NCPolyMonomial">NCPolyMonomial</a>.</p>
<h4 data-number="13.1.2.4" id="NCPolyConvert"><span
class="header-section-number">13.1.2.4</span> NCPolyConvert</h4>
<p><code>NCPolyConvert[poly, vars]</code> convert NCPoly
<code>poly</code> to the ordering implied by <code>vars</code>.</p>
<p>For example, if</p>
<pre><code>vars1 = {{x, y, z}};
coeff = {1, 2, 3, -1, -2, -3, 1/2};
mon = {{}, {x}, {z}, {x, y}, {x, y, x, x}, {z, x}, {z, z, z, z}};
poly1 = NCPoly[coeff, mon, vars1];</code></pre>
<p>with respect to the ordering</p>
<p><span class="math inline">\(x \ll y \ll z\)</span></p>
<p>then</p>
<pre><code>vars2 = {{x},{y,z}};
poly2 = NCPolyConvert[poly, vars];</code></pre>
<p>is the same polynomial as <code>poly1</code> but in the ordering</p>
<p><span class="math inline">\(x \ll y &lt; z\)</span></p>
<p>See also: <a href="#NCPoly">NCPoly</a>, <a
href="#NCPolyCoefficient">NCPolyCoefficient</a>.</p>
<h4 data-number="13.1.2.5" id="NCPolyFromCoefficientArray"><span
class="header-section-number">13.1.2.5</span>
NCPolyFromCoefficientArray</h4>
<p><code>NCPolyFromCoefficientArray[mat, vars]</code> returns an
<code>NCPoly</code> constructed from the coefficient array
<code>mat</code> in variables <code>vars</code>.</p>
<p>For example, for <code>mat</code> equal to the
<code>SparseArray</code> corresponding to the rules:</p>
<pre><code>{{1} -&gt; 1, {2} -&gt; 2, {6} -&gt; -1, {50} -&gt; -2, {4} -&gt; 3, {11} -&gt; -3, {121} -&gt; 1/2}</code></pre>
<p>the commands</p>
<pre><code>vars = {{x},{y,z}};
NCPolyFromCoefficientArray[mat, vars]</code></pre>
<p>return</p>
<pre><code>NCPoly[{1, 2}, &lt;|{0, 0, 0} -&gt; 1, {0, 1, 0} -&gt; 2, {1, 0, 2} -&gt; 3, {1, 1, 1} -&gt; -1,
       {1, 1, 6} -&gt; -3, {1, 3, 9} -&gt; -2, {4, 0, 80} -&gt; 1/2|&gt;]</code></pre>
<p>See also: <a
href="#NCPolyCoefficientArray">NCPolyCoefficientArray</a>, <a
href="#NCPolyCoefficient">NCPolyCoefficient</a>.</p>
<h4 data-number="13.1.2.6" id="NCPolyFromGramMatrix"><span
class="header-section-number">13.1.2.6</span> NCPolyFromGramMatrix</h4>
<p><code>NCPolyFromGramMatrix[mat, vars]</code> returns an
<code>NCPoly</code> constructed from the Gram matrix <code>mat</code> in
variables <code>vars</code>.</p>
<p>For example, for <code>mat</code> equal to the
<code>SparseArray</code> corresponding to the rules:</p>
<pre><code>{{1, 1} -&gt; 1, {2, 1} -&gt; 2, {2, 3} -&gt; -1, {4, 1} -&gt; 3, {4, 2} -&gt; -3, {6, 5} -&gt; -2, {13, 13} -&gt; 1/2}</code></pre>
<p>the commands</p>
<pre><code>vars = {{x},{y,z}};
NCPolyFromGramMatrix[mat, vars]</code></pre>
<p>return</p>
<pre><code>NCPoly[{1, 2}, &lt;|{0, 0, 0} -&gt; 1, {0, 1, 0} -&gt; 2, {1, 0, 2} -&gt; 3, {1, 1, 1} -&gt; -1,
       {1, 1, 6} -&gt; -3, {1, 3, 9} -&gt; -2, {4, 0, 80} -&gt; 1/2|&gt;]</code></pre>
<p>See also: <a href="#NCPolyGramMatrix">NCPolyGramMatrix</a>, <a
href="#NCPolyFromGramMatrixFactors">NCPolyFromGramMatrixFactors</a>.</p>
<h4 data-number="13.1.2.7" id="NCPolyFromGramMatrixFactors"><span
class="header-section-number">13.1.2.7</span>
NCPolyFromGramMatrixFactors</h4>
<p><code>NCPolyFromGramMatrixFactors[lmat, rmat, vars]</code> returns
two lists of <code>NCPoly</code>s constructed from the factors of the
Gram matrix <code>lmat</code> and <code>rmat</code> in variables
<code>vars</code>.</p>
<p>For example, for <code>mat = lmat . rmat</code> in which the factors
<code>lmat</code> and <code>rmat</code> are <code>SparseArray</code>s
corresponding to the rules:</p>
<pre><code>{{1, 3} -&gt; 1/2, {1, 5} -&gt; 1, {2, 3} -&gt; 1, {4, 1} -&gt; 1, {6, 2} -&gt; 1, {13, 4} -&gt; 1}
{{1, 2} -&gt; -3, {1, 1} -&gt; 3, {2, 5} -&gt; -2, {3, 1} -&gt; 2, {3, 3} -&gt; -1, {4, 13} -&gt; 1/2, {5, 3} -&gt; 1/2}</code></pre>
<p>and commands</p>
<pre><code>vars = {{x},{y,z}};
{lpoly, rpoly} = NCPolyFromGramMatrixFactors[lmat, rmat, vars]</code></pre>
<p>return <code>lpoly</code> equal to the list of polynomials</p>
<pre><code>{NCPoly[{1, 2}, &lt;|{1, 0, 1} -&gt; 1|&gt;], NCPoly[{1, 2}, &lt;|{1, 1, 6} -&gt; 1|&gt;], NCPoly[{1, 2}, &lt;|{0, 0, 0} -&gt; 1/2, {1, 0, 2} -&gt; 1|&gt;], NCPoly[{1, 2}, &lt;|{2, 0, 4} -&gt; 1|&gt;], NCPoly[{1, 2}, &lt;|{0, 0, 0} -&gt; 1|&gt;]},</code></pre>
<p>and <code>rpoly</code> equal to</p>
<pre><code>{NCPoly[{1, 2}, &lt;|{0, 0, 0} -&gt; 3, {1, 0, 2} -&gt; -3|&gt;], NCPoly[{1, 2}, &lt;|{2, 0, 7} -&gt; -2|&gt;], NCPoly[{1, 2}, &lt;|{0, 0, 0} -&gt; 2, {0, 1, 0} -&gt; -1|&gt;], NCPoly[{1, 2}, &lt;|{2, 0, 4} -&gt; 1/2|&gt;], NCPoly[{1, 2}, &lt;|{0, 1, 0} -&gt; 1/2|&gt;]}}</code></pre>
<p>See also: <a href="#NCPolyFromGramMatrix">NCPolyFromGramMatrix</a>,
<a href="#NCPolyGramMatrix">NCPolyGramMatrix</a>.</p>
<h3 data-number="13.1.3" id="access-and-utlity-functions"><span
class="header-section-number">13.1.3</span> Access and utlity
functions</h3>
<h4 data-number="13.1.3.1" id="NCPolyMonomialQ"><span
class="header-section-number">13.1.3.1</span> NCPolyMonomialQ</h4>
<p><code>NCPolyMonomialQ[poly]</code> returns <code>True</code> if
<code>poly</code> is a <code>NCPoly</code> monomial.</p>
<p>See also: <a href="#NCPoly">NCPoly</a>, <a
href="#NCPolyMonomial">NCPolyMonomial</a>.</p>
<h4 data-number="13.1.3.2" id="NCPolyDegree"><span
class="header-section-number">13.1.3.2</span> NCPolyDegree</h4>
<p><code>NCPolyDegree[poly]</code> returns the degree of the nc
polynomial <code>poly</code>.</p>
<p>See also: <a href="#NCPolyPartialDegree">NCPolyPartialDegree</a></p>
<h4 data-number="13.1.3.3" id="NCPolyPartialDegree"><span
class="header-section-number">13.1.3.3</span> NCPolyPartialDegree</h4>
<p><code>NCPolyPartialDegree[poly]</code> returns the maximum degree
appearing in the monomials of the nc polynomial <code>poly</code>.</p>
<p>See also: <a href="#NCPolyDegree">NCPolyDegree</a></p>
<h4 data-number="13.1.3.4" id="NCPolyMonomialDegree"><span
class="header-section-number">13.1.3.4</span> NCPolyMonomialDegree</h4>
<p><code>NCPolyMonomialDegree[poly]</code> returns the partial degree of
each symbol appearing in the monomials of the nc polynomial
<code>poly</code>.</p>
<p>See also: <a href="#NCPolyDegree">NCPolyDegree</a></p>
<h4 data-number="13.1.3.5" id="NCPolyNumberOfVariables"><span
class="header-section-number">13.1.3.5</span>
NCPolyNumberOfVariables</h4>
<p><code>NCPolyNumberOfVariables[poly]</code> returns the number of
variables of the nc polynomial <code>poly</code>.</p>
<h4 data-number="13.1.3.6" id="NCPolyNumberOfTerms"><span
class="header-section-number">13.1.3.6</span> NCPolyNumberOfTerms</h4>
<p><code>NCPolyNumberOfTerms[poly]</code> returns the number of terms of
the nc polynomial <code>poly</code>.</p>
<h4 data-number="13.1.3.7" id="NCPolyCoefficient"><span
class="header-section-number">13.1.3.7</span> NCPolyCoefficient</h4>
<p><code>NCPolyCoefficient[poly, mon]</code> returns the coefficient of
the monomial <code>mon</code> in the nc polynomial
<code>poly</code>.</p>
<p>For example, in:</p>
<pre><code>coeff = {1, 2, 3, -1, -2, -3, 1/2};
mon = {{}, {x}, {z}, {x, y}, {x, y, x, x}, {z, x}, {z, z, z, z}};
vars = {x,y,z};
poly = NCPoly[coeff, mon, vars];

c = NCPolyCoefficient[poly, NCPolyMonomial[{x,y},vars]];</code></pre>
<p>returns</p>
<pre><code>c = -1</code></pre>
<p>See also: <a href="#NCPoly">NCPoly</a>, <a
href="#NCPolyMonomial">NCPolyMonomial</a>.</p>
<h4 data-number="13.1.3.8" id="NCPolyCoefficientArray"><span
class="header-section-number">13.1.3.8</span>
NCPolyCoefficientArray</h4>
<p><code>NCPolyCoefficientArray[poly]</code> returns a coefficient array
corresponding to the monomials in the nc polynomial
<code>poly</code>.</p>
<p>For example:</p>
<pre><code>coeff = {1, 2, 3, -1, -2, -3, 1/2};
mon = {{}, {x}, {z}, {x, y}, {x, y, x, x}, {z, x}, {z, z, z, z}};
vars = {x,y,z};
poly = NCPoly[coeff, mon, vars];

mat = NCPolyCoefficient[poly];</code></pre>
<p>returns <code>mat</code> as a <code>SparseArray</code> corresponding
to the rules:</p>
<pre><code>{{1} -&gt; 1, {2} -&gt; 2, {6} -&gt; -1, {50} -&gt; -2, {4} -&gt; 3, {11} -&gt; -3, {121} -&gt; 1/2}</code></pre>
<p>See also: <a
href="#NCPolyFromCoefficientArray">NCPolyFromCoefficientArray</a>, <a
href="#NCPolyCoefficient">NCPolyCoefficient</a>.</p>
<h4 data-number="13.1.3.9" id="NCPolyGramMatrix"><span
class="header-section-number">13.1.3.9</span> NCPolyGramMatrix</h4>
<p><code>NCPolyGramMatrix[poly]</code> returns a Gram matrix
corresponding to the monomials in the nc polynomial
<code>poly</code>.</p>
<p>For example:</p>
<pre><code>coeff = {1, 2, 3, -1, -2, -3, 1/2};
mon = {{}, {x}, {z}, {x, y}, {x, y, x, x}, {z, x}, {z, z, z, z}};
vars = {x,y,z};
poly = NCPoly[coeff, mon, vars];

mat = NCPolyGramMatrix[poly];</code></pre>
<p>returns <code>mat</code> as a <code>SparseArray</code> corresponding
to the rules:</p>
<pre><code>{{1, 1} -&gt; 1, {2, 1} -&gt; 2, {2, 3} -&gt; -1, {4, 1} -&gt; 3, {4, 2} -&gt; -3, {6, 5} -&gt; -2, {13, 13} -&gt; 1/2}</code></pre>
<p>See also: <a
href="#NCPolyFromGramMatrix">NCPolyFromGramMatrix</a>.</p>
<h4 data-number="13.1.3.10" id="NCPolyGetCoefficients"><span
class="header-section-number">13.1.3.10</span>
NCPolyGetCoefficients</h4>
<p><code>NCPolyGetCoefficients[poly]</code> returns a list with the
coefficients of the monomials in the nc polynomial
<code>poly</code>.</p>
<p>For example:</p>
<pre><code>vars = {x,y,z};
poly = NCPoly[{-1, 2}, {{x,y,x}, {z}}, vars];
coeffs = NCPolyGetCoefficients[poly];</code></pre>
<p>returns</p>
<pre><code>coeffs = {2,-1}</code></pre>
<p>The coefficients are returned according to the current graded
degree-lexicographic ordering, in this example
<code>x &lt; y &lt; z</code>.</p>
<p>See also: <a href="#NCPolyGetDigits">NCPolyGetDigits</a>, <a
href="#NCPolyCoefficient">NCPolyCoefficient</a>, <a
href="#NCPoly">NCPoly</a>.</p>
<h4 data-number="13.1.3.11" id="NCPolyGetDigits"><span
class="header-section-number">13.1.3.11</span> NCPolyGetDigits</h4>
<p><code>NCPolyGetDigits[poly]</code> returns a list with the digits
that encode the monomials in the nc polynomial <code>poly</code> as
produced by <a href="#NCIntegerDigits">NCIntegerDigits</a>.</p>
<p>For example:</p>
<pre><code>vars = {x,y,z};
poly = NCPoly[{-1, 2}, {{x,y,x}, {z}}, vars];
digits = NCPolyGetDigits[poly];</code></pre>
<p>returns</p>
<pre><code>digits = {{2}, {0,1,0}}</code></pre>
<p>The digits are returned according to the current ordering, in this
example <code>x &lt; y &lt; z</code>.</p>
<p>See also: <a href="#NCPolyGetCoefficients">NCPolyGetCoefficients</a>,
<a href="#NCPoly">NCPoly</a>.</p>
<h4 data-number="13.1.3.12" id="NCPolyGetIntegers"><span
class="header-section-number">13.1.3.12</span> NCPolyGetIntegers</h4>
<p><code>NCPolyGetIntegers[poly]</code> returns a list with the digits
that encode the monomials in the nc polynomial <code>poly</code> as
produced by <a href="#NCFromDigits">NCFromDigits</a>.</p>
<p>For example:</p>
<pre><code>vars = {x,y,z};
poly = NCPoly[{-1, 2}, {{x,y,x}, {z}}, vars];
digits = NCPolyGetIntegers[poly];</code></pre>
<p>returns</p>
<pre><code>digits = {{1,2}, {3,3}}</code></pre>
<p>The digits are returned according to the current ordering, in this
example <code>x &lt; y &lt; z</code>.</p>
<p>See also: <a href="#NCPolyGetCoefficients">NCPolyGetCoefficients</a>,
<a href="#NCPoly">NCPoly</a>.</p>
<h4 data-number="13.1.3.13" id="NCPolyLeadingMonomial"><span
class="header-section-number">13.1.3.13</span>
NCPolyLeadingMonomial</h4>
<p><code>NCPolyLeadingMonomial[poly]</code> returns an
<code>NCPoly</code> representing the leading term of the nc polynomial
<code>poly</code>.</p>
<p>For example:</p>
<pre><code>vars = {x,y,z};
poly = NCPoly[{-1, 2}, {{x,y,x}, {z}}, vars];
lead = NCPolyLeadingMonomial[poly];</code></pre>
<p>returns an <code>NCPoly</code> representing the monomial <span
class="math inline">\(x y x\)</span>. The leading monomial is computed
according to the current ordering, in this example
<code>x &lt; y &lt; z</code>. The actual representation of
<code>lead</code> varies with the implementation.</p>
<p>See also: <a href="#NCPolyLeadingTerm">NCPolyLeadingTerm</a>, <a
href="#NCPolyMonomial">NCPolyMonomial</a>, <a
href="#NCPoly">NCPoly</a>.</p>
<h4 data-number="13.1.3.14" id="NCPolyLeadingTerm"><span
class="header-section-number">13.1.3.14</span> NCPolyLeadingTerm</h4>
<p><code>NCPolyLeadingTerm[poly]</code> returns a rule associated with
the leading term of the nc polynomial <code>poly</code> as understood by
<a href="#NCPolyMonomial">NCPolyMonomial</a>.</p>
<p>For example:</p>
<pre><code>vars = {x,y,z};
poly = NCPoly[{-1, 2}, {{x,y,x}, {z}}, vars];
lead = NCPolyLeadingTerm[poly];</code></pre>
<p>returns</p>
<pre><code>lead = {3,3} -&gt; -1</code></pre>
<p>representing the monomial <span class="math inline">\(- x y
x\)</span>. The leading monomial is computed according to the current
ordering, in this example <code>x &lt; y &lt; z</code>.</p>
<p>See also: <a href="#NCPolyLeadingMonomial">NCPolyLeadingMonomial</a>,
<a href="#NCPolyMonomial">NCPolyMonomial</a>, <a
href="#NCPoly">NCPoly</a>.</p>
<h4 data-number="13.1.3.15" id="NCPolyOrderType"><span
class="header-section-number">13.1.3.15</span> NCPolyOrderType</h4>
<p><code>NCPolyOrderType[poly]</code> returns the type of monomial order
in which the nc polynomial <code>poly</code> is stored. Order can be
<code>NCPolyGradedDegLex</code> or <code>NCPolyDegLex</code>.</p>
<p>See also: <a href="#NCPoly">NCPoly</a>,</p>
<h4 data-number="13.1.3.16" id="NCPolyToRule"><span
class="header-section-number">13.1.3.16</span> NCPolyToRule</h4>
<p><code>NCPolyToRule[poly]</code> returns a <code>Rule</code>
associated with polynomial <code>poly</code>. If
<code>poly = lead + rest</code>, where <code>lead</code> is the leading
term in the current order, then <code>NCPolyToRule[poly]</code> returns
the rule <code>lead -&gt; -rest</code> where the coefficient of the
leading term has been normalized to <code>1</code>.</p>
<p>For example:</p>
<pre><code>vars = {x, y, z};
poly = NCPoly[{-1, 2, 3}, {{x, y, x}, {z}, {x, y}}, vars];
rule = NCPolyToRule[poly]</code></pre>
<p>returns the rule <code>lead -&gt; rest</code> where <code>lead</code>
represents is the nc monomial <span class="math inline">\(x y x\)</span>
and <code>rest</code> is the nc polynomial <span class="math inline">\(2
z + 3 x y\)</span></p>
<p>See also: <a href="#NCPolyLeadingTerm">NCPolyLeadingTerm</a>, <a
href="#NCPolyLeadingMonomial">NCPolyLeadingMonomial</a>, <a
href="#NCPoly">NCPoly</a>.</p>
<h4 data-number="13.1.3.17" id="NCPolyTermsOfDegree"><span
class="header-section-number">13.1.3.17</span> NCPolyTermsOfDegree</h4>
<p><code>NCPolyTermsOfDegree[p, d]</code> returns a polynomial
<code>p</code> in which only the monomials with degree <code>d</code>
are present. The degree <code>d</code> is a list with the partial
degrees on each variable.</p>
<p>For example:</p>
<pre><code>vars = {x, y};
poly = NCPoly[{1, 2, 3, 4}, {{x}, {x, y}, {y, x}, {x, x}}, vars];</code></pre>
<p>corresponds to the polynomial <span class="math inline">\(x + 2 x y +
3 y x + 4 x^2\)</span> and</p>
<pre><code>NCPolyTermsOfTotalDegree[p, {1,1}]</code></pre>
<p>returns</p>
<pre><code>NCPoly[{1, 1}, {1, 1, 1} -&gt; 2, {1, 1, 2} -&gt; 3|&gt;]</code></pre>
<p>which corresponds to the polyomial <span class="math inline">\(2 x y
+ 3 y x\)</span>. Likewise</p>
<pre><code>NCPolyTermsOfTotalDegree[p, {2,0}]</code></pre>
<p>returns</p>
<pre><code>NCPoly[{1, 1}, {0, 2, 0} -&gt; 4|&gt;]</code></pre>
<p>which corresponds to the polyomial <span class="math inline">\(4
x^2\)</span>.</p>
<p>See also: <a
href="#NCPolyTermsOfTotalDegree">NCPolyTermsOfTotalDegree</a>.</p>
<h4 data-number="13.1.3.18" id="NCPolyTermsOfTotalDegree"><span
class="header-section-number">13.1.3.18</span>
NCPolyTermsOfTotalDegree</h4>
<p><code>NCPolyTermsOfTotalDegree[p, d]</code> returns a polynomial
<code>p</code> in which only the monomials with total degree
<code>d</code> are present. The degree <code>d</code> is an integer.</p>
<p>For example:</p>
<pre><code>vars = {x, y};
poly = NCPoly[{1, 2, 3, 4}, {{x}, {x, y}, {y, x}, {x, x}}, vars];</code></pre>
<p>corresponds to the polynomial <span class="math inline">\(x + 2 x y +
3 y x + 4 x^2\)</span> and</p>
<pre><code>NCPolyTermsOfTotalDegree[p, 2]</code></pre>
<p>returns</p>
<pre><code>NCPoly[{1, 1}, &lt;|{0, 2, 0} -&gt; 4, {1, 1, 1} -&gt; 2, {1, 1, 2} -&gt; 3|&gt;]</code></pre>
<p>which corresponds to the polyomial <span class="math inline">\(2 x y
+ 3 y x + 4 x^2\)</span>.</p>
<p>See also: <a href="#NCPolyTermsOfDegree">NCPolyTermsOfDegree</a>.</p>
<h4 data-number="13.1.3.19" id="NCPolyQuadraticTerms"><span
class="header-section-number">13.1.3.19</span> NCPolyQuadraticTerms</h4>
<p><code>NCPolyQuadraticTerms[p]</code> returns a polynomial with only
the “square” quadratic terms of <code>p</code>.</p>
<p>For example:</p>
<pre><code>vars = {{x, y, z}}
coeff = {1, 1, 4, 3, 2, -1}
digits = {{}, {x}, {y, x}, {z, x}, {z, y}, {x, z, z, y}}
p = NCPoly[coeff, digits, vars, TransposePairs -&gt; {{x, y}}]</code></pre>
<p>corresponds to the polynomial <span class="math inline">\(p(x,y,z) =
-x.z.z.y + 2 z.y + 3 z.x + 4 y.x + x + 1\)</span> in which <span
class="math inline">\(x\)</span> and <span
class="math inline">\(y\)</span> are transposes of each other, that is
<span class="math inline">\(y = x^T\)</span>. Its <code>NCPoly</code>
object is</p>
<pre><code>NCPoly[{3}, &lt;|{0, 0} -&gt; 1, {1, 0} -&gt; 1, {2, 3} -&gt; 4, {2, 6} -&gt; 3, {2, 7} -&gt; 2, {4, 25} -&gt; -1|&gt;, TransposePairs -&gt; {{0, 1}}]</code></pre>
<p>A call to</p>
<pre><code>NCPolyQuadraticTerms[p]</code></pre>
<p>results in</p>
<pre><code>NCPoly[{3}, &lt;|{0, 0} -&gt; 1, {2, 3} -&gt; 4, {4, 25} -&gt; -1|&gt;, TransposePairs -&gt; {{0, 1}}]</code></pre>
<p>corresponding to the polynomial <span class="math inline">\(-x.z.z.y
+ 4 y.x + 1\)</span> which contains only “square” quadratic terms of
<span class="math inline">\(p(x,y,z)\)</span>.</p>
<p>See also:
<code>NCPolyQuadraticChipset</code>(#NCPolyQuadraticChipset).</p>
<h4 data-number="13.1.3.20" id="NCPolyQuadraticChipset"><span
class="header-section-number">13.1.3.20</span>
NCPolyQuadraticChipset</h4>
<p><code>NCPolyQuadraticChipset[p]</code> returns a polynomial with only
the “half” terms of <code>p</code> that can be in an NC SOS
decomposition of <code>p</code>.</p>
<p>For example:</p>
<pre><code>vars = {{x, y, z}}
coeff = {1, 1, 4, 3, 2, -1}
digits = {{}, {x}, {y, x}, {z, x}, {z, y}, {x, z, z, y}}
p = NCPoly[coeff, digits, vars, TransposePairs -&gt; {{x, y}}]</code></pre>
<p>corresponds to the polynomial <span class="math inline">\(p(x,y,z) =
-x.z.z.y + 2 z.y + 3 z.x + 4 y.x + x + 1\)</span> in which <span
class="math inline">\(x\)</span> and <span
class="math inline">\(y\)</span> are transposes of each other, that is
<span class="math inline">\(y = x^T\)</span>. Its <code>NCPoly</code>
object is</p>
<pre><code>NCPoly[{3}, &lt;|{0, 0} -&gt; 1, {1, 0} -&gt; 1, {2, 3} -&gt; 4, {2, 6} -&gt; 3, {2, 7} -&gt; 2, {4, 25} -&gt; -1|&gt;, TransposePairs -&gt; {{0, 1}}]</code></pre>
<p>A call to</p>
<pre><code>NCPolyQuadraticChipset[p]</code></pre>
<p>results in</p>
<pre><code>NCPoly[{3}, &lt;|{0, 0} -&gt; 1, {1, 0} -&gt; 1, {1, 1} -&gt; 1, {2, 2} -&gt; 1|&gt;, TransposePairs -&gt; {{0, 1}}]</code></pre>
<p>corresponding to the polynomial <span class="math inline">\(x.z + y +
x + 1\)</span> that contains only terms which contain monomials with the
“left half” of the monomials of <span
class="math inline">\(p(x,y,z)\)</span> which can appear in an NC SOS
decomposition of <code>p</code>.</p>
<p>See also:
<code>NCPolyQuadraticTerms</code>(#NCPolyQuadraticTerms).</p>
<h4 data-number="13.1.3.21" id="NCPolyReverseMonomials"><span
class="header-section-number">13.1.3.21</span>
NCPolyReverseMonomials</h4>
<p><code>NCPolyReverseMonomials[p]</code> reverses the order of the
symbols appearing in each monomial of the polynomial <code>p</code>.</p>
<p>For example:</p>
<pre><code>vars = {x, y};
poly = NCPoly[{1, 2, 3, 4}, {{x}, {x, y}, {y, x}, {x, x}}, vars];</code></pre>
<p>corresponds to the polynomial <span class="math inline">\(x + 2 x y +
3 y x + 4 x^2\)</span> and</p>
<pre><code>NCPolyReverseMonomials[p]</code></pre>
<p>returns</p>
<pre><code>NCPoly[{1, 1}, &lt;|{0, 1, 0} -&gt; 1, {0, 2, 0} -&gt; 4, {1, 1, 2} -&gt; 2, {1, 1, 1} -&gt; 3|&gt;]</code></pre>
<p>which correspond to the polynomial <span class="math inline">\(x + 2
y x + 3 x y + 4 x^2\)</span>.</p>
<p>See also: <a href="#NCIntegerReverse">NCIntegerReverse</a>.</p>
<h4 data-number="13.1.3.22" id="NCPolyGetOptions"><span
class="header-section-number">13.1.3.22</span> NCPolyGetOptions</h4>
<p><code>NCPolyGetOptions[p]</code> returns the options embedded in the
polynomial <code>p</code>.</p>
<p>Available options are:</p>
<ul>
<li><code>TransposePairs</code>: list with pairs of variables to be
treated as transposes of each other;</li>
<li><code>SelfAdjointPairs</code>: list with pairs of variables to be
treated as adjoints of each other.</li>
</ul>
<h3 data-number="13.1.4" id="formating-functions"><span
class="header-section-number">13.1.4</span> Formating functions</h3>
<h4 data-number="13.1.4.1" id="NCPolyDisplay"><span
class="header-section-number">13.1.4.1</span> NCPolyDisplay</h4>
<p><code>NCPolyDisplay[poly]</code> prints the noncommutative polynomial
<code>poly</code>.</p>
<p><code>NCPolyDisplay[poly, vars]</code> uses the symbols in the list
<code>vars</code>.</p>
<h4 data-number="13.1.4.2" id="NCPolyDisplayOrder"><span
class="header-section-number">13.1.4.2</span> NCPolyDisplayOrder</h4>
<p><code>NCPolyDisplayOrder[vars]</code> prints the order implied by the
list of variables <code>vars</code>.</p>
<h3 data-number="13.1.5" id="arithmetic-functions"><span
class="header-section-number">13.1.5</span> Arithmetic functions</h3>
<h4 data-number="13.1.5.1" id="NCPolyDivideDigits"><span
class="header-section-number">13.1.5.1</span> NCPolyDivideDigits</h4>
<p><code>NCPolyDivideDigits[F,G]</code> returns the result of the
division of the leading digits lf and lg.</p>
<h4 data-number="13.1.5.2" id="NCPolyDivideLeading"><span
class="header-section-number">13.1.5.2</span> NCPolyDivideLeading</h4>
<p><code>NCPolyDivideLeading[lF,lG,base]</code> returns the result of
the division of the leading Rules lf and lg as returned by
NCGetLeadingTerm.</p>
<h4 data-number="13.1.5.3" id="NCPolyNormalize"><span
class="header-section-number">13.1.5.3</span> NCPolyNormalize</h4>
<p><code>NCPolyNormalize[poly]</code> makes the coefficient of the
leading term of <code>p</code> to unit. It also works when
<code>poly</code> is a list.</p>
<h4 data-number="13.1.5.4" id="NCPolySum"><span
class="header-section-number">13.1.5.4</span> NCPolySum</h4>
<p><code>NCPolySum[f,g]</code> returns a NCPoly that is the sum of the
NCPoly’s f and g.</p>
<h4 data-number="13.1.5.5" id="NCPolyProduct"><span
class="header-section-number">13.1.5.5</span> NCPolyProduct</h4>
<p><code>NCPolyProduct[f,g]</code> returns a NCPoly that is the product
of the NCPoly’s f and g.</p>
<h4 data-number="13.1.5.6" id="NCPolyQuotientExpand"><span
class="header-section-number">13.1.5.6</span> NCPolyQuotientExpand</h4>
<p><code>NCPolyQuotientExpand[q,g]</code> returns a NCPoly that is the
left-right product of the quotient as returned by
<code>NCPolyReduceWithQuotient</code> by the NCPoly <code>g</code>. It
also works when <code>g</code> is a list.</p>
<h4 data-number="13.1.5.7" id="NCPolyReduce"><span
class="header-section-number">13.1.5.7</span> NCPolyReduce</h4>
<p><code>NCPolyReduce[polys, rules]</code> reduces the list of
<code>NCPoly</code>s <code>polys</code> with respect to the list of
<code>NCPoly</code>s <code>rules</code>. The substitutions implied by
<code>rules</code> are applied repeatedly to the polynomials in the
<code>polys</code> until no further reduction occurs.</p>
<p><code>NCPolyReduce[polys]</code> reduces each polynomial in the list
of <code>NCPoly</code>s <code>polys</code> with respect to the remaining
elements of the list of polyomials <code>polys</code>. It traverses the
list of polys just once. Use <a
href="#NCPolyReduceRepeated">NCPolyReduceRepeated</a> to continue
applying <code>NCPolyReduce</code> until no further reduction
occurs.</p>
<p>By default, <code>NCPolyReduce</code> only reduces the leading
monomial in the current order. Use the optional boolean flag
<code>Complete</code> to completely reduce all monomials. For
example,</p>
<pre><code>NCPolyReduce[polys, rules, Complete -&gt; True]
NCPolyReduce[polys, Complete -&gt; True]</code></pre>
<p>Other available options are: - <code>MaxIterationsFactor</code>
(default = 10): limits the maximum number of iterations in reducing each
polynomial by <code>MaxIterationsFactor</code> times the number of terms
in the polynomial. - <code>MaxDepth</code> (default = 1): control how
many monomials are reduced by <code>NCPolyReduce</code>; by default
<code>MaxDepth</code> is set to one so that just the leading monomial is
reduced. Setting <code>Complete -&gt; True</code> effectively sets
<code>MaxDepth</code> to <code>Infinity</code>. - <code>ZeroTest</code>
(default = <code>NCPolyPossibleZeroQ</code>): which test to use when
assessing that a monomial is zero. This option is useful when the
coefficients are floating points, in which case one might substitute
<code>ZeroTest</code> for an approximate zero test.</p>
<p>See also: <a href="#NCPolyGroebner">NCPolyGroebner</a>, <a
href="#NCPolyReduceRepeated">NCPolyReduceRepeated</a>, <a
href="#NCPolyReduceWithQuotient">NCPolyReduceWithQuotient</a>.</p>
<h4 data-number="13.1.5.8" id="NCPolyReduceRepeated"><span
class="header-section-number">13.1.5.8</span> NCPolyReduceRepeated</h4>
<p><code>NCPolyReduceRepeated[polys]</code> applies NCPolyReduce
successively to the list of polynomials <code>polys</code> until the
remainder does not change.</p>
<p>See also: <a href="#NCPolyReduce">NCPolyReduce</a>, <a
href="#NCPolyReduceWithQuotient">NCPolyReduceWithQuotient</a>.</p>
<h4 data-number="13.1.5.9" id="NCPolyReduceWithQuotient"><span
class="header-section-number">13.1.5.9</span>
NCPolyReduceWithQuotient</h4>
<p><code>NCPolyReduceWithQuotient[f, g]</code> works as <a
href="#NCPolyReduce">NCPolyReduce</a> but also returns a list with the
quotient that can be expanded usinn <a
href="#NCPolyQuotientExpand">NCPolyQuotientExpand</a>.</p>
<p>For example</p>
<pre><code>{qf, r} = NCPolyReduceWithQuotient[f, g];
q = NCPolyQuotientExpand[qf, g];</code></pre>
<p>returns the list <code>qf</code> which is then expanded into the
quotient <code>q</code>.</p>
<p>The same options in <a href="#NCPolyReduce">NCPolyReduce</a> can be
used with <code>NCPolyReduceWithQuotient</code>.</p>
<p>See also: <a href="#NCPolyReduce">NCPolyReduce</a>, <a
href="#NCPolyQuotientExpand">NCPolyQuotientExpand</a>.</p>
<h3 data-number="13.1.6" id="state-space-realization-functions"><span
class="header-section-number">13.1.6</span> State space realization
functions</h3>
<h4 data-number="13.1.6.1" id="NCPolyHankelMatrix"><span
class="header-section-number">13.1.6.1</span> NCPolyHankelMatrix</h4>
<p><code>NCPolyHankelMatrix[poly]</code> produces the nc <em>Hankel
matrix</em> associated with the polynomial <code>poly</code> and also
their shifts per variable.</p>
<p>For example:</p>
<pre><code>vars = {{x, y}};
poly = NCPoly[{1, -1}, {{x, y}, {y, x}}, vars];
{H, Hx, Hy} = NCPolyHankelMatrix[poly]</code></pre>
<p>results in the matrices</p>
<pre><code>H =  {{  0,  0,  0,  1, -1 },
      {  0,  0,  1,  0,  0 },
      {  0, -1,  0,  0,  0 },
      {  1,  0,  0,  0,  0 },
      { -1,  0,  0,  0,  0 }}
Hx = {{  0,  0,  1,  0,  0 },
      {  0,  0,  0,  0,  0 },
      { -1,  0,  0,  0,  0 },
      {  0,  0,  0,  0,  0 },
      {  0,  0,  0,  0,  0 }}
Hy = {{  0, -1,  0,  0,  0 },
      {  1,  0,  0,  0,  0 },
      {  0,  0,  0,  0,  0 },
      {  0,  0,  0,  0,  0 },
      {  0,  0,  0,  0,  0 }}</code></pre>
<p>which are the Hankel matrices associated with the commutator <span
class="math inline">\(x y - y x\)</span>.</p>
<p>See also: <a href="#NCPolyRealization">NCPolyRealization</a>, <a
href="#NCDigitsToIndex">NCDigitsToIndex</a>.</p>
<h4 data-number="13.1.6.2" id="NCPolyRealization"><span
class="header-section-number">13.1.6.2</span> NCPolyRealization</h4>
<p><code>NCPolyRealization[poly]</code> calculate a minimal descriptor
realization for the polynomial <code>poly</code>.</p>
<p><code>NCPolyRealization</code> uses <code>NCPolyHankelMatrix</code>
and the resulting realization is compatible with the format used by
<code>NCRational</code>.</p>
<p>For example:</p>
<pre><code>vars = {{x, y}};
poly = NCPoly[{1, -1}, {{x, y}, {y, x}}, vars];
{{a0,ax,ay},b,c,d} = NCPolyRealization[poly]</code></pre>
<p>produces a list of matrices <code>{a0,ax,ay}</code>, a column vector
<code>b</code> and a row vector <code>c</code>, and a scalar
<code>d</code> such that</p>
<p><span class="math display">\[c . (a0 + ax \, x + ay \, y)^{-1} . b +
d = x y - y x\]</span></p>
<p>See also: <a href="#NCPolyHankelMatrix">NCPolyHankelMatrix</a>, <a
href="#NCRational">NCRational</a>.</p>
<h3 data-number="13.1.7" id="auxiliary-functions"><span
class="header-section-number">13.1.7</span> Auxiliary functions</h3>
<h4 data-number="13.1.7.1" id="NCPolyVarsToIntegers"><span
class="header-section-number">13.1.7.1</span> NCPolyVarsToIntegers</h4>
<p><code>NCPolyVarsToIntegers[vars]</code> converts the list of symbols
<code>vars</code> into a list of integers corresponding to the graded
ordering implied by <code>vars</code>.</p>
<p>For example:</p>
<pre><code>NCPolyVarsToIntegers[{{x},{y,z}}]</code></pre>
<p>returns <code>{1,2}</code>, indicating that there are a total of
three variables with the last two ranking higher than the first.</p>
<p><code>NCPolyVarsToIntegers</code> raises
<code>NCPoly::InvalidList</code> in case it cannot correctly parse the
list of variables.</p>
<p>If <code>vars</code> is a list of integers,
<code>NCPolyVarsToIntegers</code> returns this list intact.</p>
<p>See also: <a href="#NCPoly">NCPoly</a>.</p>
<h4 data-number="13.1.7.2" id="NCFromDigits"><span
class="header-section-number">13.1.7.2</span> NCFromDigits</h4>
<p><code>NCFromDigits[list, b]</code> constructs a representation of a
monomial in <code>b</code> encoded by the elements of <code>list</code>
where the digits are in base <code>b</code>.</p>
<p><code>NCFromDigits[{list1,list2}, b]</code> applies
<code>NCFromDigits</code> to each <code>list1</code>,
<code>list2</code>, ….</p>
<p>List of integers are used to codify monomials. For example the list
<code>{0,1}</code> represents a monomial <span
class="math inline">\(xy\)</span> and the list <code>{1,0}</code>
represents the monomial <span class="math inline">\(yx\)</span>. The
call</p>
<pre><code>NCFromDigits[{0,0,0,1}, 2]</code></pre>
<p>returns</p>
<pre><code>{4,1}</code></pre>
<p>in which <code>4</code> is the degree of the monomial <span
class="math inline">\(xxxy\)</span> and <code>1</code> is
<code>0001</code> in base <code>2</code>. Likewise</p>
<pre><code>NCFromDigits[{0,2,1,1}, 3]</code></pre>
<p>returns</p>
<pre><code>{4,22}</code></pre>
<p>in which <code>4</code> is the degree of the monomial <span
class="math inline">\(xzyy\)</span> and <code>22</code> is
<code>0211</code> in base <code>3</code>.</p>
<p>If <code>b</code> is a list, then degree is also a list with the
partial degrees of each letters appearing in the monomial. For
example:</p>
<pre><code>NCFromDigits[{0,2,1,1}, {1,2}]</code></pre>
<p>returns</p>
<pre><code>{3, 1, 22}</code></pre>
<p>in which <code>3</code> is the partial degree of the monomial <span
class="math inline">\(xzyy\)</span> with respect to letters
<code>y</code> and <code>z</code>, <code>1</code> is the partial degree
with respect to letter <code>x</code> and <code>22</code> is
<code>0211</code> in base <code>3 = 1 + 2</code>.</p>
<p>This construction is used to represent graded degree-lexicographic
orderings.</p>
<p>See also: <a href="#NCIntegerDigits">NCIntegerDigits</a>.</p>
<h4 data-number="13.1.7.3" id="NCIntegerDigits"><span
class="header-section-number">13.1.7.3</span> NCIntegerDigits</h4>
<p><code>NCIntegerDigits[n,b]</code> is the inverse of the
<code>NCFromDigits</code>.</p>
<p><code>NCIntegerDigits[{list1,list2}, b]</code> applies
<code>NCIntegerDigits</code> to each <code>list1</code>,
<code>list2</code>, ….</p>
<p>For example:</p>
<pre><code>NCIntegerDigits[{4,1}, 2]</code></pre>
<p>returns</p>
<pre><code>{0,0,0,1}</code></pre>
<p>in which <code>4</code> is the degree of the monomial
<code>x**x**x**y</code> and <code>1</code> is <code>0001</code> in base
<code>2</code>. Likewise</p>
<pre><code>NCIntegerDigits[{4,22}, 3]</code></pre>
<p>returns</p>
<pre><code>{0,2,1,1}</code></pre>
<p>in which <code>4</code> is the degree of the monomial
<code>x**z**y**y</code> and <code>22</code> is <code>0211</code> in base
<code>3</code>.</p>
<p>If <code>b</code> is a list, then degree is also a list with the
partial degrees of each letters appearing in the monomial. For
example:</p>
<pre><code>NCIntegerDigits[{3, 1, 22}, {1,2}]</code></pre>
<p>returns</p>
<pre><code>{0,2,1,1}</code></pre>
<p>in which <code>3</code> is the partial degree of the monomial
<code>x**z**y**y</code> with respect to letters <code>y</code> and
<code>z</code>, <code>1</code> is the partial degree with respect to
letter <code>x</code> and <code>22</code> is <code>0211</code> in base
<code>3 = 1 + 2</code>.</p>
<p>See also: <a href="#NCFromDigits">NCFromDigits</a>.</p>
<h4 data-number="13.1.7.4" id="NCIntegerReverse"><span
class="header-section-number">13.1.7.4</span> NCIntegerReverse</h4>
<p><code>NCIntegerReverse[n,b]</code> reverses the integer
<code>n</code> on the base <code>b</code> as returned by
<code>NCFromDigits</code>.</p>
<p><code>NCIntegerReverse[{list1,list2}, b]</code> applies
<code>NCIntegerReverse</code> to each <code>list1</code>,
<code>list2</code>, ….</p>
<p>For example:</p>
<pre><code>NCIntegerReverse[{4,1}, 2]</code></pre>
<p>in which <code>{4,1}</code> correspond to the digits
<code>{1,0,0,0}</code> returns</p>
<pre><code>{4, 8}</code></pre>
<p>which correspond to the digits <code>{1,0,0,0}</code>.</p>
<p>See also: <a href="#NCIntegerDigits">NCIntegerDigits</a>.</p>
<h4 data-number="13.1.7.5" id="NCDigitsToIndex"><span
class="header-section-number">13.1.7.5</span> NCDigitsToIndex</h4>
<p><code>NCDigitsToIndex[digits, b]</code> returns the index that the
monomial represented by <code>digits</code> in the base <code>b</code>
would occupy in the standard monomial basis.</p>
<p><code>NCDigitsToIndex[{digit1,digits2}, b]</code> applies
<code>NCDigitsToIndex</code> to each <code>digit1</code>,
<code>digit2</code>, ….</p>
<p><code>NCDigitsToIndex[digits, b, Reverse -&gt; True]</code> returns
the index as occupied by the permuted digits.</p>
<p><code>NCDigitsToIndex</code> returns the same index for graded or
simple basis.</p>
<p>For example:</p>
<pre><code>digits = {0, 1};
NCDigitsToIndex[digits, 2]
NCDigitsToIndex[digits, {2}]
NCDigitsToIndex[digits, {1, 1}]</code></pre>
<p>all return</p>
<pre><code>5</code></pre>
<p>which is the index of the monomial <span class="math inline">\(x
y\)</span> in the standard monomial basis of polynomials in <span
class="math inline">\(x\)</span> and <span
class="math inline">\(y\)</span>. Likewise</p>
<pre><code>digits = {{}, {1}, {0, 1}, {0, 2, 1, 1}};
NCDigitsToIndex[digits, 2]</code></pre>
<p>returns</p>
<pre><code>{1,3,5,27}</code></pre>
<p>Finally</p>
<pre><code>NCDigitsToIndex[{0, 1}, 2, Reverse -&gt; True]</code></pre>
<p>returns <code>6</code> instead of <code>5</code>.</p>
<p>See also: <a href="#NCFromDigits">NCFromDigits</a>, <a
href="#NCIntegerDigits">NCIntegerDigits</a>.</p>
<h4 data-number="13.1.7.6" id="NCPadAndMatch"><span
class="header-section-number">13.1.7.6</span> NCPadAndMatch</h4>
<p>When list <code>a</code> is longer than list <code>b</code>,
<code>NCPadAndMatch[a,b]</code> returns the minimum number of elements
from list a that should be added to the left and right of list
<code>b</code> so that <code>a = l b r</code>. When list <code>b</code>
is longer than list <code>a</code>, return the opposite match.</p>
<p><code>NCPadAndMatch</code> returns all possible matches with the
minimum number of elements.</p>
<h2 data-number="13.2" id="PackageNCPolyInterface"><span
class="header-section-number">13.2</span> NCPolyInterface</h2>
<p>The package <code>NCPolyInterface</code> provides a basic interface
between <a href="#PackageNCPoly"><code>NCPoly</code></a> and
<code>NCAlgebra</code>.</p>
<blockquote>
<p>Note that to take full advantage of the speed-up possible with
<code>NCPoly</code> one should not use these functions. It is always
faster to convert to and manipulate <code>NCPoly</code> expressions
directly!</p>
</blockquote>
<p>Members are:</p>
<ul>
<li><a href="#NCToNCPoly">NCToNCPoly</a></li>
<li><a href="#NCPolyToNC">NCPolyToNC</a></li>
<li><a href="#NCMonomialOrderQ">NCMonomialOrderQ</a></li>
<li><a href="#NCMonomialOrder">NCMonomialOrder</a></li>
<li><a href="#NCRationalToNCPoly">NCRationalToNCPoly</a></li>
<li><a href="#NCRuleToPoly">NCRuleToPoly</a></li>
<li><a href="#NCToRule">NCToRule</a></li>
<li><a href="#NCReduce">NCReduce</a></li>
<li><a href="#NCReduceRepeated">NCReduceRepeated</a></li>
<li><a href="#NCMonomialList">NCMonomialList</a></li>
<li><a href="#NCCoefficientRules">NCCoefficientRules</a></li>
<li><a href="#NCCoefficientList">NCCoefficientList</a></li>
<li><a href="#NCCoefficientQ">NCCoefficientQ</a></li>
<li><a href="#NCMonomialQ">NCMonomialQ</a></li>
<li><a href="#NCPolynomialQ">NCPolynomialQ</a></li>
</ul>
<h3 data-number="13.2.1" id="NCToNCPoly"><span
class="header-section-number">13.2.1</span> NCToNCPoly</h3>
<p><code>NCToNCPoly[expr, var]</code> constructs a noncommutative
polynomial object in variables <code>var</code> from the nc expression
<code>expr</code>.</p>
<p>For example</p>
<pre><code>NCToNCPoly[x**y - 2 y**z, {x, y, z}] </code></pre>
<p>constructs an object associated with the noncommutative polynomial
<span class="math inline">\(x y - 2 y z\)</span> in variables
<code>x</code>, <code>y</code> and <code>z</code>. The internal
representation is so that the terms are sorted according to a
degree-lexicographic order in <code>vars</code>. In the above example,
<span class="math inline">\(x &lt; y &lt; z\)</span>.</p>
<h3 data-number="13.2.2" id="NCPolyToNC"><span
class="header-section-number">13.2.2</span> NCPolyToNC</h3>
<p><code>NCPolyToNC[poly, vars]</code> constructs an nc expression from
the noncommutative polynomial object <code>poly</code> in variables
<code>vars</code>. Monomials are specified in terms of the symbols in
the list <code>var</code>.</p>
<p>For example</p>
<pre><code>poly = NCToNCPoly[x**y - 2 y**z, {x, y, z}];
expr = NCPolyToNC[poly, {x, y, z}];</code></pre>
<p>returns</p>
<pre><code>expr = x**y - 2 y**z</code></pre>
<p>See also: <a href="#NCPolyToNC">NCPolyToNC</a>, <a
href="#NCPoly">NCPoly</a>.</p>
<h3 data-number="13.2.3" id="NCMonomialOrderQ"><span
class="header-section-number">13.2.3</span> NCMonomialOrderQ</h3>
<p><code>NCMonomialOrderQ[list]</code> returns <code>True</code> if the
expressions in <code>list</code> represents a valid monomial
ordering.</p>
<p><code>NCMonomialOrderQ</code> is used by <a
href="#NCMonomialOrder">NCMonomialOrder</a> to decided whether a
proposed ordering is valid or not. However, <code>NCMonomialOrder</code>
is much more forgiving when it comes to the format of the order.</p>
<p>See also: <a href="#NCMonomialOrder">NCMonomialOrder</a>, <a
href="#NCRationalToNCPoly">NCRationalToNCPoly</a>.</p>
<h3 data-number="13.2.4" id="NCMonomialOrder"><span
class="header-section-number">13.2.4</span> NCMonomialOrder</h3>
<p><code>NCMonomialOrder[var1, var2, ...]</code> returns an array
representing a monomial order.</p>
<p>For example</p>
<pre><code>NCMonomialOrder[a,b,c]</code></pre>
<p>returns</p>
<pre class="output"><code>{{a},{b},{c}}</code></pre>
<p>corresponding to the lex order <span class="math inline">\(a \ll b
\ll c\)</span>.</p>
<p>If one uses a list of variables rather than a single variable as one
of the arguments, then multigraded lex order is used. For example</p>
<pre><code>NCMonomialOrder[{a,b,c}]</code></pre>
<p>returns</p>
<pre class="output"><code>{{a,b,c}}</code></pre>
<p>corresponding to the graded lex order <span class="math inline">\(a
&lt; b &lt; c\)</span>.</p>
<p>Another example:</p>
<pre><code>NCMonomialOrder[{{a, b}, {c}}]</code></pre>
<p>or</p>
<pre><code>NCMonomialOrder[{a, b}, c]</code></pre>
<p>both return</p>
<pre class="output"><code>{{a,b},{c}}</code></pre>
<p>corresponding to the multigraded lex order <span
class="math inline">\(a &lt; b \ll c\)</span>.</p>
<p>See also: <a href="#NCMonomialOrderQ">NCMonomialOrderQ</a>, <a
href="#NCRationalToNCPoly">NCRationalToNCPoly</a>, <a
href="#SetMonomialOrder">SetMonomialOrder</a>.</p>
<h3 data-number="13.2.5" id="NCRationalToNCPoly"><span
class="header-section-number">13.2.5</span> NCRationalToNCPoly</h3>
<p><code>NCRationalToNCPoly[expr, vars]</code> generates a
representation of the noncommutative rational expression or list of
rational expressions <code>expr</code> in <code>vars</code> which has
commutative coefficients.</p>
<p><code>NCRationalToNCPoly[expr, vars]</code> generates one or more
<code>NCPoly</code>s in which <code>vars</code> is used to set a
monomial ordering as per <a
href="#NCMonomialOrder">NCMonomialOrder</a>.</p>
<p><code>NCRationalToNCPolynomial</code> creates one variable for each
<code>inv</code> expression in <code>vars</code> appearing in the
rational expression <code>expr</code>. It also created additional
relations to encode the inverse. It also creates additional variables to
represent <code>tp</code> and <code>aj</code>.</p>
<p>It returns a list of four elements:</p>
<ul>
<li>the first element is the original expression and any additional
expressions as <code>NCPoly</code>s;</li>
<li>the second element is the list of variables representing the current
ordering, including any additional variables created to replace
<code>inv</code>s, <code>tp</code>s, and <code>aj</code>s;</li>
<li>the third element is a list of rules that can be used to recover the
original rational expression;</li>
<li>the fourth element is a list of labels corresponding to the
variables in the second element.</li>
</ul>
<p>For example:</p>
<pre><code>exp = a+tp[a]-inv[a];
order = NCMonomialOrder[a,b];
{rels,vars,rules,labels} = NCRationalToNCPoly[exp, order]</code></pre>
<p>returns</p>
<pre><code>rels = {
  NCPoly[{2,1,1},&lt;|{0,0,1,0} -&gt; 1,{0,0,1,1} -&gt; 1,{1,0,0,3} -&gt; -1|&gt;],
  NCPoly[{2,1,1},&lt;|{0,0,0,0} -&gt; -1,{1,0,1,12} -&gt; 1|&gt;],
  NCPoly[{2,1,1},&lt;|{0,0,0,0} -&gt; -1,{1,0,1,3} -&gt; 1|&gt;]
}
vars = {{a,tp51},{b},{rat50}},
rules = {rat50 -&gt; inv[a],tp51 -&gt; tp[a]},
labels = {{a,tp[a]},{b},{inv[a]}}</code></pre>
<p>The variable <code>tp51</code> was created to represent
<code>tp[a]</code> and <code>rat50</code> was created to represent
<code>inv[a]</code>. The additional relations in <code>rels</code>
correspond to <code>a**rat50 - 1</code> and <code>rat50**a - 1</code>,
which encode the rational relation <code>rat50 - inv[a]</code>.</p>
<p><code>NCRationalToPoly</code> also handles rational expressions, not
only rational variables. For example:</p>
<pre><code>expr = a ** inv[1 - a] ** a;
order = NCMonomialOrder[a, inv[1 - a]];
{rels, vars, rules, labels} = NCRationalToNCPoly[expr, order]</code></pre>
<p>returns</p>
<pre><code>rels = {
  NCPoly[{1,1},&lt;|{1,2,2} -&gt; 1|&gt;],
  NCPoly[{1,1},&lt;|{0,0,0} -&gt; -1,{1,0,1} -&gt; 1,{1,1,2} -&gt; -1|&gt;],
  NCPoly[{1,1},&lt;|{0,0,0} -&gt; -1,{1,0,1} -&gt; 1,{1,1,1} -&gt; -1|&gt;]
}
vars = {{a},{rat54}} 
rules = {rat54 -&gt; inv[1 - a]},
labels = {{a},{inv[1 - a]}}</code></pre>
<p>Note how <code>rat54</code> encodes the rational expression
<code>inv[1-a]</code>.</p>
<p>See also: <a href="#NCMonomialOrder">NCMonomialOrder</a>, <a
href="#NCMonomialOrderQ">NCMonomialOrderQ</a>, <a
href="#NCPolyToNC">NCPolyToNC</a>, <a href="#NCPoly">NCPoly</a>, <a
href="#NCRationalToNCPolynomial">NCRationalToNCPolynomial</a>.</p>
<h3 data-number="13.2.6" id="NCRuleToPoly"><span
class="header-section-number">13.2.6</span> NCRuleToPoly</h3>
<p><code>NCRuleToPoly[a -&gt; b]</code> converts the rule
<code>a -&gt; b</code> into the relation <code>a - b</code>.</p>
<p>For instance:</p>
<pre><code>NCRuleToPoly[x**y**y -&gt; x**y - 1]</code></pre>
<p>returns</p>
<pre><code>x**y**y - x**y + 1</code></pre>
<h3 data-number="13.2.7" id="NCToRule"><span
class="header-section-number">13.2.7</span> NCToRule</h3>
<p><code>NCToRule[exp, vars]</code> converts the NC polynomial
<code>exp</code> into a rule <code>a -&gt; b</code> in which
<code>a</code> is the leading monomial according to the ordering implied
by <code>vars</code>.</p>
<p>For instance:</p>
<pre><code>NCToRule[x**y**y - x**y + 1, {x,y}]</code></pre>
<p>returns</p>
<pre><code>x**y**y -&gt; x**y - 1</code></pre>
<p>NOTE: This command is not efficient. If you need to sort polynomials
you should consider using NCPoly directly.</p>
<p>See also: <a href="#NCToNCPoly">NCToNCPoly</a></p>
<h3 data-number="13.2.8" id="NCReduce"><span
class="header-section-number">13.2.8</span> NCReduce</h3>
<p><code>NCReduce[polys, rules, vars, options]</code> reduces the list
of polynomials in <code>polys</code> by the list of polynomials in
<code>rules</code> in the variables <code>vars</code>. The substitutions
implied by <code>rules</code> are applied repeatedly to the polynomials
in the <code>polys</code> until no further reduction occurs.</p>
<p>Note that the exact meaning of rules depends on the polynomial
ordering implied by the <code>vars</code>. For example, if</p>
<pre><code>polys = x^3 + x ** y
rules = x^2 - x ** y</code></pre>
<p>then</p>
<pre><code>NCReduce[polys, rules, {y, x}]</code></pre>
<p>produces</p>
<pre class="output"><code>x ** y + x ** y ** x</code></pre>
<p>because <code>x^2 - x ** y</code> is interpreted as
<code>x^2 -&gt; x ** y</code>, while</p>
<pre><code>NCReduce[polys, rules, {x, y}]</code></pre>
<p>produces</p>
<pre class="output"><code>x^2 + x^3</code></pre>
<p>because <code>x^2 - x ** y</code> is interpreted as
<code>x ** y -&gt; x^2</code>.</p>
<p>By default, <code>NCReduce</code> only reduces the leading monomial
in the current order. Use the optional boolean flag
<code>Complete</code> to completely reduce all monomials. For
example,</p>
<pre><code>NCReduce[polys, rules, Complete -&gt; True]
NCReduce[polys, Complete -&gt; True]</code></pre>
<p>See <a href="#NCPolyReduce">NCPolyReduce</a> for a complete list of
<code>options</code>.</p>
<p><code>NCReduce[polys, vars, options]</code> reduces each polynomial
in the list of <code>NCPoly</code>s <code>polys</code> with respect to
the remaining elements of the list of polyomials <code>polys</code>. It
traverses the list of polys just once. Use <a
href="#NCReduceRepeated">NCReduceRepeated</a> to continue applying
<code>NCReduce</code> until no further reduction occurs.</p>
<p><code>NCReduce</code> converts <code>polys</code> and
<code>rules</code> to NCPoly polynomials and apply <a
href="#NCPolyReduce">NCPolyReduce</a>.</p>
<p>See also: <a href="#NCReduceRepeated">NCReduceRepeated</a>, <a
href="#NCPolyReduce">NCPolyReduce</a>.</p>
<h3 data-number="13.2.9" id="NCReduceRepeated"><span
class="header-section-number">13.2.9</span> NCReduceRepeated</h3>
<p><code>NCReduceRepeated[polys, vars]</code> applies
<code>NCReduce</code> successively to the list of <code>polys</code> in
variables <code>vars</code> until the remainder does not change.</p>
<p>See also: <a href="#NCReduce">NCReduce</a>, <a
href="#NCPolyReduceRepeated">NCPolyReduceRepeated</a>.</p>
<h3 data-number="13.2.10" id="NCMonomialList"><span
class="header-section-number">13.2.10</span> NCMonomialList</h3>
<p><code>NCMonomialList[poly, vars]</code> gives the list of all
monomials in the polynomial <code>poly</code> in variables
<code>vars</code>.</p>
<p>For example:</p>
<pre><code>vars = {x, y}
expr = B + A y ** x ** y - 2 x
NCMonomialList[expr, vars]</code></pre>
<p>returns</p>
<pre><code>{1, x, y ** x ** y}</code></pre>
<p>See also: <a href="#NCCoefficientRules">NCCoefficientRules</a>, <a
href="#NCCoefficientList">NCCoefficientList</a>, <a
href="#NCVariables">NCVariables</a>.</p>
<h3 data-number="13.2.11" id="NCCoefficientRules"><span
class="header-section-number">13.2.11</span> NCCoefficientRules</h3>
<p><code>NCCoefficientRules[poly, vars]</code> gives a list of rules
between all the monomials polynomial <code>poly</code> in variables
<code>vars</code>.</p>
<p>For example:</p>
<pre><code>vars = {x, y}
expr = B + A y ** x ** y - 2 x
NCCoefficientRules[expr, vars]</code></pre>
<p>returns</p>
<pre><code>{1 -&gt; B, x -&gt; -2, y ** x ** y -&gt; A}</code></pre>
<p>See also: <a href="#NCMonomialList">NCMonomialList</a>, <a
href="#NCCoefficientRules">NCCoefficientRules</a>, <a
href="#NCVariables">NCVariables</a>.</p>
<h3 data-number="13.2.12" id="NCCoefficientList"><span
class="header-section-number">13.2.12</span> NCCoefficientList</h3>
<p><code>NCCoefficientList[poly, vars]</code> gives the list of all
coefficients in the polynomial <code>poly</code> in variables
<code>vars</code>.</p>
<p>For example:</p>
<pre><code>vars = {x, y}
expr = B + A y ** x ** y - 2 x
NCCoefficientList[expr, vars]</code></pre>
<p>returns</p>
<pre><code>{B, -2, A}</code></pre>
<p>See also: <a href="#NCMonomialList">NCMonomialList</a>, <a
href="#NCCoefficientRules">NCCoefficientRules</a>, <a
href="#NCVariables">NCVariables</a>.</p>
<h3 data-number="13.2.13" id="NCCoefficientQ"><span
class="header-section-number">13.2.13</span> NCCoefficientQ</h3>
<p><code>NCCoefficientQ[expr]</code> returns True if <code>expr</code>
is a valid polynomial coefficient.</p>
<p>For example:</p>
<pre><code>SetCommutative[A]
NCCoefficientQ[1]
NCCoefficientQ[A]
NCCoefficientQ[2 A]</code></pre>
<p>all return <code>True</code> and</p>
<pre><code>SetNonCommutative[x]
NCCoefficientQ[x]
NCCoefficientQ[x**x]
NCCoefficientQ[Exp[x]]</code></pre>
<p>all return <code>False</code>.</p>
<p><strong>IMPORTANT</strong>: <code>NCCoefficientQ[expr]</code> does
not expand <code>expr</code>. This means that
<code>NCCoefficientQ[2 (A + 1)]</code> will return
<code>False</code>.</p>
<p>See also: <a href="#NCMonomialQ">NCMonomialQ</a>, <a
href="#NCPolynomialQ">NCPolynomialQ</a></p>
<h3 data-number="13.2.14" id="NCMonomialQ"><span
class="header-section-number">13.2.14</span> NCMonomialQ</h3>
<p><code>NCCoefficientQ[expr]</code> returns True if <code>expr</code>
is an nc monomial.</p>
<p>For example:</p>
<pre><code>SetCommutative[A]
NCMonomialQ[1]
NCMonomialQ[x]
NCMonomialQ[A x ** y]
NCMonomialQ[2 A x ** y ** x]</code></pre>
<p>all return <code>True</code> and</p>
<pre><code>NCMonomialQ[x + x ** y]</code></pre>
<p>returns <code>False</code>.</p>
<p><strong>IMPORTANT</strong>: <code>NCMonomialQ[expr]</code> does not
expand <code>expr</code>. This means that
<code>NCMonomialQ[2 (A + 1) x**x]</code> will return
<code>False</code>.</p>
<p>See also: <a href="#NCCoefficientQ">NCCoefficientQ</a>, <a
href="#NCPolynomialQ">NCPolynomialQ</a></p>
<h3 data-number="13.2.15" id="NCPolynomialQ"><span
class="header-section-number">13.2.15</span> NCPolynomialQ</h3>
<p><code>NCPolynomialQ[expr]</code> returns True if <code>expr</code> is
an nc polynomial with commutative coefficients.</p>
<p>For example:</p>
<pre><code>NCPolynomialQ[A x ** y]</code></pre>
<p>all return <code>True</code> and</p>
<pre><code>NCMonomialQ[x + x ** y]</code></pre>
<p>returns <code>False</code>.</p>
<p><strong>IMPORTANT</strong>: <code>NCPolynomialQ[expr]</code> does
expand <code>expr</code>. This means that
<code>NCPolynomialQ[(x + y)^3]</code> will return <code>True</code>.</p>
<p>See also: <a href="#NCCoefficientQ">NCCoefficientQ</a>, <a
href="#NCMonomialQ">NCMonomialQ</a></p>
<h2 data-number="13.3" id="PackageNCPolynomial"><span
class="header-section-number">13.3</span> NCPolynomial</h2>
<h3 data-number="13.3.1"
id="efficient-storage-of-nc-polynomials-with-nc-coefficients"><span
class="header-section-number">13.3.1</span> Efficient storage of NC
polynomials with nc coefficients</h3>
<p>This package contains functionality to convert an nc polynomial
expression into an expanded efficient representation that can have
commutative or noncommutative coefficients.</p>
<p>For example the polynomial</p>
<pre><code>exp = a**x**b - 2 x**y**c**x + a**c</code></pre>
<p>in variables <code>x</code> and <code>y</code> can be converted into
an NCPolynomial using</p>
<pre><code>p = NCToNCPolynomial[exp, {x,y}]</code></pre>
<p>which returns</p>
<pre><code>p = NCPolynomial[a**c, &lt;|{x}-&gt;{{1,a,b}},{x**y,x}-&gt;{{2,1,c,1}}|&gt;, {x,y}]</code></pre>
<p>Members are:</p>
<ul>
<li>Constructors
<ul>
<li><a href="#NCPolynomial">NCPolynomial</a></li>
<li><a href="#NCToNCPolynomial">NCToNCPolynomial</a></li>
<li><a href="#NCPolynomialToNC">NCPolynomialToNC</a></li>
<li><a
href="#NCRationalToNCPolynomial">NCRationalToNCPolynomial</a></li>
</ul></li>
<li>Access and utilities
<ul>
<li><a href="#NCPCoefficients">NCPCoefficients</a></li>
<li><a href="#NCPTermsOfDegree">NCPTermsOfDegree</a></li>
<li><a href="#NCPTermsOfTotalDegree">NCPTermsOfTotalDegree</a></li>
<li><a href="#NCPTermsToNC">NCPTermsToNC</a></li>
<li><a href="#NCPDecompose">NCPDecompose</a></li>
<li><a href="#NCPDegree">NCPDegree</a></li>
<li><a href="#NCPMonomialDegree">NCPMonomialDegree</a></li>
<li><a href="#NCPCompatibleQ">NCPCompatibleQ</a></li>
<li><a href="#NCPSameVariablesQ">NCPSameVariablesQ</a></li>
<li><a href="#NCPMatrixQ">NCPMatrixQ</a></li>
<li><a href="#NCPLinearQ">NCPLinearQ</a></li>
<li><a href="#NCPQuadraticQ">NCPQuadraticQ</a></li>
<li><a href="#NCPNormalize">NCPNormalize</a></li>
</ul></li>
<li>Arithmetic
<ul>
<li><a href="#NCPTimes">NCPTimes</a></li>
<li><a href="#NCPDot">NCPDot</a></li>
<li><a href="#NCPPlus">NCPPlus</a></li>
<li><a href="#NCPSort">NCPSort</a></li>
</ul></li>
</ul>
<h3 data-number="13.3.2" id="ways-to-represent-nc-polynomials-1"><span
class="header-section-number">13.3.2</span> Ways to represent NC
polynomials</h3>
<h4 data-number="13.3.2.1" id="NCPolynomial"><span
class="header-section-number">13.3.2.1</span> NCPolynomial</h4>
<p><code>NCPolynomial[indep,rules,vars]</code> is an expanded efficient
representation for an nc polynomial in <code>vars</code> which can have
commutative or noncommutative coefficients.</p>
<p>The nc expression <code>indep</code> collects all terms that are
independent of the letters in <code>vars</code>.</p>
<p>The <em>Association</em> <code>rules</code> stores terms in the
following format:</p>
<pre><code>{mon1, ..., monN} -&gt; {scalar, term1, ..., termN+1}</code></pre>
<p>where:</p>
<ul>
<li><code>mon1, ..., monN</code>: are nc monomials in vars;</li>
<li><code>scalar</code>: contains all commutative coefficients; and</li>
<li><code>term1, ..., termN+1</code>: are nc expressions on letters
other than the ones in vars which are typically the noncommutative
coefficients of the polynomial.</li>
</ul>
<p><code>vars</code> is a list of <em>Symbols</em>.</p>
<p>For example the polynomial</p>
<pre><code>a**x**b - 2 x**y**c**x + a**c</code></pre>
<p>in variables <code>x</code> and <code>y</code> is stored as:</p>
<pre><code>NCPolynomial[a**c, &lt;|{x}-&gt;{{1,a,b}},{x**y,x}-&gt;{{2,1,c,1}}|&gt;, {x,y}]</code></pre>
<p>NCPolynomial specific functions are prefixed with NCP,
e.g. NCPDegree.</p>
<p>See also: <a
href="#NCToNCPolynomial"><code>NCToNCPolynomial</code></a>, <a
href="#NCPolynomialToNC"><code>NCPolynomialToNC</code></a>, <a
href="#NCPTermsToNC"><code>NCPTermsToNC</code></a>.</p>
<h4 data-number="13.3.2.2" id="NCToNCPolynomial"><span
class="header-section-number">13.3.2.2</span> NCToNCPolynomial</h4>
<p><code>NCToNCPolynomial[p, vars]</code> generates a representation of
the noncommutative polynomial <code>p</code> in <code>vars</code> which
can have commutative or noncommutative coefficients.</p>
<p><code>NCToNCPolynomial[p]</code> generates an
<code>NCPolynomial</code> in all nc variables appearing in
<code>p</code>.</p>
<p>Example:</p>
<pre><code>exp = a**x**b - 2 x**y**c**x + a**c
p = NCToNCPolynomial[exp, {x,y}]</code></pre>
<p>returns</p>
<pre><code>NCPolynomial[a**c, &lt;|{x}-&gt;{{1,a,b}},{x**y,x}-&gt;{{2,1,c,1}}|&gt;, {x,y}]</code></pre>
<p>See also: <a href="#NCPolynomial"><code>NCPolynomial</code></a>, <a
href="#NCPolynomialToNC"><code>NCPolynomialToNC</code></a>.</p>
<h4 data-number="13.3.2.3" id="NCPolynomialToNC"><span
class="header-section-number">13.3.2.3</span> NCPolynomialToNC</h4>
<p><code>NCPolynomialToNC[p]</code> converts the NCPolynomial
<code>p</code> back into a regular nc polynomial.</p>
<p>See also: <a href="#NCPolynomial"><code>NCPolynomial</code></a>, <a
href="#NCToNCPolynomial"><code>NCToNCPolynomial</code></a>.</p>
<h4 data-number="13.3.2.4" id="NCRationalToNCPolynomial"><span
class="header-section-number">13.3.2.4</span>
NCRationalToNCPolynomial</h4>
<p><code>NCRationalToNCPolynomial[r, vars]</code> generates a
representation of the noncommutative rational expression <code>r</code>
in <code>vars</code> which can have commutative or noncommutative
coefficients.</p>
<p><code>NCRationalToNCPolynomial[r]</code> generates an
<code>NCPolynomial</code> in all nc variables appearing in
<code>r</code>.</p>
<p><code>NCRationalToNCPolynomial</code> creates one variable for each
<code>inv</code> expression in <code>vars</code> appearing in the
rational expression <code>r</code>. It returns a list of three
elements:</p>
<ul>
<li>the first element is the <code>NCPolynomial</code>;</li>
<li>the second element is the list of new variables created to replace
<code>inv</code>s;</li>
<li>the third element is a list of rules that can be used to recover the
original rational expression.</li>
</ul>
<p>For example:</p>
<pre><code>exp = a**inv[x]**y**b - 2 x**y**c**x + a**c
{p,rvars,rules} = NCRationalToNCPolynomial[exp, {x,y}]</code></pre>
<p>returns</p>
<pre><code>p = NCPolynomial[a**c, &lt;|{rat1**y}-&gt;{{1,a,b}},{x**y,x}-&gt;{{2,1,c,1}}|&gt;, {x,y,rat1}]
rvars = {rat1}
rules = {rat1-&gt;inv[x]}</code></pre>
<p>See also: <a href="#NCPolynomial"><code>NCToNCPolynomial</code></a>,
<a href="#NCPolynomialToNC"><code>NCPolynomialToNC</code></a>.</p>
<h3 data-number="13.3.3" id="grouping-terms-by-degree"><span
class="header-section-number">13.3.3</span> Grouping terms by
degree</h3>
<h4 data-number="13.3.3.1" id="NCPTermsOfDegree"><span
class="header-section-number">13.3.3.1</span> NCPTermsOfDegree</h4>
<p><code>NCPTermsOfDegree[p,deg]</code> gives all terms of the
NCPolynomial <code>p</code> of degree <code>deg</code>.</p>
<p>The degree <code>deg</code> is a list with the degree of each
symbol.</p>
<p>For example:</p>
<pre><code>p = NCPolynomial[0, &lt;|{x,y}-&gt;{{2,a,b,c}},
                      {x,x}-&gt;{{1,a,b,c}},
                      {x**x}-&gt;{{-1,a,b}}|&gt;, {x,y}]
NCPTermsOfDegree[p, {1,1}]</code></pre>
<p>returns</p>
<pre><code>&lt;|{x,y}-&gt;{{2,a,b,c}}|&gt;</code></pre>
<p>and</p>
<pre><code>NCPTermsOfDegree[p, {2,0}]</code></pre>
<p>returns</p>
<pre><code>&lt;|{x,x}-&gt;{{1,a,b,c}}, {x**x}-&gt;{{-1,a,b}}|&gt;</code></pre>
<p>See also: <a
href="#NCPTermsOfTotalDegree"><code>NCPTermsOfTotalDegree</code></a>,<a
href="#NCPTermsToNC"><code>NCPTermsToNC</code></a>.</p>
<h4 data-number="13.3.3.2" id="NCPTermsOfTotalDegree"><span
class="header-section-number">13.3.3.2</span> NCPTermsOfTotalDegree</h4>
<p><code>NCPTermsOfDegree[p,deg]</code> gives all terms of the
NCPolynomial <code>p</code> of total degree <code>deg</code>.</p>
<p>The degree <code>deg</code> is the total degree.</p>
<p>For example:</p>
<pre><code>p = NCPolynomial[0, &lt;|{x,y}-&gt;{{2,a,b,c}},
                      {x,x}-&gt;{{1,a,b,c}},
                      {x**x}-&gt;{{-1,a,b}}|&gt;, {x,y}]
NCPTermsOfDegree[p, 2]</code></pre>
<p>returns</p>
<pre><code>&lt;|{x,y}-&gt;{{2,a,b,c}},{x,x}-&gt;{{1,a,b,c}},{x**x}-&gt;{{-1,a,b}}|&gt;</code></pre>
<p>See also: <a
href="#NCPTermsOfDegree"><code>NCPTermsOfDegree</code></a>,<a
href="#NCPTermsToNC"><code>NCPTermsToNC</code></a>.</p>
<h4 data-number="13.3.3.3" id="NCPTermsToNC"><span
class="header-section-number">13.3.3.3</span> NCPTermsToNC</h4>
<p><code>NCPTermsToNC</code> gives a nc expression corresponding to
terms produced by <code>NCPTermsOfDegree</code> or
<code>NCPTermsOfTotalDegree</code>.</p>
<p>For example:</p>
<pre><code>terms = &lt;|{x,x}-&gt;{{1,a,b,c}}, {x**x}-&gt;{{-1,a,b}}|&gt;
NCPTermsToNC[terms]</code></pre>
<p>returns</p>
<pre><code>a**x**b**c-a**x**b</code></pre>
<p>See also: <a
href="#NCPTermsOfDegree"><code>NCPTermsOfDegree</code></a>,<a
href="#NCPTermsOfTotalDegree"><code>NCPTermsOfTotalDegree</code></a>.</p>
<h3 data-number="13.3.4" id="utilities"><span
class="header-section-number">13.3.4</span> Utilities</h3>
<h4 data-number="13.3.4.1" id="NCPDegree"><span
class="header-section-number">13.3.4.1</span> NCPDegree</h4>
<p><code>NCPDegree[p]</code> gives the degree of the NCPolynomial
<code>p</code>.</p>
<p>See also: <a
href="#NCPMonomialDegree"><code>NCPMonomialDegree</code></a>.</p>
<h4 data-number="13.3.4.2" id="NCPMonomialDegree"><span
class="header-section-number">13.3.4.2</span> NCPMonomialDegree</h4>
<p><code>NCPMonomialDegree[p]</code> gives the degree of each monomial
in the NCPolynomial <code>p</code>.</p>
<p>See also: <a href="#NCPMonomialDegree"><code>NCDegree</code></a>.</p>
<h4 data-number="13.3.4.3" id="NCPCoefficients"><span
class="header-section-number">13.3.4.3</span> NCPCoefficients</h4>
<p><code>NCPCoefficients[p, m]</code> gives all coefficients of the
NCPolynomial <code>p</code> in the monomial <code>m</code>.</p>
<p>For example:</p>
<pre><code>exp = a**x**b - 2 x**y**c**x + a**c + d**x
p = NCToNCPolynomial[exp, {x, y}]
NCPCoefficients[p, {x}]</code></pre>
<p>returns</p>
<pre><code>{{1, d, 1}, {1, a, b}}</code></pre>
<p>and</p>
<pre><code>NCPCoefficients[p, {x**y, x}]</code></pre>
<p>returns</p>
<pre><code>{{-2, 1, c, 1}}</code></pre>
<p>See also: <a href="#NCPTermsToNC"><code>NCPTermsToNC</code></a>.</p>
<h4 data-number="13.3.4.4" id="NCPLinearQ"><span
class="header-section-number">13.3.4.4</span> NCPLinearQ</h4>
<p><code>NCPLinearQ[p]</code> gives True if the NCPolynomial
<code>p</code> is linear.</p>
<p>See also: <a
href="#NCPQuadraticQ"><code>NCPQuadraticQ</code></a>.</p>
<h4 data-number="13.3.4.5" id="NCPQuadraticQ"><span
class="header-section-number">13.3.4.5</span> NCPQuadraticQ</h4>
<p><code>NCPQuadraticQ[p]</code> gives True if the NCPolynomial
<code>p</code> is quadratic.</p>
<p>See also: <a href="#NCPLinearQ"><code>NCPLinearQ</code></a>.</p>
<h4 data-number="13.3.4.6" id="NCPCompatibleQ"><span
class="header-section-number">13.3.4.6</span> NCPCompatibleQ</h4>
<p><code>NCPCompatibleQ[p1,p2,...]</code> returns <em>True</em> if the
polynomials <code>p1</code>,<code>p2</code>,… have the same variables
and dimensions.</p>
<p>See also: <a href="#NCPSameVariablesQ">NCPSameVariablesQ</a>, <a
href="#NCPMatrixQ">NCPMatrixQ</a>.</p>
<h4 data-number="13.3.4.7" id="NCPSameVariablesQ"><span
class="header-section-number">13.3.4.7</span> NCPSameVariablesQ</h4>
<p><code>NCPSameVariablesQ[p1,p2,...]</code> returns <em>True</em> if
the polynomials <code>p1</code>,<code>p2</code>,… have the same
variables.</p>
<p>See also: <a href="#NCPCompatibleQ">NCPCompatibleQ</a>, <a
href="#NCPMatrixQ">NCPMatrixQ</a>.</p>
<h4 data-number="13.3.4.8" id="NCPMatrixQ"><span
class="header-section-number">13.3.4.8</span> NCPMatrixQ</h4>
<p><code>NCMatrixQ[p]</code> returns <em>True</em> if the polynomial
<code>p</code> is a matrix polynomial.</p>
<p>See also: <a href="#NCPCompatibleQ">NCPCompatibleQ</a>.</p>
<h4 data-number="13.3.4.9" id="NCPNormalize"><span
class="header-section-number">13.3.4.9</span> NCPNormalize</h4>
<p><code>NCPNormalizes[p]</code> gives a normalized version of
NCPolynomial p where all factors that have free commutative products are
collectd in the scalar.</p>
<p>This function is intended to be used mostly by developers.</p>
<p>See also: <a href="#NCPolynomial"><code>NCPolynomial</code></a></p>
<h3 data-number="13.3.5" id="operations-on-nc-polynomials"><span
class="header-section-number">13.3.5</span> Operations on NC
polynomials</h3>
<h4 data-number="13.3.5.1" id="NCPPlus"><span
class="header-section-number">13.3.5.1</span> NCPPlus</h4>
<p><code>NCPPlus[p1,p2,...]</code> gives the sum of the nc polynomials
<code>p1</code>,<code>p2</code>,… .</p>
<h4 data-number="13.3.5.2" id="NCPTimes"><span
class="header-section-number">13.3.5.2</span> NCPTimes</h4>
<p><code>NCPTimes[s,p]</code> gives the product of a commutative
<code>s</code> times the nc polynomial <code>p</code>.</p>
<h4 data-number="13.3.5.3" id="NCPDot"><span
class="header-section-number">13.3.5.3</span> NCPDot</h4>
<p><code>NCPDot[p1,p2,...]</code> gives the product of the nc
polynomials <code>p1</code>,<code>p2</code>,… .</p>
<h4 data-number="13.3.5.4" id="NCPSort"><span
class="header-section-number">13.3.5.4</span> NCPSort</h4>
<p><code>NCPSort[p]</code> gives a list of elements of the NCPolynomial
<code>p</code> in which monomials are sorted first according to their
degree then by Mathematica’s implicit ordering.</p>
<p>For example</p>
<pre><code>NCPSort[NCToNCPolynomial[c + x**x - 2 y, {x,y}]]</code></pre>
<p>will produce the list</p>
<pre><code>{c, -2 y, x**x}</code></pre>
<p>See also: <a href="#NCPDecompose">NCPDecompose</a>, <a
href="#NCDecompose">NCDecompose</a>, <a
href="#NCCompose">NCCompose</a>.</p>
<h4 data-number="13.3.5.5" id="NCPDecompose"><span
class="header-section-number">13.3.5.5</span> NCPDecompose</h4>
<p><code>NCPDecompose[p]</code> gives an association of elements of the
NCPolynomial <code>p</code> in which elements of the same order are
collected together.</p>
<p>For example</p>
<pre><code>NCPDecompose[NCToNCPolynomial[a**x**b+c+d**x**e+a**x**e**x**b+a**x**y, {x,y}]]</code></pre>
<p>will produce the Association</p>
<pre><code>&lt;|{1,0}-&gt;a**x**b + d**x**e, {1,1}-&gt;a**x**y, {2,0}-&gt;a**x**e**x**b, {0,0}-&gt;c|&gt;</code></pre>
<p>See also: <a href="#NCPSort">NCPSort</a>, <a
href="#NCDecompose">NCDecompose</a>, <a
href="#NCCompose">NCCompose</a>.</p>
<h2 data-number="13.4" id="PackageNCQuadratic"><span
class="header-section-number">13.4</span> NCQuadratic</h2>
<p><strong>NCQuadratic</strong> is a package that provides functionality
to handle quadratic polynomials in NC variables.</p>
<p>Members are:</p>
<ul>
<li><a href="#NCToNCQuadratic">NCToNCQuadratic</a></li>
<li><a href="#NCPToNCQuadratic">NCPToNCQuadratic</a></li>
<li><a href="#NCQuadraticToNC">NCQuadraticToNC</a></li>
<li><a
href="#NCQuadraticToNCPolynomial">NCQuadraticToNCPolynomial</a></li>
<li><a href="#NCMatrixOfQuadratic">NCMatrixOfQuadratic</a></li>
<li><a
href="#NCQuadraticMakeSymmetric">NCQuadraticMakeSymmetric</a></li>
</ul>
<h3 data-number="13.4.1" id="NCToNCQuadratic"><span
class="header-section-number">13.4.1</span> NCToNCQuadratic</h3>
<p><code>NCToNCQuadratic[p, vars]</code> is shorthand for</p>
<pre><code>NCPToNCQuadratic[NCToNCPolynomial[p, vars]]</code></pre>
<p>See also: <a href="#NCToNCQuadratic">NCToNCQuadratic</a>,<a
href="#NCToNCPolynomial">NCToNCPolynomial</a>.</p>
<h3 data-number="13.4.2" id="NCPToNCQuadratic"><span
class="header-section-number">13.4.2</span> NCPToNCQuadratic</h3>
<p><code>NCPToNCQuadratic[p]</code> gives an expanded representation for
the quadratic <code>NCPolynomial</code> <code>p</code>.</p>
<p><code>NCPToNCQuadratic</code> returns a list with four elements:</p>
<ul>
<li>the first element is the independent term;</li>
<li>the second represents the linear part as in <a
href="#PackageNCSylvester"><code>NCSylvester</code></a>;</li>
<li>the third element is a list of left NC symbols;</li>
<li>the fourth element is a numeric <code>SparseArray</code>;</li>
<li>the fifth element is a list of right NC symbols.</li>
</ul>
<p>Example:</p>
<pre><code>exp = d + x + x**x + x**a**x + x**e**x + x**b**y**d + d**y**c**y**d;
vars = {x,y};
p = NCToNCPolynomial[exp, vars];
{p0,sylv,left,middle,right} = NCPToNCQuadratic[p];</code></pre>
<p>produces</p>
<pre><code>p0 = d
sylv = &lt;|x-&gt;{{1},{1},SparseArray[{{1}}]}, y-&gt;{{},{},{}}|&gt;
left =  {x,d**y}
middle = SparseArray[{{1+a+e,b},{0,c}}]
right = {x,y**d}</code></pre>
<p>See also: <a href="#PackageNCSylvester">NCSylvester</a>,<a
href="#NCQuadraticToNCPolynomial">NCQuadraticToNCPolynomial</a>,<a
href="#NCPolynomial">NCPolynomial</a>.</p>
<h3 data-number="13.4.3" id="NCQuadraticToNC"><span
class="header-section-number">13.4.3</span> NCQuadraticToNC</h3>
<p><code>NCQuadraticToNC[{const, lin, left, middle, right}]</code> is
shorthand for</p>
<pre><code>NCPolynomialToNC[NCQuadraticToNCPolynomial[{const, lin, left, middle, right}]]</code></pre>
<p>See also: <a href="#NCQuadraticToNC">NCQuadraticToNCPolynomial</a>,<a
href="#NCPolynomialToNC">NCPolynomialToNC</a>.</p>
<h3 data-number="13.4.4" id="NCQuadraticToNCPolynomial"><span
class="header-section-number">13.4.4</span>
NCQuadraticToNCPolynomial</h3>
<p><code>NCQuadraticToNCPolynomial[rep]</code> takes the list
<code>rep</code> produced by <code>NCPToNCQuadratic</code> and converts
it back to an <code>NCPolynomial</code>.</p>
<p><code>NCQuadraticToNCPolynomial[rep,options]</code> uses options.</p>
<p>The following options can be given:</p>
<ul>
<li><code>Collect</code> (<em>True</em>): controls whether the
coefficients of the resulting <code>NCPolynomial</code> are collected to
produce the minimal possible number of terms.</li>
</ul>
<p>See also: <a href="#NCPToNCQuadratic">NCPToNCQuadratic</a>, <a
href="#NCPolynomial">NCPolynomial</a>.</p>
<h3 data-number="13.4.5" id="NCMatrixOfQuadratic"><span
class="header-section-number">13.4.5</span> NCMatrixOfQuadratic</h3>
<p><code>NCMatrixOfQuadratic[p, vars]</code> gives a factorization of
the symmetric quadratic function <code>p</code> in noncommutative
variables <code>vars</code> and their transposes.</p>
<p><code>NCMatrixOfQuadratic</code> checks for symmetry and
automatically sets variables to be symmetric if possible.</p>
<p>Internally it uses <a href="#NCPToNCQuadratic">NCPToNCQuadratic</a>
and <a
href="#NCQuadraticMakeSymmetric">NCQuadraticMakeSymmetric</a>.</p>
<p>It returns a list of three elements:</p>
<ul>
<li>the first is the left border row vector;</li>
<li>the second is the middle matrix;</li>
<li>the third is the right border column vector.</li>
</ul>
<p>For example:</p>
<pre><code>expr = x**y**x + z**x**x**z;
{left,middle,right}=NCMatrixOfQuadratics[expr, {x}];</code></pre>
<p>returns:</p>
<pre><code>left={x, z**x}
middle=SparseArray[{{y,0},{0,1}}]
right={x,x**z}</code></pre>
<p>The answer from <code>NCMatrixOfQuadratics</code> always satisfies
<code>p = NCDot[left,middle,right]</code>.</p>
<p>See also: <a href="#NCPToNCQuadratic">NCPToNCQuadratic</a>, <a
href="#NCQuadraticMakeSymmetric">NCQuadraticMakeSymmetric</a>.</p>
<h3 data-number="13.4.6" id="NCQuadraticMakeSymmetric"><span
class="header-section-number">13.4.6</span>
NCQuadraticMakeSymmetric</h3>
<p><code>NCQuadraticMakeSymmetric[{p0, sylv, left, middle, right}]</code>
takes the output of <a
href="#NCPToNCQuadratic"><code>NCPToNCQuadratic</code></a> and produces,
if possible, an equivalent symmetric representation in which
<code>Map[tp, left] = right</code> and <code>middle</code> is a
symmetric matrix.</p>
<p>See also: <a href="#NCPToNCQuadratic">NCPToNCQuadratic</a>.</p>
<h2 data-number="13.5" id="PackageNCSylvester"><span
class="header-section-number">13.5</span> NCSylvester</h2>
<p><strong>NCSylvester</strong> is a package that provides functionality
to handle linear polynomials in NC variables.</p>
<p>Members are:</p>
<ul>
<li><a href="#NCToNCSylvester">NCToNCSylvester</a></li>
<li><a href="#NCPToNCSylvester">NCPToNCSylvester</a></li>
<li><a href="#NCSylvesterToNC">NCSylvesterToNC</a></li>
<li><a
href="#NCSylvesterToNCPolynomial">NCSylvesterToNCPolynomial</a></li>
</ul>
<h3 data-number="13.5.1" id="NCToNCSylvester"><span
class="header-section-number">13.5.1</span> NCToNCSylvester</h3>
<p><code>NCToNCSylvester[p, vars]</code> is shorthand for</p>
<pre><code>NCPToNCSylvester[NCToNCPolynomial[p, vars]]</code></pre>
<p>See also: <a href="#NCToNCSylvester">NCToNCSylvester</a>, <a
href="#NCToNCPolynomial">NCToNCPolynomial</a>.</p>
<h3 data-number="13.5.2" id="NCPToNCSylvester"><span
class="header-section-number">13.5.2</span> NCPToNCSylvester</h3>
<p><code>NCPToNCSylvester[p]</code> gives an expanded representation for
the linear <code>NCPolynomial</code> <code>p</code>.</p>
<p><code>NCPToNCSylvester</code> returns a list with two elements:</p>
<ul>
<li><p>the first is a the independent term;</p></li>
<li><p>the second is an association where each key is one of the
variables and each value is a list with three elements:</p>
<ul>
<li>the first element is a list of left NC symbols;</li>
<li>the second element is a list of right NC symbols;</li>
<li>the third element is a numeric <code>SparseArray</code>.</li>
</ul></li>
</ul>
<p>Example:</p>
<pre><code>p = NCToNCPolynomial[2 + a**x**b + c**x**d + y, {x,y}];
{p0,sylv} = NCPolynomialToNCSylvester[p]</code></pre>
<p>produces</p>
<pre><code>p0 = 2
sylv = &lt;|x-&gt;{{a,c},{b,d},SparseArray[{{1,0},{0,1}}]}, 
         y-&gt;{{1},{1},SparseArray[{{1}}]}|&gt;</code></pre>
<p>See also: <a
href="#NCSylvesterToNCPolynomial">NCSylvesterToNCPolynomial</a>, <a
href="#NCSylvesterToNCPolynomial">NCSylvesterToNC</a>, <a
href="#NCToNCSylvester">NCToNCSylvester</a>, <a
href="#NCPolynomial">NCPolynomial</a>.</p>
<h3 data-number="13.5.3" id="NCSylvesterToNC"><span
class="header-section-number">13.5.3</span> NCSylvesterToNC</h3>
<p><code>NCSylvesterToNC[{const, lin}]</code> is shorthand for</p>
<pre><code>NCPolynomialToNC[NCSylvesterToNCPolynomial[{const, lin}]]</code></pre>
<p>See also: <a href="#NCSylvesterToNC">NCSylvesterToNCPolynomial</a>,
<a href="#NCPolynomialToNC">NCPolynomialToNC</a>.</p>
<h3 data-number="13.5.4" id="NCSylvesterToNCPolynomial"><span
class="header-section-number">13.5.4</span>
NCSylvesterToNCPolynomial</h3>
<p><code>NCSylvesterToNCPolynomial[rep]</code> takes the list
<code>rep</code> produced by <code>NCPToNCSylvester</code> and converts
it back to an <code>NCPolynomial</code>.</p>
<p><code>NCSylvesterToNCPolynomial[rep,options]</code> uses
<code>options</code>.</p>
<p>The following <code>options</code> can be given: *
<code>Collect</code> (<em>True</em>): controls whether the coefficients
of the resulting NCPolynomial are collected to produce the minimal
possible number of terms.</p>
<p>See also: <a href="#NCPToNCSylvester">NCPToNCSylvester</a>, <a
href="#NCToNCSylvester">NCToNCSylvester</a>, <a
href="#NCPolynomial">NCPolynomial</a>.</p>
<h1 data-number="14" id="NCGBChapter"><span
class="header-section-number">14</span> Noncommutative Gröbner Bases
Algorithms</h1>
<h2 data-number="14.1" id="PackageNCGBX"><span
class="header-section-number">14.1</span> NCGBX</h2>
<p>This is an interface to a Gröebner Bases code that runs purely under
Mathematica. The actual algorithm is implemented in the package <a
href="#PackageNCPolyGroebner">NCPolyGroebner</a>. Its function names,
inputs and outputs are very similar (but not always exactly the same) to
the ones provided in the legacy package <a href="#PackageNCGB">NCGB</a>,
which requires both Mathematica and auxiliary executables compiled from
C++ to run. <a href="#PackageNCGBX">NCGBX</a> may run slower on some
medium size problems but will succeed on large size problems which might
fail under <a href="#PackageNCGB">NCGB</a>.</p>
<p>Members are:</p>
<ul>
<li><a href="#SetMonomialOrder">SetMonomialOrder</a></li>
<li><a href="#SetKnowns">SetKnowns</a></li>
<li><a href="#SetUnknowns">SetUnknowns</a></li>
<li><a href="#ClearMonomialOrder">ClearMonomialOrder</a></li>
<li><a href="#GetMonomialOrder">GetMonomialOrder</a></li>
<li><a href="#PrintMonomialOrder">PrintMonomialOrder</a></li>
<li><a href="#NCMakeGB">NCMakeGB</a></li>
<li><a href="#NCProcess">NCProcess</a></li>
<li><a href="#NCGBSimplifyRational">NCGBSimplifyRational</a></li>
<li><a href="#NCReduce">NCReduce</a></li>
</ul>
<h3 data-number="14.1.1" id="SetMonomialOrder"><span
class="header-section-number">14.1.1</span> SetMonomialOrder</h3>
<p><code>SetMonomialOrder[var1, var2, ...]</code> sets the current
monomial order.</p>
<p>For example</p>
<pre><code>SetMonomialOrder[a,b,c]</code></pre>
<p>sets the lex order <span class="math inline">\(a \ll b \ll
c\)</span>.</p>
<p>If one uses a list of variables rather than a single variable as one
of the arguments, then multigraded lex order is used. For example</p>
<pre><code>SetMonomialOrder[{a,b,c}]</code></pre>
<p>sets the graded lex order <span class="math inline">\(a &lt; b &lt;
c\)</span>.</p>
<p>Another example:</p>
<pre><code>SetMonomialOrder[{{a, b}, {c}}]</code></pre>
<p>or</p>
<pre><code>SetMonomialOrder[{a, b}, c]</code></pre>
<p>set the multigraded lex order <span class="math inline">\(a &lt; b
\ll c\)</span>.</p>
<p>Finally</p>
<pre><code>SetMonomialOrder[{a,b}, {c}, {d}]</code></pre>
<p>or</p>
<pre><code>SetMonomialOrder[{a,b}, c, d]</code></pre>
<p>is equivalent to the following two commands</p>
<pre><code>SetKnowns[a,b] 
SetUnknowns[c,d]</code></pre>
<p>There is also an older syntax which is still supported:</p>
<pre><code>SetMonomialOrder[{a, b, c}, n]</code></pre>
<p>sets the order of monomials to be <span class="math inline">\(a &lt;
b &lt; c\)</span> and assigns them grading level <code>n</code>.</p>
<pre><code>SetMonomialOrder[{a, b, c}, 1]</code></pre>
<p>is equivalent to <code>SetMonomialOrder[{a, b, c}]</code>. When using
this older syntax the user is responsible for calling <a
href="#ClearMonomialOrder">ClearMonomialOrder</a> to make sure that the
current order is empty before starting.</p>
<p>In Version 6, <code>SetMonomialOrder</code> uses <a
href="#NCMonomialOrder">NCMonomialOrder</a>, and <a
href="#NCMonomialOrderQ">NCMonomialOrderQ</a>.</p>
<p>See also: <a href="#ClearMonomialOrder">ClearMonomialOrder</a>, <a
href="#GetMonomialOrder">GetMonomialOrder</a>, <a
href="#PrintMonomialOrder">PrintMonomialOrder</a>, <a
href="#SetKnowns">SetKnowns</a>, <a href="#SetUnknowns">SetUnknowns</a>,
<a href="#NCMonomialOrder">NCMonomialOrder</a>, <a
href="#NCMonomialOrderQ">NCMonomialOrderQ</a>.</p>
<h3 data-number="14.1.2" id="SetKnowns"><span
class="header-section-number">14.1.2</span> SetKnowns</h3>
<p><code>SetKnowns[var1, var2, ...]</code> records the variables
<code>var1</code>, <code>var2</code>, … to be corresponding to known
quantities.</p>
<p><code>SetUnknowns</code> and <code>Setknowns</code> prescribe a
monomial order with the knowns at the the bottom and the unknowns at the
top.</p>
<p>For example</p>
<pre><code>SetKnowns[a,b] 
SetUnknowns[c,d]</code></pre>
<p>is equivalent to</p>
<pre><code>SetMonomialOrder[{a,b}, {c}, {d}]</code></pre>
<p>which corresponds to the order <span class="math inline">\(a &lt; b
\ll c \ll d\)</span> and</p>
<pre><code>SetKnowns[a,b] 
SetUnknowns[{c,d}]</code></pre>
<p>is equivalent to</p>
<pre><code>SetMonomialOrder[{a,b}, {c, d}]</code></pre>
<p>which corresponds to the order <span class="math inline">\(a &lt; b
\ll c &lt; d\)</span>.</p>
<p>Note that <code>SetKnowns</code> flattens grading so that</p>
<pre><code>SetKnowns[a,b] </code></pre>
<p>and</p>
<pre><code>SetKnowns[{a},{b}] </code></pre>
<p>result both in the order <span class="math inline">\(a &lt;
b\)</span>.</p>
<p>Successive calls to <code>SetUnknowns</code> and
<code>SetKnowns</code> overwrite the previous knowns and unknowns. For
example</p>
<pre><code>SetKnowns[a,b] 
SetUnknowns[c,d]
SetKnowns[c,d]
SetUnknowns[a,b]</code></pre>
<p>results in an ordering <span class="math inline">\(c &lt; d \ll a \ll
b\)</span>.</p>
<p>See also: <a href="#SetUnknowns">SetUnknowns</a>, <a
href="#SetMonomialOrder">SetMonomialOrder</a>.</p>
<h3 data-number="14.1.3" id="SetUnknowns"><span
class="header-section-number">14.1.3</span> SetUnknowns</h3>
<p><code>SetUnknowns[var1, var2, ...]</code> records the variables
<code>var1</code>, <code>var2</code>, … to be corresponding to unknown
quantities.</p>
<p><code>SetUnknowns</code> and <code>SetKnowns</code> prescribe a
monomial order with the knowns at the the bottom and the unknowns at the
top.</p>
<p>For example</p>
<pre><code>SetKnowns[a,b] 
SetUnknowns[c,d]</code></pre>
<p>is equivalent to</p>
<pre><code>SetMonomialOrder[{a,b}, {c}, {d}]</code></pre>
<p>which corresponds to the order <span class="math inline">\(a &lt; b
\ll c \ll d\)</span> and</p>
<pre><code>SetKnowns[a,b] 
SetUnknowns[{c,d}]</code></pre>
<p>is equivalent to</p>
<pre><code>SetMonomialOrder[{a,b}, {c, d}]</code></pre>
<p>which corresponds to the order <span class="math inline">\(a &lt; b
\ll c &lt; d\)</span>.</p>
<p>Note that <code>SetKnowns</code> flattens grading so that</p>
<pre><code>SetKnowns[a,b] </code></pre>
<p>and</p>
<pre><code>SetKnowns[{a},{b}] </code></pre>
<p>result both in the order <span class="math inline">\(a &lt;
b\)</span>.</p>
<p>Successive calls to <code>SetUnknowns</code> and
<code>SetKnowns</code> overwrite the previous knowns and unknowns. For
example</p>
<pre><code>SetKnowns[a,b] 
SetUnknowns[c,d]
SetKnowns[c,d]
SetUnknowns[a,b]</code></pre>
<p>results in an ordering <span class="math inline">\(c &lt; d \ll a \ll
b\)</span>.</p>
<p>See also: <a href="#SetKnowns">SetKnowns</a>, <a
href="#SetMonomialOrder">SetMonomialOrder</a>.</p>
<h3 data-number="14.1.4" id="ClearMonomialOrder"><span
class="header-section-number">14.1.4</span> ClearMonomialOrder</h3>
<p><code>ClearMonomialOrder[]</code> clear the current monomial
ordering.</p>
<p>It is only necessary to use <code>ClearMonomialOrder</code> if using
the indexed version of <code>SetMonomialOrder</code>.</p>
<p>See also: <a href="#SetKnowns">SetKnowns</a>, <a
href="#SetUnknowns">SetUnknowns</a>, <a
href="#SetMonomialOrder">SetMonomialOrder</a>, <a
href="#ClearMonomialOrder">ClearMonomialOrder</a>, <a
href="#PrintMonomialOrder">PrintMonomialOrder</a>.</p>
<h3 data-number="14.1.5" id="GetMonomialOrder"><span
class="header-section-number">14.1.5</span> GetMonomialOrder</h3>
<p><code>GetMonomialOrder[]</code> returns the current monomial ordering
in the form of a list.</p>
<p>For example</p>
<pre><code>SetMonomialOrder[{a,b}, {c}, {d}]
order = GetMonomialOrder[]</code></pre>
<p>returns</p>
<pre><code>order = {{a,b},{c},{d}}</code></pre>
<p>See also: <a href="#SetKnowns">SetKnowns</a>, <a
href="#SetUnknowns">SetUnknowns</a>, <a
href="#SetMonomialOrder">SetMonomialOrder</a>, <a
href="#ClearMonomialOrder">ClearMonomialOrder</a>, <a
href="#PrintMonomialOrder">PrintMonomialOrder</a>.</p>
<h3 data-number="14.1.6" id="PrintMonomialOrder"><span
class="header-section-number">14.1.6</span> PrintMonomialOrder</h3>
<p><code>PrintMonomialOrder[]</code> prints the current monomial
ordering.</p>
<p>For example</p>
<pre><code>SetMonomialOrder[{a,b}, {c}, {d}]
PrintMonomialOrder[]</code></pre>
<p>print <span class="math inline">\(a &lt; b \ll c \ll d\)</span>.</p>
<p>See also: <a href="#SetKnowns">SetKnowns</a>, <a
href="#SetUnknowns">SetUnknowns</a>, <a
href="#SetMonomialOrder">SetMonomialOrder</a>, <a
href="#ClearMonomialOrder">ClearMonomialOrder</a>, <a
href="#PrintMonomialOrder">PrintMonomialOrder</a>.</p>
<h3 data-number="14.1.7" id="NCMakeGB"><span
class="header-section-number">14.1.7</span> NCMakeGB</h3>
<p><code>NCMakeGB[{poly1, poly2, ...}, k]</code> attempts to produces a
nc Gröbner Basis (GB) associated with the list of nc polynomials
<code>{poly1, poly2, ...}</code>. The GB algorithm proceeds through
<em>at most</em> <code>k</code> iterations until a Gröbner basis is
found for the given list of polynomials with respect to the order
imposed by <a href="#SetMonomialOrder">SetMonomialOrder</a>.</p>
<p>If <code>NCMakeGB</code> terminates before finding a GB the message
<code>NCMakeGB::Interrupted</code> is issued.</p>
<p>The output of <code>NCMakeGB</code> is a list of rules with left side
of the rule being the <em>leading</em> monomial of the polynomials in
the GB.</p>
<p>For example:</p>
<pre><code>SetMonomialOrder[x];
gb = NCMakeGB[{x^2 - 1, x^3 - 1}, 20]</code></pre>
<p>returns</p>
<pre><code>gb = {x -&gt; 1}</code></pre>
<p>that corresponds to the polynomial <span class="math inline">\(x -
1\)</span>, which is the nc Gröbner basis for the ideal generated by
<span class="math inline">\(x^2-1\)</span> and <span
class="math inline">\(x^3-1\)</span>.</p>
<p><code>NCMakeGB[{poly1, poly2, ...}, k, options]</code> uses
<code>options</code>.</p>
<p>For example</p>
<pre><code>gb = NCMakeGB[{x^2 - 1, x^3 - 1}, 20, RedudeBasis -&gt; True]</code></pre>
<p>runs the Gröbner basis algortihm and completely reduces the output
set of polynomials.</p>
<p>The following <code>options</code> can be given:</p>
<ul>
<li><code>ReduceBasis</code> (<code>True</code>): control whether the
resulting basis output by the command is a reduced Gröbner basis at the
completion of the algorithm. This corresponds to running
<code>NCReduce</code> with the Boolean flag <code>True</code> to
completely reduce the output basis. Can be set globally as
<code>SetOptions[NCMakeGB, ReturnBasis -&gt; True]</code>.</li>
<li><code>SimplifyObstructions</code> (<code>True</code>): control
whether whether to remove obstructions before constructing more
S-polynomials;</li>
<li><code>SortObstructions</code> (<code>False</code>): control whether
obstructions are sorted before being processed;</li>
<li><code>SortBasis</code> (<code>False</code>): control whether initial
basis is sorted before initiating algorithm;</li>
<li><code>VerboseLevel</code> (<code>1</code>): control level of
verbosity from <code>0</code> (no messages) to <code>5</code> (very
verbose);</li>
<li><code>PrintBasis</code> (<code>False</code>): if <code>True</code>
prints current basis at each major iteration;</li>
<li><code>PrintObstructions</code> (<code>False</code>): if
<code>True</code> prints current list of obstructions at each major
iteration;</li>
<li><code>PrintSPolynomials</code> (<code>False</code>): if
<code>True</code> prints every S-polynomial formed at each minor
iteration.</li>
<li><code>ReturnRules</code> (<code>True</code>): if <code>True</code>
rules representing relations in which the left-hand side is the leading
monomial are returned instead of polynomials. Use <code>False</code> for
backward compatibility. Can be set globally as
<code>SetOptions[NCMakeGB, ReturnRules -&gt; False]</code>.</li>
</ul>
<p><code>NCMakeGB</code> makes use of the algorithm
<code>NCPolyGroebner</code> implemented in <a
href="#NCPolyGroebner">NCPolyGroebner</a>.</p>
<p>In Version 6, <code>NCMakeGB</code> uses <a
href="#NCRationalToNCPoly">NCRationalToNCPoly</a> to add additional
relations involving rational variables and rational terms.</p>
<p>See also: <a href="#NCRationalToNCPoly">NCRationalToNCPoly</a>, <a
href="#NCReduce">NCReduce</a>, <a
href="#ClearMonomialOrder">ClearMonomialOrder</a>, <a
href="#GetMonomialOrder">GetMonomialOrder</a>, <a
href="#PrintMonomialOrder">PrintMonomialOrder</a>, <a
href="#SetKnowns">SetKnowns</a>, <a href="#SetUnknowns">SetUnknowns</a>,
<a href="#NCPolyGroebner">NCPolyGroebner</a>.</p>
<h3 data-number="14.1.8" id="NCProcess"><span
class="header-section-number">14.1.8</span> NCProcess</h3>
<p><code>NCProcess[{poly1, poly2, ...}, k]</code> finds a new generating
set for the ideal generated by <code>{poly1, poly2, ...}</code> using <a
href="#NCMakeGB">NCMakeGB</a> then produces an summary report on the
findings.</p>
<p>Not all features of <code>NCProcess</code> in the old
<code>NCGB</code> C++ version are supported yet.</p>
<p>See also: <a href="#NCMakeGB">NCMakeGB</a>.</p>
<h3 data-number="14.1.9" id="NCGBSimplifyRational"><span
class="header-section-number">14.1.9</span> NCGBSimplifyRational</h3>
<p><code>NCGBSimplifyRational[expr]</code> creates a set of relations
for each rational expression and sub-expression found in
<code>expr</code> which are used to produce simplification rules using
<a href="#NCMakeGB">NCMakeGB</a> then replaced using <a
href="#NCReduce">NCReduce</a>.</p>
<p>For example:</p>
<pre><code>expr = x ** inv[1 - x] - inv[1 - x] ** x
NCGBSimplifyRational[expr]</code></pre>
<p>or</p>
<pre><code>expr = inv[1 - x - y ** inv[1 - x] ** y] - 1/2 (inv[1 - x + y] + inv[1 - x - y])
NCGBSimplifyRational[expr]</code></pre>
<p>both result in <code>0</code>.</p>
<p>See also: <a href="#NCMakeGB">NCMakeGB</a>, <a
href="#NCReduce">NCReduce</a>.</p>
<!-- ### NCReduce {#NCReduce} -->
<!-- `NCReduce[polys, rules]` reduces the list of polynomials `polys` with -->
<!-- respect to the list of polyomials `rules`. The substitutions implied -->
<!-- by `rules` are applied repeatedly to the polynomials in the `polys` -->
<!-- until no further reduction occurs. -->
<!-- `NCReduce[polys]` reduces each polynomial in the list of polynomials -->
<!-- `polys` with respect to the remaining elements of the list of -->
<!-- polyomials `polys` until no further reduction occurs. -->
<!-- By default, `NCReduce` only reduces the leading monomial in the -->
<!-- current order. Use the optional boolean flag `complete` to completely -->
<!-- reduce all monomials. For example, `NCReduce[polys, rules, True]` and -->
<!-- `NCReduce[polys, True]`. -->
<!-- See also: -->
<!-- [NCMakeGB](#NCMakeGB), -->
<!-- [NCGBSimplifyRational](#NCGBSimplifyRational). -->
<h2 data-number="14.2" id="PackageNCPolyGroebner"><span
class="header-section-number">14.2</span> NCPolyGroebner</h2>
<p>This packages implements a Gröebner Bases algorithm that runs purely
under Mathematica. This algorithm is the one called by the user-friendly
functions in the package <a href="#PackageNCGBX">NCGBX</a>.</p>
<p>Members are:</p>
<ul>
<li><a href="#NCPolyGroebner">NCPolyGroebner</a></li>
</ul>
<h3 data-number="14.2.1" id="NCPolyGroebner"><span
class="header-section-number">14.2.1</span> NCPolyGroebner</h3>
<p><code>NCPolyGroebner[G, iter]</code> computes the noncommutative
Groebner basis of the list of <code>NCPoly</code> polynomials
<code>G</code>. The algorithm either converges before or is interrupted
when the number of iterations reach <code>iter</code>.</p>
<p><code>NCPolyGroebner[G, iter, options]</code> uses
<code>options</code>.</p>
<p>The following <code>options</code> can be given:</p>
<ul>
<li><code>SimplifyObstructions</code> (<code>True</code>) whether to
remove obstructions before constructing more S-polynomials;</li>
<li><code>SortObstructions</code> (<code>False</code>) whether to sort
obstructions using Mora’s SUGAR ranking;</li>
<li><code>SortBasis</code> (<code>False</code>) whether to sort basis
before starting algorithm;</li>
<li><code>Labels</code> (<code>{}</code>) list of labels to use in
verbose printing;</li>
<li><code>VerboseLevel</code> (<code>1</code>): function used to decide
if a pivot is zero;</li>
<li><code>PrintBasis</code> (<code>False</code>): function used to
divide a vector by an entry;</li>
<li><code>PrintObstructions</code> (<code>False</code>);</li>
<li><code>PrintSPolynomials</code> (<code>False</code>);</li>
</ul>
<p>The algorithm is based on <span class="citation"
data-cites="mora:ICN:1994">(Mora 1994)</span> and uses the terminology
there.</p>
<p>See also: <a href="#NCPoly">NCPoly</a>.</p>
<h2 data-number="14.3" id="PackageNCGB"><span
class="header-section-number">14.3</span> NCGB</h2>
<p>This packages supports our legacy Gröebner Bases algorithm that
requires both Mathematica and auxiliary executables compiled from C++ to
run. <a href="#PackageNCGBX">NCGBX</a> may run slower on some medium
size problems but will succeed on large size problems which might fail
under <a href="#PackageNCGB">NCGB</a>.</p>
<p>This code has become hard to maintain and support and may be
deprecated in the future. See older versions of the NC documentation for
a complete description of its functionality.</p>
<h1 data-number="15" id="SDPChapter"><span
class="header-section-number">15</span> Semidefinite Programming
Algorithms</h1>
<h2 data-number="15.1" id="PackageNCSDP"><span
class="header-section-number">15.1</span> NCSDP</h2>
<p><strong>NCSDP</strong> is a package that allows the symbolic
manipulation and numeric solution of semidefinite programs.</p>
<p>Members are:</p>
<ul>
<li><a href="#NCSDP">NCSDP</a></li>
<li><a href="#NCSDPForm">NCSDPForm</a></li>
<li><a href="#NCSDPDual">NCSDPDual</a></li>
<li><a href="#NCSDPDualForm">NCSDPDualForm</a></li>
</ul>
<h3 data-number="15.1.1" id="NCSDP"><span
class="header-section-number">15.1.1</span> NCSDP</h3>
<p><code>NCSDP[inequalities,vars,obj,data]</code> converts the list of
NC polynomials and NC matrices of polynomials <code>inequalities</code>
that are linear in the unknowns listed in <code>vars</code> into the
semidefinite program with linear objective <code>obj</code>. The
semidefinite program (SDP) should be given in the following canonical
form:</p>
<pre><code>max  &lt;obj, vars&gt;  s.t.  inequalities &lt;= 0.</code></pre>
<p>It returns a list with two entries:</p>
<ul>
<li>The first is a list with the an instance of <a
href="#PackageSDPSylvester">SDPSylvester</a>;</li>
<li>The second is a list of rules with properties of certain
variables.</li>
</ul>
<p>Both entries should be supplied to <a href="#SDPSolve">SDPSolve</a>
in order to numerically solve the semidefinite program. For example:</p>
<pre><code>{abc, rules} = NCSDP[inequalities, vars, obj, data];</code></pre>
<p>generates an instance of <a
href="#PackageSDPSylvester">SDPSylvester</a> that can be solved
using:</p>
<pre><code>&lt;&lt; SDPSylvester`
{Y, X, S, flags} = SDPSolve[abc, rules];</code></pre>
<p><code>NCSDP</code> uses the user supplied rules in <code>data</code>
to set up the problem data.</p>
<p><code>NCSDP[inequalities,vars,data]</code> converts problem into a
feasibility semidefinite program.</p>
<p><code>NCSDP[inequalities,vars,obj,data,options]</code> uses
<code>options</code>.</p>
<p>The following <code>options</code> can be given:</p>
<ul>
<li><code>DebugLevel</code> (<code>0</code>): control printing of
debugging information.</li>
</ul>
<p>See also: <a href="#NCSDPForm">NCSDPForm</a>, <a
href="#NCSDPDual">NCSDPDual</a>, <a href="#SDPSolve">SDPSolve</a>.</p>
<h3 data-number="15.1.2" id="NCSDPForm"><span
class="header-section-number">15.1.2</span> NCSDPForm</h3>
<p><code>NCSDPForm[[inequalities,vars,obj]</code> prints out a pretty
formatted version of the SDP expressed by the list of NC polynomials and
NC matrices of polynomials <code>inequalities</code> that are linear in
the unknowns listed in <code>vars</code>.</p>
<p>See also: <a href="#NCSDP">NCSDP</a>, <a
href="#NCSDPDualForm">NCSDPDualForm</a>.</p>
<h3 data-number="15.1.3" id="NCSDPDual"><span
class="header-section-number">15.1.3</span> NCSDPDual</h3>
<p><code>{dInequalities, dVars, dObj} = NCSDPDual[inequalities,vars,obj]</code>
calculates the symbolic dual of the SDP expressed by the list of NC
polynomials and NC matrices of polynomials <code>inequalities</code>
that are linear in the unknowns listed in <code>vars</code> with linear
objective <code>obj</code> into a dual semidefinite in the following
canonical form:</p>
<pre><code>max &lt;dObj, dVars&gt;  s.t.  dInequalities == 0,   dVars &gt;= 0.</code></pre>
<p><code>{dInequalities, dVars, dObj} = NCSDPDual[inequalities,vars,obj,dualVars]</code>
uses the symbols in <code>dualVars</code> as <code>dVars</code>.</p>
<p><code>NCSDPDual[inequalities,vars,...,options]</code> uses
<code>options</code>.</p>
<p>The following <code>options</code> can be given:</p>
<ul>
<li><code>DualSymbol</code> (<code>"w"</code>): letter to be used as
symbol for dual variable;</li>
<li><code>DebugLevel</code> (<code>0</code>): control printing of
debugging information.</li>
</ul>
<p>See also: <a href="#NCSDPDualForm">NCSDPDualForm</a>, <a
href="#NCSDP">NCSDP</a>.</p>
<h3 data-number="15.1.4" id="NCSDPDualForm"><span
class="header-section-number">15.1.4</span> NCSDPDualForm</h3>
<p><code>NCSDPForm[[dInequalities,dVars,dObj]</code> prints out a pretty
formatted version of the dual SDP expressed by the list of NC
polynomials and NC matrices of polynomials <code>dInequalities</code>
that are linear in the unknowns listed in <code>dVars</code> with linear
objective <code>dObj</code>.</p>
<p>See also: <a href="#NCSDPDual">NCSDPDual</a>, <a
href="#NCSDPForm">NCSDPForm</a>.</p>
<h2 data-number="15.2" id="PackageSDP"><span
class="header-section-number">15.2</span> SDP</h2>
<p><code>SDP</code> is a package that provides data structures for the
numeric solution of semidefinite programs of the form: <span
class="math display">\[
\begin{aligned}
  \max_{y, S} \quad &amp; b^T y \\
  \text{s.t.} \quad &amp; A y + S = c \\
                    &amp; S \succeq 0
\end{aligned}
\]</span> where <span class="math inline">\(S\)</span> is a symmetric
positive semidefinite matrix and <span class="math inline">\(y\)</span>
is a vector of decision variables.</p>
<p>See the package <a href="#PackageSDP">SDP</a> for a potentially more
efficient alternative to the basic implementation provided by this
package.</p>
<p>Members are:</p>
<ul>
<li><a href="#SDPMatrices">SDPMatrices</a></li>
<li><a href="#SDPSolve">SDPSolve</a></li>
<li><a href="#SDPEval">SDPEval</a></li>
<li><a href="#SDPPrimalEval">SDPPrimalEval</a></li>
<li><a href="#SDPDualEval">SDPDualEval</a></li>
<li><a href="#SDPSylvesterEval">SDPSylvesterEval</a></li>
</ul>
<h3 data-number="15.2.1" id="SDPMatrices"><span
class="header-section-number">15.2.1</span> SDPMatrices</h3>
<p><code>SDPMatrices[f, G, y]</code> converts the symbolic linear
functions <code>f</code>, <code>G</code> in the variables <code>y</code>
associated to the semidefinite program:</p>
<p><span class="math display">\[
\begin{aligned}
  \min_y \quad &amp; f(y), \\
  \text{s.t.} \quad &amp; G(y) \succeq 0
\end{aligned}
\]</span></p>
<p>into numerical data that can be used to solve an SDP in the form:</p>
<p><span class="math display">\[
\begin{aligned}
  \max_{y, S} \quad &amp; b^T y \\
  \text{s.t.} \quad &amp; A y + S = c \\
                    &amp; S \succeq 0
\end{aligned}
\]</span></p>
<p><code>SDPMatrices</code> returns a list with three entries:</p>
<ul>
<li>The first is the coefficient array <code>A</code>;</li>
<li>The second is the coefficient array <code>b</code>;</li>
<li>The third is the coefficient array <code>c</code>.</li>
</ul>
<p>For example:</p>
<pre><code>f = -x
G = {{1, x}, {x, 1}}
vars = {x}
{A,b,c} = SDPMatrices[f, G, vars]</code></pre>
<p>results in</p>
<pre><code>A = {{{{0, -1}, {-1, 0}}}}
b = {{{1}}}
c = {{{1, 0}, {0, 1}}}</code></pre>
<p>All data is stored as <code>SparseArray</code>s.</p>
<p>See also: <a href="#SDPSolve">SDPSolve</a>.</p>
<h3 data-number="15.2.2" id="SDPSolve"><span
class="header-section-number">15.2.2</span> SDPSolve</h3>
<p><code>SDPSolve[{A,b,c}]</code> solves an SDP in the form:</p>
<p><span class="math display">\[
\begin{aligned}
  \max_{y, S} \quad &amp; b^T y \\
  \text{s.t.} \quad &amp; A y + S = c \\
                    &amp; S \succeq 0
\end{aligned}
\]</span></p>
<p><code>SDPSolve</code> returns a list with four entries:</p>
<ul>
<li>The first is the primal solution <span
class="math inline">\(y\)</span>;</li>
<li>The second is the dual solution <span
class="math inline">\(X\)</span>;</li>
<li>The third is the primal slack variable <span
class="math inline">\(S\)</span>;</li>
<li>The fourth is a list of flags:
<ul>
<li><code>PrimalFeasible</code>: <code>True</code> if primal problem is
feasible;</li>
<li><code>FeasibilityRadius</code>: less than one if primal problem is
feasible;</li>
<li><code>PrimalFeasibilityMargin</code>: close to zero if primal
problem is feasible;</li>
<li><code>DualFeasible</code>: <code>True</code> if dual problem is
feasible;</li>
<li><code>DualFeasibilityRadius</code>: close to zero if dual problem is
feasible.</li>
</ul></li>
</ul>
<p>For example:</p>
<pre><code>{Y, X, S, flags} = SDPSolve[abc]</code></pre>
<p>solves the SDP <code>abc</code>.</p>
<p><code>SDPSolve[{A,b,c}, options]</code> uses
<code>options</code>.</p>
<p><code>options</code> are those of <a
href="#PrimalDual">PrimalDual</a>.</p>
<p>See also: <a href="#SDPMatrices">SDPMatrices</a>.</p>
<h3 data-number="15.2.3" id="SDPEval"><span
class="header-section-number">15.2.3</span> SDPEval</h3>
<p><code>SDPEval[A, y]</code> evaluates the linear function <span
class="math inline">\(A y\)</span> in an <code>SDP</code>.</p>
<p>This is a convenient replacement for <a
href="#SDPPrimalEval">SDPPrimalEval</a> in which the list <code>y</code>
can be used directly.</p>
<p>See also: <a href="#SDPPrimalEval">SDPPrimalEval</a>, <a
href="#SDPDualEval">SDPDualEval</a>, <a href="#SDPSolve">SDPSolve</a>,
<a href="#SDPMatrices">SDPMatrices</a>.</p>
<h3 data-number="15.2.4" id="SDPPrimalEval"><span
class="header-section-number">15.2.4</span> SDPPrimalEval</h3>
<p><code>SDPPrimalEval[A, {{y}}]</code> evaluates the linear function
<span class="math inline">\(A y\)</span> in an <code>SDP</code>.</p>
<p>See <a href="#SDPEval">SDPEval</a> for a convenient replacement for
<code>SDPPrimalEval</code> in which the list <code>y</code> can be used
directly.</p>
<p>See also: <a href="#SDPEval">SDPEval</a>, <a
href="#SDPDualEval">SDPDualEval</a>, <a href="#SDPSolve">SDPSolve</a>,
<a href="#SDPMatrices">SDPMatrices</a>.</p>
<h3 data-number="15.2.5" id="SDPDualEval"><span
class="header-section-number">15.2.5</span> SDPDualEval</h3>
<p><code>SDPDualEval[A, X]</code> evaluates the linear function <span
class="math inline">\(A^* X\)</span> in an <code>SDP</code>.</p>
<p>See also: <a href="#SDPPrimalEval">SDPPrimalEval</a>, <a
href="#SDPSolve">SDPSolve</a>, <a
href="#SDPMatrices">SDPMatrices</a>.</p>
<h3 data-number="15.2.6" id="SDPSylvesterEval"><span
class="header-section-number">15.2.6</span> SDPSylvesterEval</h3>
<p><code>SDPSylvesterEval[a, W]</code> returns a matrix representation
of the Sylvester mapping <span class="math inline">\(A^* (W A (\Delta_y)
W)\)</span> when applied to the scaling <code>W</code>.</p>
<p><code>SDPSylvesterEval[a, Wl, Wr]</code> returns a matrix
representation of the Sylvester mapping <span class="math inline">\(A^*
(W_l A (\Delta_y) W_r)\)</span> when applied to the left- and
right-scalings <code>Wl</code> and <code>Wr</code>.</p>
<p>See also: <a href="#SDPPrimalEval">SDPPrimalEval</a>, <a
href="#SDPDualEval">SDPDualEval</a>.</p>
<h2 data-number="15.3" id="PackageSDPFlat"><span
class="header-section-number">15.3</span> SDPFlat</h2>
<p><code>SDPFlat</code> is a package that provides data structures for
the numeric solution of semidefinite programs of the form: <span
class="math display">\[
\begin{aligned}
  \max_{y, S} \quad &amp; b^T y \\
  \text{s.t.} \quad &amp; A y + S = c \\
                    &amp; S \succeq 0
\end{aligned}
\]</span> where <span class="math inline">\(S\)</span> is a symmetric
positive semidefinite matrix and <span class="math inline">\(y\)</span>
is a vector of decision variables.</p>
<p>It is a potentially more efficient alternative to the basic
implementation provided by the package <a
href="#PackageSDP">SDP</a>.</p>
<p>Members are:</p>
<ul>
<li><a href="#SDPFlatData">SDPFlatData</a></li>
<li><a href="#SDPFlatPrimalEval">SDPFlatPrimalEval</a></li>
<li><a href="#SDPFlatDualEval">SDPFlatDualEval</a></li>
<li><a href="#SDPFlatSylvesterEval">SDPFlatSylvesterEval</a></li>
</ul>
<h3 data-number="15.3.1" id="SDPFlatData"><span
class="header-section-number">15.3.1</span> SDPFlatData</h3>
<p><code>SDPFlatData[{a,b,c}]</code> converts the triplet
<code>{a,b,c}</code> from the format of the package <a
href="#PackageSDP">SDP</a> to the <code>SDPFlat</code> format.</p>
<p>It returns a list with four entries:</p>
<ul>
<li>The first is the input array <code>a</code>;</li>
<li>The second is its flattened version <code>AFlat</code>;</li>
<li>The third is the flattened version of <code>c</code>,
<code>cFlat</code>;</li>
<li>The fourth is an array with the flattened dimensions.</li>
</ul>
<p>See also: <a href="#PackageSDP">SDP</a>.</p>
<h3 data-number="15.3.2" id="SDPFlatPrimalEval"><span
class="header-section-number">15.3.2</span> SDPFlatPrimalEval</h3>
<p><code>SDPFlatPrimalEval[aFlat, y]</code> evaluates the linear
function <span class="math inline">\(A y\)</span> in an
<code>SDPFlat</code>.</p>
<p>See also: <a href="#SDPFlatDualEval">SDPFlatDualEval</a>, <a
href="#SDPFlatSylvesterEval">SDPFlatSylvesterEval</a>.</p>
<h3 data-number="15.3.3" id="SDPFlatDualEval"><span
class="header-section-number">15.3.3</span> SDPFlatDualEval</h3>
<p><code>SDPFlatDualEval[aFlat, X]</code> evaluates the linear function
<span class="math inline">\(A^* X\)</span> in an
<code>SDPFlat</code>.</p>
<p>See also: <a href="#SDPFlatPrimalEval">SDPFlatPrimalEval</a>, <a
href="#SDPFlatSylvesterEval">SDPFlatSylvesterEval</a>.</p>
<h3 data-number="15.3.4" id="SDPFlatSylvesterEval"><span
class="header-section-number">15.3.4</span> SDPFlatSylvesterEval</h3>
<p><code>SDPFlatSylvesterEval[a, aFlat, W]</code> returns a matrix
representation of the Sylvester mapping <span class="math inline">\(A^*
(W A (\Delta_y) W)\)</span> when applied to the scaling
<code>W</code>.</p>
<p><code>SDPFlatSylvesterEval[a, aFlat, Wl, Wr]</code> returns a matrix
representation of the Sylvester mapping <span class="math inline">\(A^*
(W_l A (\Delta_y) W_r)\)</span> when applied to the left- and
right-scalings <code>Wl</code> and <code>Wr</code>.</p>
<p>See also: <a href="#SDPFlatPrimalEval">SDPFlatPrimalEval</a>, <a
href="#SDPFlatDualEval">SDPFlatDualEval</a>.</p>
<h2 data-number="15.4" id="PackageSDPSylvester"><span
class="header-section-number">15.4</span> SDPSylvester</h2>
<p><code>SDPSylvester</code> is a package that provides data structures
for the numeric solution of semidefinite programs of the form: <span
class="math display">\[
\begin{aligned}
  \max_{y, S} \quad &amp; \sum_i \operatorname{trace}(b_i^T y_i) \\
  \text{s.t.} \quad &amp; A y + S = \frac{1}{2} \sum_i a_i y_i b_i +
(a_i y_i b_i)^T + S = C \\
                    &amp; S \succeq 0
\end{aligned}
\]</span> where <span class="math inline">\(S\)</span> is a symmetric
positive semidefinite matrix and <span class="math inline">\(y = \{ y_1,
\ldots, y_n \}\)</span> is a list of matrix decision variables.</p>
<p>Members are:</p>
<ul>
<li><a href="#SDPSylvesterSDPEval">SDPEval</a></li>
<li><a href="#SDPSylvesterPrimalEval">SDPSylvesterPrimalEval</a></li>
<li><a href="#SDPSylvesterDualEval">SDPSylvesterDualEval</a></li>
<li><a
href="#SDPSylvesterSylvesterEval">SDPSylvesterSylvesterEval</a></li>
</ul>
<h3 data-number="15.4.1" id="SDPSylvesterSDPEval"><span
class="header-section-number">15.4.1</span> SDPEval</h3>
<p><code>SDPEval[A, y]</code> evaluates the linear function <span
class="math inline">\(A y = \frac{1}{2} \sum_i a_i y_i b_i + (a_i y_i
b_i)^T\)</span> in an <code>SDPSylvester</code>.</p>
<p>This is a convenient replacement for <a
href="#SDPSylvesterPrimalEval">SDPSylvesterPrimalEval</a> in which the
list <code>y</code> can be used directly.</p>
<p>See also: <a
href="#SDPSylvesterPrimalEval">SDPSylvesterPrimalEval</a>, <a
href="#SDPSylvesterDualEval">SDPSylvesterDualEval</a>.</p>
<h3 data-number="15.4.2" id="SDPSylvesterPrimalEval"><span
class="header-section-number">15.4.2</span> SDPSylvesterPrimalEval</h3>
<p><code>SDPSylvesterPrimalEval[a, y]</code> evaluates the linear
function <span class="math inline">\(A y = \frac{1}{2} \sum_i a_i y_i
b_i + (a_i y_i b_i)^T\)</span> in an <code>SDPSylvester</code>.</p>
<p>See <a href="#SDPSylvesterEval">SDPSylvesterEval</a> for a convenient
replacement for <code>SDPPrimalEval</code> in which the list
<code>y</code> can be used directly.</p>
<p>See also: <a href="#SDPSylvesterDualEval">SDPSylvesterDualEval</a>,
<a href="#SDPSylvesterSylvesterEval">SDPSylvesterSylvesterEval</a>.</p>
<h3 data-number="15.4.3" id="SDPSylvesterDualEval"><span
class="header-section-number">15.4.3</span> SDPSylvesterDualEval</h3>
<p><code>SDPSylvesterDualEval[A, X]</code> evaluates the linear function
<span class="math inline">\(A^* X = \{ b_1 X a_1, \cdots, b_n X a_n
\}\)</span> in an <code>SDPSylvester</code>.</p>
<p>For example</p>
<p>See also: <a
href="#SDPSylvesterPrimalEval">SDPSylvesterPrimalEval</a>, <a
href="#SDPSylvesterSylvesterEval">SDPSylvesterSylvesterEval</a>.</p>
<h3 data-number="15.4.4" id="SDPSylvesterSylvesterEval"><span
class="header-section-number">15.4.4</span>
SDPSylvesterSylvesterEval</h3>
<p><code>SDPSylvesterEval[a, W]</code> returns a matrix representation
of the Sylvester mapping <span class="math inline">\(A^* (W A (\Delta_y)
W)\)</span> when applied to the scaling <code>W</code>.</p>
<p><code>SDPSylvesterEval[a, Wl, Wr]</code> returns a matrix
representation of the Sylvester mapping <span class="math inline">\(A^*
(W_l A (\Delta_y) W_r)\)</span> when applied to the left- and
right-scalings <code>Wl</code> and <code>Wr</code>.</p>
<p>See also: <a
href="#SDPSylvesterPrimalEval">SDPSylvesterPrimalEval</a>, <a
href="#SDPSylvesterDualEval">SDPSylvesterDualEval</a>.</p>
<h2 data-number="15.5" id="PackagePrimalDual"><span
class="header-section-number">15.5</span> PrimalDual</h2>
<p><code>PrimalDual</code> provides an algorithm for solving a pair of
primal-dual semidefinite programs in the form <span
class="math display">\[
\tag{Primal}
\begin{aligned}
  \min_{X} \quad &amp; \operatorname{trace}(c X) \\
  \text{s.t.} \quad &amp; A^*(X) = b \\
                    &amp; X \succeq 0
\end{aligned}
\]</span> <span class="math display">\[
\tag{Dual}
\begin{aligned}
  \max_{y, S} \quad &amp; b^T y \\
  \text{s.t.} \quad &amp; A(y) + S = c \\
                    &amp; S \succeq 0
\end{aligned}
\]</span> where <span class="math inline">\(X\)</span> is the primal
variable and <span class="math inline">\((y,S)\)</span> are the dual
variables.</p>
<p>The algorithm is parametrized and users should provide their own
means of evaluating the mappings <span class="math inline">\(A\)</span>,
<span class="math inline">\(A^*\)</span> and also the Sylvester mapping
<span class="math display">\[
    A^*(W_l A(\Delta_y) W_r)
\]</span> used to solve the least-square subproblem.</p>
<p>Users can develop custom algorithms that can take advantage of
special structure, as done for instance in <a
href="#PackageNCSDP">NCSDP</a>.</p>
<p>The algorithm constructs a feasible solution using the Self-Dual
Embedding of [].</p>
<p>Members are:</p>
<ul>
<li><a href="#PrimalDual">PrimalDual</a></li>
</ul>
<h3 data-number="15.5.1" id="PrimalDual"><span
class="header-section-number">15.5.1</span> PrimalDual</h3>
<p><code>PrimalDual[PrimalEval,DualEval,SylvesterEval,b,c]</code> solves
the semidefinite program using a primal dual method.</p>
<p><code>PrimalEval</code> should return the primal mapping <span
class="math inline">\(A^*(X)\)</span> when applied to the current primal
variable <code>X</code> as in <code>PrimalEval @@ X</code>.</p>
<p><code>DualEval</code> should return the dual mapping <span
class="math inline">\(A(y)\)</span> when applied to the current dual
variable <code>y</code> as in <code>DualEval @@ y</code>.</p>
<p><code>SylvesterVecEval</code> should return a matrix representation
of the Sylvester mapping <span class="math inline">\(A^* (W_l A
(\Delta_y) W_r)\)</span> when applied to the left- and right-scalings
<code>Wl</code> and <code>Wr</code> as in
<code>SylvesterVecEval @@ {Wl, Wr}</code>.</p>
<p><code>PrimalDual[PrimalEval,DualEval,SylvesterEval,b,c,options]</code>
uses <code>options</code>.</p>
<p>The following <code>options</code> can be given:</p>
<ul>
<li><p><code>Method</code> (<code>PredictorCorrector</code>): choice of
method for updating duality gap; possible options are
<code>ShortStep</code>, <code>LongStep</code> and
<code>PredictorCorrector</code>;</p></li>
<li><p><code>SearchDirection</code> (<code>NT</code>): choice of search
direction to use; possible options are <code>NT</code> for
Nesterov-Todd, <code>KSH</code> for HRVM/KSH/M, <code>KSHDual</code> for
dual HRVM/KSH/M;</p></li>
<li><p><code>FeasibilityTol</code> (10^-3): tolerance used to assess
feasibility;</p></li>
<li><p><code>GapTol</code> (10^-9): tolerance used to assess
optimality;</p></li>
<li><p><code>MaxIter</code> (250): maximum number of iterations
allowed;</p></li>
<li><p><code>SparseWeights</code> (<code>True</code>): whether weights
should be converted to a <code>SparseArray</code>;</p></li>
<li><p><code>RationalizeIterates</code> (<code>False</code>): whether to
rationalize iterates in an attempt to construct a rational
solution;</p></li>
<li><p><code>SymmetricVariables</code> (<code>{}</code>): list of index
of dual variables to be considered symmetric.</p></li>
<li><p><code>ScaleHessian</code> (<code>True</code>): whether to scale
the least-squares subproblem coefficient matrix;</p></li>
<li><p><code>PrintSummary</code> (<code>True</code>): whether to print
summary information;</p></li>
<li><p><code>PrintIterations</code> (<code>True</code>): whether to
print progrees at each iteration;</p></li>
<li><p><code>DebugLevel</code> (0): whether to print debug
information;</p></li>
<li><p><code>Profiling</code> (<code>False</code>): whether to print
messages with detailed timing of steps.</p></li>
</ul>
<h2 data-number="15.6" id="PackageNCPolySOS"><span
class="header-section-number">15.6</span> NCPolySOS</h2>
<p>Members are:</p>
<ul>
<li><a href="#NCPolySOS">NCPolySOS</a></li>
<li><a href="#NCPolySOSToSDP">NCPolySOSToSDP</a></li>
</ul>
<h3 data-number="15.6.1" id="NCPolySOS"><span
class="header-section-number">15.6.1</span> NCPolySOS</h3>
<p><code>NCPolySOS[degree, var]</code> returns an <code>NCPoly</code>
with symbolic coefficients on the variable <code>var</code>
corresponding to a possible Gram representation of an noncommutative SOS
polynomial of degree <code>degree</code> and its corresponding Gram
matrix.</p>
<p><code>NCPolySOS[poly, var]</code> uses <a
href="#NCPolyQuadraticChipset">NCPolyQuadraticChipset</a> to generate a
sparse Gram representation of the noncommutative polynomial
<code>poly</code>.</p>
<p><code>NCPolySOS[degree]</code> and <code>NCPolySOS[p]</code> returns
the answer in terms of a newly created unique symbol.</p>
<p>For example,</p>
<pre><code>{q,Q,x} = NCPolySOS[4];</code></pre>
<p>returns the symbolic SOS <code>NCPoly</code> <code>q</code> and its
Gram matrix <code>Q</code> expressed in terms of the variable
<code>x</code>, and</p>
<pre><code>{q,Q,x,chipset} = NCPolySOS[poly];</code></pre>
<p>returns the symbolic NCPoly <code>q</code> and its Gram matrix
<code>Q</code> corresponding to terms in the quadratic
<code>chipset</code> expressed in terms of the variable
<code>x</code>.</p>
<p>See also: <a href="#NCPolySOSToSDP">NCPolySOSToSDP</a>, <a
href="#NCPolyQuadraticChipset">NCPolyQuadraticChipset</a></p>
<h3 data-number="15.6.2" id="NCPolySOSToSDP"><span
class="header-section-number">15.6.2</span> NCPolySOSToSDP</h3>
<p><code>{sdp, vars, sol, solQ} = NCPolySOSToSDP[ps, Qs, var]</code>
returns a semidefinite constraint <code>sdp</code> in the variables
<code>vars</code> and the rules <code>sol</code> and <code>solQ</code>
that can be used to solve for variables in the list of SOS NCPoly
<code>ps</code> and the list of Gram matrices <code>Qs</code>.</p>
<p>For example,</p>
<p>{q, Q, $, chipset} = NCPolySOS[poly, q]; {sdp, vars, sol, solQ} =
NCPolySOSToSDP[{poly - q}, {Q}, z];</p>
<p>generate the semidefinite constraints <code>spd</code> in the
variables <code>vars</code> which are feasible if and only if the
<code>NCPoly</code> <code>poly</code> is SOS.</p>
<p>See also: <a href="#NCPolySOS">NCPolySOS</a>.</p>
<h1 data-number="16" id="WorkInProgress"><span
class="header-section-number">16</span> Work in Progress</h1>
<p>Sections in this chapter describe experimental packages which are
still under development.</p>
<h2 data-number="16.1" id="PackageNCRational"><span
class="header-section-number">16.1</span> NCRational</h2>
<p>This package contains functionality to convert an nc rational
expression into a descriptor representation.</p>
<p>For example the rational</p>
<pre><code>exp = 1 + inv[1 + x]</code></pre>
<p>in variables <code>x</code> and <code>y</code> can be converted into
an NCPolynomial using</p>
<pre><code>p = NCToNCPolynomial[exp, {x,y}]</code></pre>
<p>which returns</p>
<pre><code>p = NCPolynomial[a**c, &lt;|{x}-&gt;{{1,a,b}},{x**y,x}-&gt;{{2,1,c,1}}|&gt;, {x,y}]</code></pre>
<p>Members are:</p>
<ul>
<li><p><a href="#NCRational">NCRational</a></p></li>
<li><p><a href="#NCToNCRational">NCToNCRational</a></p></li>
<li><p><a href="#NCRationalToNC">NCRationalToNC</a></p></li>
<li><p><a
href="#NCRationalToCanonical">NCRationalToCanonical</a></p></li>
<li><p><a
href="#CanonicalToNCRational">CanonicalToNCRational</a></p></li>
<li><p><a href="#NCROrder">NCROrder</a></p></li>
<li><p><a href="#NCRLinearQ">NCRLinearQ</a></p></li>
<li><p><a href="#NCRStrictlyProperQ">NCRStrictlyProperQ</a></p></li>
<li><p><a href="#NCRPlus">NCRPlus</a></p></li>
<li><p><a href="#NCRTimes">NCRTimes</a></p></li>
<li><p><a href="#NCRTranspose">NCRTranspose</a></p></li>
<li><p><a href="#NCRInverse">NCRInverse</a></p></li>
<li><p><a
href="#NCRControllableSubspace">NCRControllableSubspace</a></p></li>
<li><p><a
href="#NCRControllableRealization">NCRControllableRealization</a></p></li>
<li><p><a
href="#NCRObservableRealization">NCRObservableRealization</a></p></li>
<li><p><a
href="#NCRMinimalRealization">NCRMinimalRealization</a></p></li>
</ul>
<h3 data-number="16.1.1"
id="state-space-realizations-for-nc-rationals"><span
class="header-section-number">16.1.1</span> State-space realizations for
NC rationals</h3>
<h4 data-number="16.1.1.1" id="NCRational"><span
class="header-section-number">16.1.1.1</span> NCRational</h4>
<p>NCRational::usage</p>
<h4 data-number="16.1.1.2" id="NCToNCRational"><span
class="header-section-number">16.1.1.2</span> NCToNCRational</h4>
<p>NCToNCRational::usage</p>
<h4 data-number="16.1.1.3" id="NCRationalToNC"><span
class="header-section-number">16.1.1.3</span> NCRationalToNC</h4>
<p>NCRationalToNC::usage</p>
<h4 data-number="16.1.1.4" id="NCRationalToCanonical"><span
class="header-section-number">16.1.1.4</span> NCRationalToCanonical</h4>
<p>NCRationalToCanonical::usage</p>
<h4 data-number="16.1.1.5" id="CanonicalToNCRational"><span
class="header-section-number">16.1.1.5</span> CanonicalToNCRational</h4>
<p>CanonicalToNCRational::usage</p>
<h3 data-number="16.1.2" id="utilities-1"><span
class="header-section-number">16.1.2</span> Utilities</h3>
<h4 data-number="16.1.2.1" id="NCROrder"><span
class="header-section-number">16.1.2.1</span> NCROrder</h4>
<p>NCROrder::usage</p>
<h4 data-number="16.1.2.2" id="NCRLinearQ"><span
class="header-section-number">16.1.2.2</span> NCRLinearQ</h4>
<p>NCRLinearQ::usage</p>
<h4 data-number="16.1.2.3" id="NCRStrictlyProperQ"><span
class="header-section-number">16.1.2.3</span> NCRStrictlyProperQ</h4>
<p>NCRStrictlyProperQ::usage</p>
<h3 data-number="16.1.3" id="operations-on-nc-rationals"><span
class="header-section-number">16.1.3</span> Operations on NC
rationals</h3>
<h4 data-number="16.1.3.1" id="NCRPlus"><span
class="header-section-number">16.1.3.1</span> NCRPlus</h4>
<p>NCRPlus::usage</p>
<h4 data-number="16.1.3.2" id="NCRTimes"><span
class="header-section-number">16.1.3.2</span> NCRTimes</h4>
<p>NCRTimes::usage</p>
<h4 data-number="16.1.3.3" id="NCRTranspose"><span
class="header-section-number">16.1.3.3</span> NCRTranspose</h4>
<p>NCRTranspose::usage</p>
<h4 data-number="16.1.3.4" id="NCRInverse"><span
class="header-section-number">16.1.3.4</span> NCRInverse</h4>
<p>NCRInverse::usage</p>
<h3 data-number="16.1.4" id="minimal-realizations"><span
class="header-section-number">16.1.4</span> Minimal realizations</h3>
<h4 data-number="16.1.4.1" id="NCRControllableRealization"><span
class="header-section-number">16.1.4.1</span>
NCRControllableRealization</h4>
<p>NCRControllableRealization::usage</p>
<h4 data-number="16.1.4.2" id="NCRControllableSubspace"><span
class="header-section-number">16.1.4.2</span>
NCRControllableSubspace</h4>
<p>NCRControllableSubspace::usage</p>
<h4 data-number="16.1.4.3" id="NCRObservableRealization"><span
class="header-section-number">16.1.4.3</span>
NCRObservableRealization</h4>
<p>NCRObservableRealization::usage</p>
<h4 data-number="16.1.4.4" id="NCRMinimalRealization"><span
class="header-section-number">16.1.4.4</span> NCRMinimalRealization</h4>
<p>NCRMinimalRealization::usage</p>
<h2 data-number="16.2" id="PackageNCRealization"><span
class="header-section-number">16.2</span> NCRealization</h2>
<p><strong>WARNING: OBSOLETE PACKAGE WILL BE REPLACED BY
NCRational</strong></p>
<p>The package <strong>NCRealization</strong> implements an algorithm
due to N. Slinglend for producing minimal realizations of nc rational
functions in many nc variables. See “Toward Making LMIs
Automatically”.</p>
<p>It actually computes formulas similar to those used in the paper
“Noncommutative Convexity Arises From Linear Matrix Inequalities” by J
William Helton, Scott A. McCullough, and Victor Vinnikov. In particular,
there are functions for calculating (symmetric) minimal descriptor
realizations of nc (symmetric) rational functions, and determinantal
representations of polynomials.</p>
<p>Members are:</p>
<ul>
<li>Drivers:
<ul>
<li><a href="#NCDescriptorRealization">NCDescriptorRealization</a></li>
<li><a
href="#NCMatrixDescriptorRealization">NCMatrixDescriptorRealization</a></li>
<li><a
href="#NCMinimalDescriptorRealization">NCMinimalDescriptorRealization</a></li>
<li><a
href="#NCDeterminantalRepresentationReciprocal">NCDeterminantalRepresentationReciprocal</a></li>
<li><a
href="#NCSymmetrizeMinimalDescriptorRealization">NCSymmetrizeMinimalDescriptorRealization</a></li>
<li><a
href="#NCSymmetricDescriptorRealization">NCSymmetricDescriptorRealization</a></li>
<li><a
href="#NCSymmetricDeterminantalRepresentationDirect">NCSymmetricDeterminantalRepresentationDirect</a></li>
<li><a
href="#NCSymmetricDeterminantalRepresentationReciprocal">NCSymmetricDeterminantalRepresentationReciprocal</a></li>
<li><a href="#NonCommutativeLift">NonCommutativeLift</a></li>
</ul></li>
<li>Auxiliary:
<ul>
<li><a href="#PinnedQ">PinnedQ</a></li>
<li><a href="#PinningSpace">PinningSpace</a></li>
<li><a
href="#TestDescriptorRealization">TestDescriptorRealization</a></li>
<li><a href="#SignatureOfAffineTerm">SignatureOfAffineTerm</a></li>
</ul></li>
</ul>
<h3 data-number="16.2.1" id="NCDescriptorRealization"><span
class="header-section-number">16.2.1</span> NCDescriptorRealization</h3>
<p><code>NCDescriptorRealization[RationalExpression,UnknownVariables]</code>
returns a list of 3 matrices <code>{C,G,B}</code> such that <span
class="math inline">\(C G^{-1} B\)</span> is the given
<code>RationalExpression</code>.
i.e. <code>NCDot[C,NCInverse[G],B] === RationalExpression</code>.</p>
<p><code>C</code> and <code>B</code> do not contain any
<code>UnknownsVariables</code> and <code>G</code> has linear entries in
the <code>UnknownVariables</code>.</p>
<h3 data-number="16.2.2"
id="NCDeterminantalRepresentationReciprocal"><span
class="header-section-number">16.2.2</span>
NCDeterminantalRepresentationReciprocal</h3>
<p><code>NCDeterminantalRepresentationReciprocal[Polynomial,Unknowns]</code>
returns a linear pencil matrix whose determinant equals
<code>Constant * CommuteEverything[Polynomial]</code>. This uses the
reciprocal algorithm: find a minimal descriptor realization of
<code>inv[Polynomial]</code>, so <code>Polynomial</code> must be nonzero
at the origin.</p>
<h3 data-number="16.2.3" id="NCMatrixDescriptorRealization"><span
class="header-section-number">16.2.3</span>
NCMatrixDescriptorRealization</h3>
<p><code>NCMatrixDescriptorRealization[RationalMatrix,UnknownVariables]</code>
is similar to <code>NCDescriptorRealization</code> except it takes a
<em>Matrix</em> with rational function entries and returns a matrix of
lists of the vectors/matrix <code>{C,G,B}</code>. A different
<code>{C,G,B}</code> for each entry.</p>
<h3 data-number="16.2.4" id="NCMinimalDescriptorRealization"><span
class="header-section-number">16.2.4</span>
NCMinimalDescriptorRealization</h3>
<p><code>NCMinimalDescriptorRealization[RationalFunction,UnknownVariables]</code>
returns <code>{C,G,B}</code> where
<code>NCDot[C,NCInverse[G],B] == RationalFunction</code>, <code>G</code>
is linear in the <code>UnknownVariables</code>, and the realization is
minimal (may be pinned).</p>
<h3 data-number="16.2.5" id="NCSymmetricDescriptorRealization"><span
class="header-section-number">16.2.5</span>
NCSymmetricDescriptorRealization</h3>
<p><code>NCSymmetricDescriptorRealization[RationalSymmetricFunction, Unknowns]</code>
combines two steps:
<code>NCSymmetrizeMinimalDescriptorRealization[NCMinimalDescriptorRealization[RationalSymmetricFunction, Unknowns]]</code>.</p>
<h3 data-number="16.2.6"
id="NCSymmetricDeterminantalRepresentationDirect"><span
class="header-section-number">16.2.6</span>
NCSymmetricDeterminantalRepresentationDirect</h3>
<p><code>NCSymmetricDeterminantalRepresentationDirect[SymmetricPolynomial,Unknowns]</code>
returns a linear pencil matrix whose determinant equals
<code>Constant * CommuteEverything[SymmetricPolynomial]</code>. This
uses the direct algorithm: Find a realization of 1 -
NCSymmetricPolynomial,…</p>
<h3 data-number="16.2.7"
id="NCSymmetricDeterminantalRepresentationReciprocal"><span
class="header-section-number">16.2.7</span>
NCSymmetricDeterminantalRepresentationReciprocal</h3>
<p><code>NCSymmetricDeterminantalRepresentationReciprocal[SymmetricPolynomial,Unknowns]</code>
returns a linear pencil matrix whose determinant equals
<code>Constant * CommuteEverything[NCSymmetricPolynomial]</code>. This
uses the reciprocal algorithm: find a symmetric minimal descriptor
realization of <code>inv[NCSymmetricPolynomial]</code>, so
NCSymmetricPolynomial must be nonzero at the origin.</p>
<h3 data-number="16.2.8"
id="NCSymmetrizeMinimalDescriptorRealization"><span
class="header-section-number">16.2.8</span>
NCSymmetrizeMinimalDescriptorRealization</h3>
<p><code>NCSymmetrizeMinimalDescriptorRealization[{C,G,B},Unknowns]</code>
symmetrizes the minimal realization <code>{C,G,B}</code> (such as output
from <code>NCMinimalRealization</code>) and outputs
<code>{Ctilda,Gtilda}</code> corresponding to the realization
<code>{Ctilda, Gtilda,Transpose[Ctilda]}</code>.</p>
<p><strong>WARNING:</strong> May produces errors if the realization
doesn’t correspond to a symmetric rational function.</p>
<h3 data-number="16.2.9" id="NonCommutativeLift"><span
class="header-section-number">16.2.9</span> NonCommutativeLift</h3>
<p><code>NonCommutativeLift[Rational]</code> returns a noncommutative
symmetric lift of <code>Rational</code>.</p>
<h3 data-number="16.2.10" id="SignatureOfAffineTerm"><span
class="header-section-number">16.2.10</span> SignatureOfAffineTerm</h3>
<p><code>SignatureOfAffineTerm[Pencil,Unknowns]</code> returns a list of
the number of positive, negative and zero eigenvalues in the affine part
of <code>Pencil</code>.</p>
<h3 data-number="16.2.11" id="TestDescriptorRealization"><span
class="header-section-number">16.2.11</span>
TestDescriptorRealization</h3>
<p><code>TestDescriptorRealization[Rat,{C,G,B},Unknowns]</code> checks
if <code>Rat</code> equals <span class="math inline">\(C G^{-1}
B\)</span> by substituting random 2-by-2 matrices in for the unknowns.
<code>TestDescriptorRealization[Rat,{C,G,B},Unknowns,NumberOfTests]</code>
can be used to specify the <code>NumberOfTests</code>, the default being
5.</p>
<h3 data-number="16.2.12" id="PinnedQ"><span
class="header-section-number">16.2.12</span> PinnedQ</h3>
<p><code>PinnedQ[Pencil_,Unknowns_]</code> is True or False.</p>
<h3 data-number="16.2.13" id="PinningSpace"><span
class="header-section-number">16.2.13</span> PinningSpace</h3>
<p><code>PinningSpace[Pencil_,Unknowns_]</code> returns a matrix whose
columns span the pinning space of <code>Pencil</code>. Generally, either
an empty matrix or a d-by-1 matrix (vector).</p>
<h1 class="unnumbered" id="references">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent"
role="list">
<div id="ref-camino:MIS:2003" class="csl-entry" role="listitem">
Camino, Juan F., John William Helton, Robert E. Skelton, and Jieping Ye.
2003. <span>“<span class="nocase">Matrix Inequalities: a Symbolic
Procedure to Determine Convexity Automatically</span>.”</span>
<em>Integral Equation and Operator Theory</em> 46 (4): 399–454.
</div>
<div id="ref-mora:ICN:1994" class="csl-entry" role="listitem">
Mora, Teo. 1994. <span>“An Introduction to Commutative and
Noncommutative Groebner Bases.”</span> <em>Theoretical Computer
Science</em> 134: 131–73.
</div>
<div id="ref-oliveira:SSP:2012" class="csl-entry" role="listitem">
Oliveira, Mauricio C. de. 2012. <span>“<span
class="nocase">Simplification of symbolic polynomials on non-commutative
variables</span>.”</span> <em>Linear Algebra and Its Applications</em>
437 (7): 1734–48. <a
href="https://doi.org/10.1016/j.laa.2012.05.015">https://doi.org/10.1016/j.laa.2012.05.015</a>.
</div>
</div>
<section id="footnotes" class="footnotes footnotes-end-of-document"
role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p>The transpose of the gradient of the nc expression
<code>expr</code> is the derivative with respect to the direction
<code>h</code> of the trace of the directional derivative of
<code>expr</code> in the direction <code>h</code>.<a href="#fnref1"
class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Contrary to what happens with symbolic inversion of
matrices with commutative entries, there exist multiple formulas for the
symbolic inverse of a matrix with noncommutative entries. Furthermore,
it may be possible that none of such formulas is “correct”. Indeed, it
is easy to construct a matrix <code>m</code> with block structure as
shown that is invertible but for which none of the blocks
<code>a</code>, <code>b</code>, <code>c</code>, and <code>d</code> are
invertible. In this case no <em>correct</em> formula exists for the
calculation of the inverse of <code>m</code>.<a href="#fnref2"
class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>This is in contrast with the commutative <span
class="math inline">\(x^4\)</span> which is convex everywhere. See <span
class="citation" data-cites="camino:MIS:2003">(Camino et al.
2003)</span> for details.<a href="#fnref3" class="footnote-back"
role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>The reason is that making an operator <code>Flat</code>
is a convenience that comes with a price: lack of control over execution
and evaluation. Since <code>NCAlgebra</code> has to operate at a very
low level this lack of control over evaluation is fatal. Indeed, making
<code>NonCommutativeMultiply</code> have an attribute <code>Flat</code>
will throw Mathematica into infinite loops in seemingly trivial
noncommutative expressions. Hey, email us if you find a way around that
:)<a href="#fnref4" class="footnote-back"
role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>One might have encountered this difficulty when trying
to match a product of commutative variables in a commutative monomial
such as <code>x y^2 /. x y -&gt; z</code> which fails to match
<code>x y^2</code> even though <code>x y^2</code> is equal to
<code>(x y) y</code>.<a href="#fnref5" class="footnote-back"
role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>The actual rule in this case is the more complicated
<code>a^n:_Integer?Positive:1**c**b^m:_Integer?Positive:1 -&gt; a^(n-1)**d**b^(m-1)</code>
with additional checks that prevent the rule from working with negative
powers.<a href="#fnref6" class="footnote-back"
role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>By the way, I find that behavior of Mathematica’s
<code>Module</code> questionable, since something like</p>
<pre><code>F[exp_] := Module[{aa, bb},
  SetNonCommutative[aa, bb];
  aa**bb
]</code></pre>
<p>would not fail to treat <code>aa</code> and <code>bb</code> locally.
It is their appearance in a rule that triggers the mostly odd
behavior.<a href="#fnref7" class="footnote-back"
role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>Formerly <code>MatMult[m1,m2]</code>.<a href="#fnref8"
class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
</body>
</html>
